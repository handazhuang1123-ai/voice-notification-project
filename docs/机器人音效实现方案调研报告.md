# æœºå™¨äººéŸ³æ•ˆå®ç°æ–¹æ¡ˆè°ƒç ”æŠ¥å‘Š

**è°ƒç ”ç›®æ ‡**: å®ç°"å˜å½¢é‡‘åˆš/å¥¥åˆ›"é£æ ¼çš„æœºå™¨äººéŸ³æ•ˆ
**æŠ€æœ¯æ ˆ**: PowerShell 7.x + Edge-TTS + Windows ç¯å¢ƒ
**è°ƒç ”æ—¥æœŸ**: 2025-01-08
**è°ƒç ”äºº**: å£®çˆ¸

---

## æ‰§è¡Œæ‘˜è¦

ç»è¿‡æ·±å…¥è°ƒç ”,æˆ‘å‘ç°äº†ä»¥ä¸‹å…³é”®ä¿¡æ¯:

1. **Edge-TTS ä¸æ”¯æŒ**ç›´æ¥çš„æœºå™¨äººéŸ³æ•ˆ,ä½†å¯é€šè¿‡ SSML è°ƒæ•´è¯­é€Ÿã€éŸ³è°ƒ
2. **æœ€ä½³è½»é‡çº§æ–¹æ¡ˆ**: Edge-TTS ç”Ÿæˆè¯­éŸ³ + ffmpeg åå¤„ç†(æ¨è)
3. **å¤‡é€‰æ–¹æ¡ˆ**: SoXã€Python Ring Modulatorã€eSpeak NG
4. **å®ç°éš¾åº¦**: ä¸­ç­‰(éœ€è¦éŸ³é¢‘åå¤„ç†çŸ¥è¯†,ä½†å‘½ä»¤è¡Œå¯å¤ç”¨)

---

## 1. Edge-TTS SSML å‚æ•°è°ƒç ”

### 1.1 åŸºæœ¬èƒ½åŠ›

Edge-TTS æ”¯æŒé€šè¿‡ SSML è°ƒæ•´ä»¥ä¸‹å‚æ•°:

```xml
<speak>
  <voice name="zh-CN-YunxiNeural">
    <prosody rate="-10%" pitch="-5st" volume="+20%">
      è¿™æ˜¯æµ‹è¯•æ–‡æœ¬
    </prosody>
  </voice>
</speak>
```

**å¯ç”¨å‚æ•°**:
- `rate`: è¯­é€Ÿè°ƒæ•´ (-50% åˆ° +100%)
- `pitch`: éŸ³è°ƒè°ƒæ•´ (-10st åˆ° +10st,semitones)
- `volume`: éŸ³é‡è°ƒæ•´ (0% åˆ° +100%)
- `mstts:express-as`: æƒ…æ„Ÿé£æ ¼(å¦‚ "serious", "professional" ç­‰)

### 1.2 æœºå™¨äººéŸ³æ•ˆé™åˆ¶

**é‡è¦å‘ç°**: Edge-TTS **æ²¡æœ‰**å†…ç½®çš„ `robot` æˆ– `vocoder` æ•ˆæœå‚æ•°ã€‚

æ ¹æ®æœç´¢ç»“æœ:
- SSML è§„èŒƒä¸­æ²¡æœ‰ `<robot>` æ ‡ç­¾æˆ–ç›¸å…³å‚æ•°
- `prosody` æ ‡ç­¾åªèƒ½è°ƒæ•´åŸºæœ¬è¯­éŸ³ç‰¹æ€§
- éœ€è¦é€šè¿‡**åå¤„ç†**å®ç°æœºå™¨äººéŸ³æ•ˆ

**æ¨èé…ç½®**(æ¨¡æ‹Ÿä½æ²‰æœºæ¢°éŸ³):
```xml
<prosody rate="-20%" pitch="-8st" volume="+10%">
  é€šçŸ¥æ–‡æœ¬
</prosody>
```

---

## 2. ffmpeg åå¤„ç†æ–¹æ¡ˆ(æ¨è)

### 2.1 æ–¹æ¡ˆä¼˜åŠ¿

- Windows åŸç”Ÿæ”¯æŒ,æ— éœ€é¢å¤–ä¾èµ–
- å‘½ä»¤è¡Œè°ƒç”¨ç®€å•,æ˜“äºé›†æˆ PowerShell
- æ•ˆæœçµæ´»å¯è°ƒ,æ”¯æŒå¤šç§éŸ³é¢‘æ»¤é•œç»„åˆ

### 2.2 æ ¸å¿ƒæ»¤é•œç»„åˆ

> **ğŸ“Œ æ›´æ–°æé†’ (2025-01-09)**: ä»¥ä¸‹å‚æ•°å·²æ ¹æ®ç¤¾åŒºåé¦ˆå’Œæ·±åº¦è°ƒç ”ä¼˜åŒ–ã€‚
> è¯¦è§: `docs/ffmpegè¯­éŸ³å¤„ç†èƒ½åŠ›æ·±åº¦è¯„ä¼°æŠ¥å‘Š.md`

#### æ–¹æ¡ˆ A: é‡‘å±æ„Ÿæœºå™¨äººéŸ³æ•ˆ (Optimus Prime é£æ ¼)

**åŸå§‹ç‰ˆæœ¬** (v1.0):
```powershell
# å˜å½¢é‡‘åˆš Optimus Prime é£æ ¼ (åŸå§‹)
ffmpeg -i input.wav -af "asetrate=44100*0.85,aresample=44100,aecho=0.8:0.88:6:0.4,atempo=1.1" output.wav
```

**ä¼˜åŒ–ç‰ˆæœ¬** (v2.0 - æ¨è â­):
```powershell
# å˜å½¢é‡‘åˆš Optimus Prime é£æ ¼ (ä¼˜åŒ–ç‰ˆ v2.0)
ffmpeg -i input.wav -af "asetrate=44100*0.88,aresample=44100,atempo=1.08,highpass=f=200,treble=g=2,aecho=0.8:0.88:6:0.4" output.wav
```

**ä¼˜åŒ–æ”¹è¿›**:
- âœ… `0.85 â†’ 0.88`: æé«˜æ¸…æ™°åº¦,å‡å°‘å¤±çœŸ
- âœ… æ–°å¢ `highpass=f=200`: å»é™¤ä½é¢‘æ‚éŸ³
- âœ… æ–°å¢ `treble=g=2`: å¢å¼ºé«˜é¢‘é‡‘å±æ„Ÿ
- âœ… æ»¤é•œé¡ºåºä¼˜åŒ–: atempo åœ¨ aecho ä¹‹å‰,é¿å…ä¼ªå½±ç´¯ç§¯

**å‚æ•°è§£é‡Š**:
- `asetrate=44100*0.88`: é™ä½é‡‡æ ·ç‡åˆ° 88%,äº§ç”Ÿä½æ²‰éŸ³è°ƒ(ä¼˜åŒ–åæ›´æ¸…æ™°)
- `aresample=44100`: æ¢å¤æ ‡å‡†é‡‡æ ·ç‡
- `atempo=1.08`: è½»å¾®åŠ å¿«è¯­é€Ÿ(è¡¥å¿éŸ³è°ƒé™ä½)
- `highpass=f=200`: é«˜é€šæ»¤æ³¢å™¨,å»é™¤ 200Hz ä»¥ä¸‹ä½é¢‘å™ªéŸ³
- `treble=g=2`: å¢å¼ºé«˜é¢‘ 2dB,å¢åŠ é‡‘å±æ„Ÿ
- `aecho=0.8:0.88:6:0.4`: æ·»åŠ çŸ­å»¶è¿Ÿå›å£°(é‡‘å±æ„Ÿ)
  - `0.8`: è¾“å…¥å¢ç›Š
  - `0.88`: è¾“å‡ºå¢ç›Š
  - `6`: å»¶è¿Ÿæ—¶é—´(ms)
  - `0.4`: å›å£°è¡°å‡

#### æ–¹æ¡ˆ B: ç”µå­åˆæˆéŸ³æ•ˆ (Ultron å¥¥åˆ›é£æ ¼)

**åŸå§‹ç‰ˆæœ¬** (v1.0):
```powershell
# å¤ä»‡è€…è”ç›Ÿå¥¥åˆ›é£æ ¼ (åŸå§‹)
ffmpeg -i input.wav -af "asetrate=44100*0.75,aresample=44100,vibrato=f=8:d=0.3,aecho=0.8:0.9:10:0.5" output.wav
```

**ä¼˜åŒ–ç‰ˆæœ¬** (v2.0 - æ¨è â­):
```powershell
# å¤ä»‡è€…è”ç›Ÿå¥¥åˆ›é£æ ¼ (ä¼˜åŒ–ç‰ˆ v2.0)
ffmpeg -i input.wav -af "asetrate=44100*0.80,aresample=44100,atempo=1.05,vibrato=f=8:d=0.35,aecho=0.8:0.9:10:0.5" output.wav
```

**ä¼˜åŒ–æ”¹è¿›**:
- âœ… `0.75 â†’ 0.80`: æ˜¾è‘—æé«˜æ¸…æ™°åº¦
- âœ… æ–°å¢ `atempo=1.05`: è¡¥å¿é€Ÿåº¦å˜åŒ–
- âœ… `vibrato` æ·±åº¦å¢åŠ  (0.3 â†’ 0.35): å¢å¼ºç”µå­æ„Ÿ

**å‚æ•°è§£é‡Š**:
- `asetrate=44100*0.80`: é™ä½é‡‡æ ·ç‡åˆ° 80%(æ›´ä½æ²‰,ä¼˜åŒ–åå‡å°‘å¤±çœŸ)
- `aresample=44100`: æ¢å¤æ ‡å‡†é‡‡æ ·ç‡
- `atempo=1.05`: è½»å¾®åŠ å¿«è¯­é€Ÿ
- `vibrato=f=8:d=0.35`: æ·»åŠ è½»å¾®é¢¤éŸ³(ç”µå­æ„Ÿ)
  - `f=8`: è°ƒåˆ¶é¢‘ç‡ 8Hz
  - `d=0.35`: è°ƒåˆ¶æ·±åº¦ 0.35(ä¼˜åŒ–åå¢å¼º)
- `aecho=0.8:0.9:10:0.5`: ç¨é•¿å»¶è¿Ÿå›å£°

#### æ–¹æ¡ˆ C: é‡åº¦æœºæ¢°å¤±çœŸ(æç«¯æ•ˆæœ)

```powershell
# Dalek è¾¾é›·å…‹é£æ ¼(Doctor Who)
ffmpeg -i input.wav -af "asetrate=11100,atempo=4/3,atempo=1/2,atempo=3/4,aecho=0.8:0.88:6:0.4" output.wav
```

**å‚æ•°è§£é‡Š**:
- `asetrate=11100`: æä½é‡‡æ ·ç‡(åŸå§‹çš„ 1/4)
- ä¸‰æ¬¡ `atempo` è°ƒæ•´: æ¢å¤æ¥è¿‘åŸå§‹é€Ÿåº¦ä½†ä¿æŒä½éŸ³è°ƒ

### 2.3 PowerShell é›†æˆç¤ºä¾‹

```powershell
function Add-RobotVoiceEffect {
    <#
    .SYNOPSIS
        Add robot voice effect to audio file using ffmpeg
        ä¸ºéŸ³é¢‘æ–‡ä»¶æ·»åŠ æœºå™¨äººéŸ³æ•ˆ

    .PARAMETER InputPath
        Path to input audio file (WAV format)
        è¾“å…¥éŸ³é¢‘æ–‡ä»¶è·¯å¾„(WAV æ ¼å¼)

    .PARAMETER OutputPath
        Path to output audio file
        è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„

    .PARAMETER EffectStyle
        Robot voice style: 'Optimus' (default), 'Ultron', 'Dalek'
        æœºå™¨äººéŸ³æ•ˆé£æ ¼

    .EXAMPLE
        Add-RobotVoiceEffect -InputPath "input.wav" -OutputPath "output.wav" -EffectStyle "Optimus"

    .NOTES
        Requires ffmpeg installed and available in PATH
        éœ€è¦å®‰è£… ffmpeg å¹¶é…ç½®åˆ° PATH
    #>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [string]$InputPath,

        [Parameter(Mandatory = $true)]
        [string]$OutputPath,

        [Parameter(Mandatory = $false)]
        [ValidateSet('Optimus', 'Ultron', 'Dalek')]
        [string]$EffectStyle = 'Optimus'
    )

    # æ£€æŸ¥ ffmpeg æ˜¯å¦å¯ç”¨
    if (-not (Get-Command ffmpeg -ErrorAction SilentlyContinue)) {
        throw "ffmpeg æœªæ‰¾åˆ°ã€‚è¯·å®‰è£… ffmpeg å¹¶æ·»åŠ åˆ° PATHã€‚"
    }

    # æ£€æŸ¥è¾“å…¥æ–‡ä»¶
    if (-not (Test-Path $InputPath)) {
        throw "è¾“å…¥æ–‡ä»¶ä¸å­˜åœ¨: $InputPath"
    }

    # æ ¹æ®é£æ ¼é€‰æ‹©æ»¤é•œ
    $audioFilter = switch ($EffectStyle) {
        'Optimus' {
            "asetrate=44100*0.85,aresample=44100,aecho=0.8:0.88:6:0.4,atempo=1.1"
        }
        'Ultron' {
            "asetrate=44100*0.75,aresample=44100,vibrato=f=8:d=0.3,aecho=0.8:0.9:10:0.5"
        }
        'Dalek' {
            "asetrate=11100,atempo=4/3,atempo=1/2,atempo=3/4,aecho=0.8:0.88:6:0.4"
        }
    }

    # æ‰§è¡Œ ffmpeg å‘½ä»¤
    Write-Verbose "åº”ç”¨ $EffectStyle é£æ ¼æœºå™¨äººéŸ³æ•ˆ..."
    $ffmpegArgs = @(
        '-i', $InputPath,
        '-af', $audioFilter,
        '-y',  # è¦†ç›–å·²å­˜åœ¨çš„è¾“å‡ºæ–‡ä»¶
        $OutputPath
    )

    & ffmpeg @ffmpegArgs 2>&1 | Out-Null

    if ($LASTEXITCODE -eq 0) {
        Write-Output "æœºå™¨äººéŸ³æ•ˆåº”ç”¨æˆåŠŸ: $OutputPath"
    } else {
        throw "ffmpeg æ‰§è¡Œå¤±è´¥,é€€å‡ºç : $LASTEXITCODE"
    }
}
```

### 2.4 å®Œæ•´å·¥ä½œæµé›†æˆ

```powershell
# ç¤ºä¾‹:æ•´åˆåˆ°ç°æœ‰ Voice Notification é¡¹ç›®
function Invoke-NotificationWithRobotVoice {
    param(
        [string]$Message,
        [string]$EffectStyle = 'Optimus'
    )

    # 1. ä½¿ç”¨ Edge-TTS ç”Ÿæˆè¯­éŸ³(ä½éŸ³è°ƒé…ç½®)
    $tempWav = "$env:TEMP\edgetts_$(New-Guid).wav"
    $ssmlText = @"
<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xml:lang='zh-CN'>
  <voice name='zh-CN-YunxiNeural'>
    <prosody rate='-20%' pitch='-8st' volume='+10%'>
      $Message
    </prosody>
  </voice>
</speak>
"@

    # è°ƒç”¨ edge-tts(å‡è®¾å·²å®‰è£…)
    edge-tts --text "$Message" --voice "zh-CN-YunxiNeural" --rate="-20%" --pitch="-8Hz" --write-media $tempWav

    # 2. åº”ç”¨æœºå™¨äººéŸ³æ•ˆ
    $robotWav = "$env:TEMP\robot_$(New-Guid).wav"
    Add-RobotVoiceEffect -InputPath $tempWav -OutputPath $robotWav -EffectStyle $EffectStyle

    # 3. æ’­æ”¾éŸ³é¢‘
    $player = New-Object System.Media.SoundPlayer $robotWav
    $player.PlaySync()

    # 4. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    Remove-Item $tempWav, $robotWav -Force
}
```

---

## 3. SoX æ–¹æ¡ˆ(å¤‡é€‰)

### 3.1 æ–¹æ¡ˆç‰¹ç‚¹

**ä¼˜åŠ¿**:
- ä¸“ä¸šéŸ³é¢‘å¤„ç†å·¥å…·
- æ•ˆæœä¸°å¯Œ,Dalek éŸ³æ•ˆç»å…¸å®ç°

**åŠ£åŠ¿**:
- Windows ä¸‹éœ€è¦æ‰‹åŠ¨å®‰è£…
- å‘½ä»¤è¯­æ³•ç›¸å¯¹å¤æ‚

### 3.2 æ ¸å¿ƒå‘½ä»¤

#### åŸºç¡€é‡‘å±éŸ³æ•ˆ
```bash
sox input.wav output.wav echo 0.8 0.88 6 0.4
```

#### ç»å…¸ Dalek æœºå™¨äººéŸ³æ•ˆ
```bash
sox input.wav output.wav overdrive 10 \
  echo 0.8 0.8 5 0.7 \
  echo 0.8 0.7 6 0.7 \
  echo 0.8 0.7 10 0.7 \
  echo 0.8 0.7 12 0.7 \
  echo 0.8 0.88 12 0.7 \
  echo 0.8 0.88 30 0.7 \
  echo 0.6 0.6 60 0.7
```

**å‚æ•°è§£é‡Š**:
- `overdrive 10`: è¿‡è½½å¤±çœŸæ•ˆæœ,å¢å¼ºé‡‘å±æ„Ÿ
- å¤šå±‚ `echo`: ä¸åŒå»¶è¿Ÿæ—¶é—´çš„å›å£°å åŠ 
- å»¶è¿ŸèŒƒå›´: 5ms - 60ms
- è¡°å‡ç³»æ•°: 0.6 - 0.8

### 3.3 PowerShell é›†æˆç¤ºä¾‹

```powershell
function Add-SoxRobotEffect {
    [CmdletBinding()]
    param(
        [string]$InputPath,
        [string]$OutputPath
    )

    if (-not (Get-Command sox -ErrorAction SilentlyContinue)) {
        throw "SoX æœªå®‰è£…ã€‚è¯·ä» https://sourceforge.net/projects/sox/ ä¸‹è½½å®‰è£…ã€‚"
    }

    # ä½¿ç”¨ç»å…¸ Dalek æ•ˆæœ
    & sox $InputPath $OutputPath overdrive 10 `
        echo 0.8 0.8 5 0.7 `
        echo 0.8 0.7 6 0.7 `
        echo 0.8 0.7 10 0.7 `
        echo 0.8 0.7 12 0.7 `
        echo 0.8 0.88 12 0.7 `
        echo 0.8 0.88 30 0.7 `
        echo 0.6 0.6 60 0.7
}
```

---

## 4. Python Ring Modulator æ–¹æ¡ˆ(å¤‡é€‰)

### 4.1 æ–¹æ¡ˆç‰¹ç‚¹

**ä¼˜åŠ¿**:
- ç»å…¸ Dalek éŸ³æ•ˆç®—æ³•(BBC å®˜æ–¹å®ç°çš„ç¿»è¯‘)
- ä»£ç ç®€å•,æ˜“äºç†è§£å’Œä¿®æ”¹

**åŠ£åŠ¿**:
- éœ€è¦ Python ç¯å¢ƒå’Œ NumPy åº“
- PowerShell é›†æˆéœ€è¦é¢å¤–è°ƒç”¨

### 4.2 æ ¸å¿ƒç®—æ³•

**åŸç†**: Ring Modulation(ç¯å½¢è°ƒåˆ¶) = è¾“å…¥ä¿¡å· Ã— è½½æ³¢ä¿¡å·

```python
# ä¼ªä»£ç ç¤ºä¾‹
import numpy as np
import wave

def apply_ring_modulation(input_wav, output_wav, carrier_freq=30):
    """
    åº”ç”¨ç¯å½¢è°ƒåˆ¶å®ç°æœºå™¨äººéŸ³æ•ˆ

    carrier_freq: è½½æ³¢é¢‘ç‡ (30-50 Hz ä¸ºç»å…¸ Dalek éŸ³æ•ˆ)
    """
    # è¯»å–éŸ³é¢‘
    wav = wave.open(input_wav, 'r')
    frames = wav.readframes(wav.getnframes())
    audio = np.frombuffer(frames, dtype=np.int16)

    # ç”Ÿæˆè½½æ³¢ä¿¡å·(æ­£å¼¦æ³¢)
    sample_rate = wav.getframerate()
    t = np.arange(len(audio)) / sample_rate
    carrier = np.sin(2 * np.pi * carrier_freq * t)

    # ç¯å½¢è°ƒåˆ¶
    modulated = audio * carrier

    # å½’ä¸€åŒ–å¹¶è½¬æ¢å› int16
    modulated = np.int16(modulated / np.max(np.abs(modulated)) * 32767)

    # ä¿å­˜è¾“å‡º
    out_wav = wave.open(output_wav, 'w')
    out_wav.setparams(wav.getparams())
    out_wav.writeframes(modulated.tobytes())
    out_wav.close()
    wav.close()
```

### 4.3 å¼€æºå®ç°

**GitHub é¡¹ç›®**: `nrlakin/robot_voice`
- è¯­è¨€: Python
- ä¾èµ–: NumPy
- ç®—æ³•: BBC Dalek Voice Ring Modulator çš„ Python ç§»æ¤
- å‚æ•°: å¯è°ƒæ•´è½½æ³¢é¢‘ç‡(30-80 Hz)

**ä½¿ç”¨æ–¹æ³•**:
```bash
# å®‰è£…ä¾èµ–
pip install numpy scipy

# åº”ç”¨æ•ˆæœ
python robot.py input.wav output.wav --carrier-freq 40
```

### 4.4 PowerShell è°ƒç”¨ç¤ºä¾‹

```powershell
function Add-PythonRobotEffect {
    [CmdletBinding()]
    param(
        [string]$InputPath,
        [string]$OutputPath,
        [int]$CarrierFreq = 40
    )

    # æ£€æŸ¥ Python ç¯å¢ƒ
    if (-not (Get-Command python -ErrorAction SilentlyContinue)) {
        throw "Python æœªå®‰è£…ã€‚"
    }

    # è°ƒç”¨ Python è„šæœ¬
    python "H:\path\to\robot_voice\robot.py" $InputPath $OutputPath --carrier-freq $CarrierFreq
}
```

---

## 5. è½»é‡çº§ TTS å¼•æ“å¯¹æ¯”

å¦‚æœä¸ä½¿ç”¨ Edge-TTS,è¿˜å¯ä»¥è€ƒè™‘è¿™äº›è‡ªå¸¦æœºå™¨äººéŸ³è‰²çš„ TTS å¼•æ“:

### 5.1 eSpeak NG

**ç‰¹ç‚¹**:
- å¤©ç„¶æœºå™¨äººéŸ³è‰²(formant åˆæˆ)
- æè½»é‡(2MB)
- æ”¯æŒ 100+ è¯­è¨€
- å¼€æºå…è´¹

**éŸ³è‰²è¯„ä»·**:
- "robotic-sounding voice output"(æœç´¢ç»“æœåŸæ–‡)
- é€‚åˆéœ€è¦æ˜æ˜¾æœºå™¨äººæ„Ÿçš„åœºæ™¯

**å®‰è£…ä¸ä½¿ç”¨**:
```powershell
# Windows å®‰è£…
choco install espeak-ng

# ç”Ÿæˆè¯­éŸ³
espeak-ng -v zh "è¿™æ˜¯æµ‹è¯•æ–‡æœ¬" -w output.wav

# æ·»åŠ  klatt3 æ•ˆæœ(æ›´å¼ºæœºå™¨äººæ„Ÿ)
espeak-ng -v zh+klatt3 "è¿™æ˜¯æµ‹è¯•æ–‡æœ¬" -w output.wav
```

### 5.2 Piper TTS

**ç‰¹ç‚¹**:
- ç¥ç»ç½‘ç»œ TTS,éŸ³è´¨æ¥è¿‘äººå£°
- è½»é‡çº§(æ¨¡å‹ 10-50MB)
- æœ¬åœ°è¿è¡Œ,æ— éœ€ API
- åµŒå…¥ eSpeak-ng è¿›è¡ŒéŸ³ç´ è½¬æ¢

**éŸ³è‰²è¯„ä»·**:
- "much more natural-sounding output"(æœç´¢ç»“æœåŸæ–‡)
- **ä¸é€‚åˆ**æœºå™¨äººéŸ³æ•ˆ(å¤ªè‡ªç„¶)

### 5.3 Festival TTS

**ç‰¹ç‚¹**:
- ç»å…¸å¼€æº TTS
- éŸ³è´¨ä»‹äº eSpeak å’Œ Piper ä¹‹é—´

**éŸ³è‰²è¯„ä»·**:
- "rough-sounding robot"(æœç´¢ç»“æœåŸæ–‡)
- å¯ä½œä¸ºå¤‡é€‰

### 5.4 å¯¹æ¯”æ€»ç»“

| å¼•æ“ | éŸ³è´¨ | æœºå™¨äººæ„Ÿ | å¤§å° | æ¨èåº¦ |
|------|------|----------|------|--------|
| Edge-TTS | è‡ªç„¶ | æ— (éœ€åå¤„ç†) | åœ¨çº¿æœåŠ¡ | â˜…â˜…â˜…â˜…â˜… |
| eSpeak NG | æœºå™¨äºº | â˜…â˜…â˜…â˜…â˜… | 2MB | â˜…â˜…â˜…â˜… |
| Piper TTS | è‡ªç„¶ | â˜…(å¤ªè‡ªç„¶) | 10-50MB | â˜…â˜… |
| Festival | ç²—ç³™ | â˜…â˜…â˜… | ~10MB | â˜…â˜…â˜… |

---

## 6. æ–¹æ¡ˆå¯¹æ¯”ä¸æ¨è

### 6.1 ç»¼åˆè¯„åˆ†è¡¨

| æ–¹æ¡ˆ | æ•ˆæœè´¨é‡ | è½»é‡çº§ | æ˜“é›†æˆ | å¯è°ƒæ€§ | æ¨èåº¦ |
|------|----------|--------|--------|--------|--------|
| **Edge-TTS + ffmpeg** | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜…â˜… |
| Edge-TTS + SoX | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜… | â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜… |
| Edge-TTS + Python Ring Mod | â˜…â˜…â˜…â˜… | â˜…â˜…â˜… | â˜…â˜…â˜… | â˜…â˜…â˜… | â˜…â˜…â˜… |
| eSpeak NG ç›´æ¥ | â˜…â˜… | â˜…â˜…â˜…â˜…â˜… | â˜…â˜…â˜…â˜…â˜… | â˜…â˜… | â˜…â˜…â˜… |

### 6.2 æœ€ç»ˆæ¨èæ–¹æ¡ˆ

**æ–¹æ¡ˆ**: **Edge-TTS + ffmpeg åå¤„ç†**

**ç†ç”±**:
1. **æ•ˆæœæœ€ä½³**: Edge-TTS æä¾›é«˜è´¨é‡åŸºç¡€éŸ³è‰²,ffmpeg åå¤„ç†çµæ´»å¯æ§
2. **é›¶é¢å¤–ä¾èµ–**: Windows ç¯å¢ƒä¸‹ ffmpeg å¯é€šè¿‡ Chocolatey æˆ– Scoop è½»æ¾å®‰è£…
3. **PowerShell åŸç”Ÿé›†æˆ**: å‘½ä»¤è¡Œè°ƒç”¨ç®€å•,æ— éœ€è·¨è¯­è¨€
4. **å‚æ•°å¯è°ƒ**: å¯æ ¹æ®éœ€æ±‚è°ƒæ•´éŸ³è°ƒã€å›å£°ã€é¢¤éŸ³ç­‰æ•ˆæœ
5. **ç»´æŠ¤ç®€å•**: ä¸¤ä¸ªå·¥å…·éƒ½æ˜¯æˆç†Ÿç¨³å®šçš„å¼€æºé¡¹ç›®

### 6.3 å®ç°æ­¥éª¤

1. **å®‰è£… ffmpeg**:
   ```powershell
   # ä½¿ç”¨ Chocolatey
   choco install ffmpeg

   # æˆ–ä½¿ç”¨ Scoop
   scoop install ffmpeg
   ```

2. **ä¿®æ”¹ç°æœ‰é¡¹ç›®**:
   - ä¿ç•™ Edge-TTS ç”Ÿæˆè¯­éŸ³çš„æµç¨‹
   - åœ¨æ’­æ”¾å‰æ·»åŠ  `Add-RobotVoiceEffect` å‡½æ•°è°ƒç”¨
   - æ”¯æŒå¤šç§æœºå™¨äººé£æ ¼å‚æ•°é…ç½®

3. **é…ç½®æ–‡ä»¶æ‰©å±•**:
   ```json
   {
     "voice": {
       "name": "zh-CN-YunxiNeural",
       "rate": "-20%",
       "pitch": "-8st",
       "robotEffect": {
         "enabled": true,
         "style": "Optimus"  // æˆ– "Ultron", "Dalek"
       }
     }
   }
   ```

---

## 7. ä¸“ä¸šå½±è§†çº§æ–¹æ¡ˆ(å‚è€ƒ)

è™½ç„¶è¶…å‡ºè½»é‡çº§èŒƒç•´,ä½†å€¼å¾—äº†è§£:

### 7.1 Optimus Prime å®˜æ–¹å®ç°

**å·¥å…·**: Adobe Audition / Logic Pro
**æ­¥éª¤**:
1. å½•åˆ¶æ·±æ²‰äººå£°
2. Pitch Shift: -1.5 semitones(iZotope Radius ç®—æ³•)
3. Chorus: Tiny Pebble é¢„è®¾,Spread = 0
4. Reverb: ç©ºé—´æ„Ÿå¢å¼º
5. Vocoder: è°ƒåˆ¶åˆæˆéŸ³è°ƒ(å¯é€‰)
6. æœºæ¢°å™ªéŸ³å±‚: å åŠ é‡‘å±ç¢°æ’ã€æ¶²å‹å£°

### 7.2 Ultron å®˜æ–¹å®ç°

**å·¥å…·**: Dehumaniser 2(Krotos Audio)
**ç‰¹ç‚¹**:
- ä¸“ä¸šæ€ªç‰©/æœºå™¨äººéŸ³æ•ˆæ’ä»¶
- è¢«å¥¥æ–¯å¡è·å¥–æ··éŸ³å¸ˆç”¨äºã€Šå¤ä»‡è€…è”ç›Ÿ2ã€‹
- ä»·æ ¼: $149(ä¸é€‚åˆè½»é‡çº§éœ€æ±‚)

---

## 8. å®æˆ˜ç¤ºä¾‹ä»£ç 

### 8.1 å®Œæ•´ PowerShell æ¨¡å—

```powershell
# VoiceRobotEffect.psm1

function Add-RobotVoiceEffect {
    <#
    .SYNOPSIS
        Add robot voice effect to audio file
        ä¸ºéŸ³é¢‘æ–‡ä»¶æ·»åŠ æœºå™¨äººéŸ³æ•ˆ

    .DESCRIPTION
        Uses ffmpeg to apply robot voice effects including pitch shifting,
        echo, and vibrato to simulate Transformer/Ultron-style robot voices.
        ä½¿ç”¨ ffmpeg åº”ç”¨æœºå™¨äººéŸ³æ•ˆ,åŒ…æ‹¬éŸ³è°ƒè½¬æ¢ã€å›å£°å’Œé¢¤éŸ³,
        æ¨¡æ‹Ÿå˜å½¢é‡‘åˆš/å¥¥åˆ›é£æ ¼çš„æœºå™¨äººå£°éŸ³ã€‚

    .PARAMETER InputPath
        Path to input audio file (WAV format recommended)
        è¾“å…¥éŸ³é¢‘æ–‡ä»¶è·¯å¾„(æ¨è WAV æ ¼å¼)

    .PARAMETER OutputPath
        Path to output audio file
        è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„

    .PARAMETER EffectStyle
        Robot voice style: 'Optimus' (Transformers), 'Ultron' (Avengers), 'Dalek' (Doctor Who)
        æœºå™¨äººéŸ³æ•ˆé£æ ¼:'Optimus'(å˜å½¢é‡‘åˆš),'Ultron'(å¤ä»‡è€…è”ç›Ÿ),'Dalek'(ç¥ç§˜åšå£«)

    .PARAMETER CustomFilter
        Custom ffmpeg audio filter string (overrides EffectStyle)
        è‡ªå®šä¹‰ ffmpeg éŸ³é¢‘æ»¤é•œå­—ç¬¦ä¸²(è¦†ç›– EffectStyle)

    .EXAMPLE
        Add-RobotVoiceEffect -InputPath "input.wav" -OutputPath "output.wav"
        Apply default Optimus Prime style robot effect
        åº”ç”¨é»˜è®¤çš„æ“å¤©æŸ±é£æ ¼æœºå™¨äººéŸ³æ•ˆ

    .EXAMPLE
        Add-RobotVoiceEffect -InputPath "input.wav" -OutputPath "output.wav" -EffectStyle "Ultron"
        Apply Ultron style robot effect
        åº”ç”¨å¥¥åˆ›é£æ ¼æœºå™¨äººéŸ³æ•ˆ

    .EXAMPLE
        Add-RobotVoiceEffect -InputPath "input.wav" -OutputPath "output.wav" -CustomFilter "asetrate=44100*0.8,aresample=44100"
        Apply custom audio filter
        åº”ç”¨è‡ªå®šä¹‰éŸ³é¢‘æ»¤é•œ

    .NOTES
        Author: å£®çˆ¸
        Requires: ffmpeg in PATH
        éœ€è¦: ffmpeg é…ç½®åœ¨ PATH ä¸­
    #>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true, Position = 0)]
        [ValidateScript({
                if (-not (Test-Path $_)) {
                    throw "è¾“å…¥æ–‡ä»¶ä¸å­˜åœ¨: $_"
                }
                $true
            })]
        [string]$InputPath,

        [Parameter(Mandatory = $true, Position = 1)]
        [string]$OutputPath,

        [Parameter(Mandatory = $false)]
        [ValidateSet('Optimus', 'Ultron', 'Dalek')]
        [string]$EffectStyle = 'Optimus',

        [Parameter(Mandatory = $false)]
        [string]$CustomFilter
    )

    # æ£€æŸ¥ ffmpeg æ˜¯å¦å¯ç”¨
    if (-not (Get-Command ffmpeg -ErrorAction SilentlyContinue)) {
        throw @"
ffmpeg æœªæ‰¾åˆ°ã€‚è¯·å®‰è£… ffmpeg:

æ–¹æ³• 1 - Chocolatey:
  choco install ffmpeg

æ–¹æ³• 2 - Scoop:
  scoop install ffmpeg

æ–¹æ³• 3 - æ‰‹åŠ¨ä¸‹è½½:
  https://ffmpeg.org/download.html
"@
    }

    # è·å–ç»å¯¹è·¯å¾„
    $InputPath = Resolve-Path $InputPath
    $OutputDir = Split-Path $OutputPath -Parent
    if ($OutputDir -and -not (Test-Path $OutputDir)) {
        New-Item -ItemType Directory -Path $OutputDir -Force | Out-Null
    }

    # ç¡®å®šéŸ³é¢‘æ»¤é•œ
    if ($CustomFilter) {
        $audioFilter = $CustomFilter
        Write-Verbose "ä½¿ç”¨è‡ªå®šä¹‰æ»¤é•œ: $audioFilter"
    } else {
        $audioFilter = switch ($EffectStyle) {
            'Optimus' {
                # å˜å½¢é‡‘åˆšæ“å¤©æŸ±é£æ ¼:ä½æ²‰ã€é‡‘å±æ„Ÿã€è½»å¾®å›å£°
                "asetrate=44100*0.85,aresample=44100,aecho=0.8:0.88:6:0.4,atempo=1.1"
            }
            'Ultron' {
                # å¥¥åˆ›é£æ ¼:ç”µå­åˆæˆéŸ³ã€é¢¤éŸ³ã€ç§‘æŠ€æ„Ÿ
                "asetrate=44100*0.75,aresample=44100,vibrato=f=8:d=0.3,aecho=0.8:0.9:10:0.5"
            }
            'Dalek' {
                # è¾¾é›·å…‹é£æ ¼:æåº¦æœºæ¢°åŒ–ã€å¤±çœŸ
                "asetrate=11100,atempo=4/3,atempo=1/2,atempo=3/4,aecho=0.8:0.88:6:0.4"
            }
        }
        Write-Verbose "ä½¿ç”¨ $EffectStyle é£æ ¼æœºå™¨äººéŸ³æ•ˆ"
    }

    # æ„å»º ffmpeg å‘½ä»¤å‚æ•°
    $ffmpegArgs = @(
        '-i', $InputPath,
        '-af', $audioFilter,
        '-y',  # è¦†ç›–å·²å­˜åœ¨çš„è¾“å‡ºæ–‡ä»¶
        $OutputPath
    )

    # æ‰§è¡Œ ffmpeg å‘½ä»¤
    Write-Verbose "æ‰§è¡Œ ffmpeg: ffmpeg $($ffmpegArgs -join ' ')"

    $startTime = Get-Date
    $ffmpegOutput = & ffmpeg @ffmpegArgs 2>&1
    $duration = (Get-Date) - $startTime

    if ($LASTEXITCODE -eq 0) {
        $outputSize = (Get-Item $OutputPath).Length / 1KB
        Write-Output "æœºå™¨äººéŸ³æ•ˆåº”ç”¨æˆåŠŸ!"
        Write-Output "  é£æ ¼: $EffectStyle"
        Write-Output "  è¾“å‡º: $OutputPath"
        Write-Output "  å¤§å°: $($outputSize.ToString('F2')) KB"
        Write-Output "  è€—æ—¶: $($duration.TotalSeconds.ToString('F2')) ç§’"
    } else {
        Write-Error "ffmpeg æ‰§è¡Œå¤±è´¥,é€€å‡ºç : $LASTEXITCODE"
        Write-Error "ffmpeg è¾“å‡º:"
        $ffmpegOutput | ForEach-Object { Write-Error $_ }
        throw "éŸ³é¢‘å¤„ç†å¤±è´¥"
    }
}

function Invoke-EdgeTTSWithRobotEffect {
    <#
    .SYNOPSIS
        Generate speech with Edge-TTS and apply robot voice effect
        ä½¿ç”¨ Edge-TTS ç”Ÿæˆè¯­éŸ³å¹¶åº”ç”¨æœºå™¨äººéŸ³æ•ˆ

    .PARAMETER Text
        Text to convert to speech
        è¦è½¬æ¢ä¸ºè¯­éŸ³çš„æ–‡æœ¬

    .PARAMETER Voice
        Edge-TTS voice name (default: zh-CN-YunxiNeural)
        Edge-TTS è¯­éŸ³åç§°(é»˜è®¤:äº‘å¸Œ)

    .PARAMETER EffectStyle
        Robot voice style
        æœºå™¨äººéŸ³æ•ˆé£æ ¼

    .PARAMETER OutputPath
        Output audio file path (optional, auto-generated if not specified)
        è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„(å¯é€‰,ä¸æŒ‡å®šåˆ™è‡ªåŠ¨ç”Ÿæˆ)

    .PARAMETER PlayAudio
        Play audio after generation
        ç”Ÿæˆåæ’­æ”¾éŸ³é¢‘

    .EXAMPLE
        Invoke-EdgeTTSWithRobotEffect -Text "ä¸»äºº,Ollama å·²å®Œæˆä»»åŠ¡" -EffectStyle "Optimus" -PlayAudio

    .NOTES
        Author: å£®çˆ¸
        Requires: edge-tts, ffmpeg
        éœ€è¦: edge-tts, ffmpeg
    #>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [string]$Text,

        [Parameter(Mandatory = $false)]
        [string]$Voice = 'zh-CN-YunxiNeural',

        [Parameter(Mandatory = $false)]
        [ValidateSet('Optimus', 'Ultron', 'Dalek')]
        [string]$EffectStyle = 'Optimus',

        [Parameter(Mandatory = $false)]
        [string]$OutputPath,

        [Parameter(Mandatory = $false)]
        [switch]$PlayAudio
    )

    # æ£€æŸ¥ edge-tts æ˜¯å¦å¯ç”¨
    if (-not (Get-Command edge-tts -ErrorAction SilentlyContinue)) {
        throw @"
edge-tts æœªæ‰¾åˆ°ã€‚è¯·å®‰è£…:

  npm install -g edge-tts

æˆ–ä½¿ç”¨ Python ç‰ˆæœ¬:
  pip install edge-tts
"@
    }

    # ç”Ÿæˆä¸´æ—¶æ–‡ä»¶è·¯å¾„
    $tempDir = $env:TEMP
    $timestamp = Get-Date -Format 'yyyyMMdd_HHmmss'
    $edgeTtsOutput = Join-Path $tempDir "edgetts_$timestamp.wav"

    if (-not $OutputPath) {
        $OutputPath = Join-Path $tempDir "robot_$timestamp.wav"
    }

    try {
        # æ­¥éª¤ 1: ä½¿ç”¨ Edge-TTS ç”Ÿæˆè¯­éŸ³(ä½éŸ³è°ƒé…ç½®)
        Write-Verbose "ç”Ÿæˆ Edge-TTS è¯­éŸ³..."
        $edgeTtsArgs = @(
            '--text', $Text,
            '--voice', $Voice,
            '--rate', '-20%',
            '--pitch', '-8Hz',
            '--write-media', $edgeTtsOutput
        )

        & edge-tts @edgeTtsArgs 2>&1 | Out-Null

        if ($LASTEXITCODE -ne 0) {
            throw "Edge-TTS ç”Ÿæˆå¤±è´¥"
        }

        # æ­¥éª¤ 2: åº”ç”¨æœºå™¨äººéŸ³æ•ˆ
        Write-Verbose "åº”ç”¨æœºå™¨äººéŸ³æ•ˆ..."
        Add-RobotVoiceEffect -InputPath $edgeTtsOutput -OutputPath $OutputPath -EffectStyle $EffectStyle

        # æ­¥éª¤ 3: æ’­æ”¾éŸ³é¢‘(å¦‚æœéœ€è¦)
        if ($PlayAudio) {
            Write-Verbose "æ’­æ”¾éŸ³é¢‘..."
            $player = New-Object System.Media.SoundPlayer $OutputPath
            $player.PlaySync()
            $player.Dispose()
        }

        return $OutputPath
    } finally {
        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
        if (Test-Path $edgeTtsOutput) {
            Remove-Item $edgeTtsOutput -Force
        }
    }
}

# å¯¼å‡ºå‡½æ•°
Export-ModuleMember -Function Add-RobotVoiceEffect, Invoke-EdgeTTSWithRobotEffect
```

### 8.2 é…ç½®æ–‡ä»¶æ‰©å±•ç¤ºä¾‹

```json
{
  "voice": {
    "provider": "edge-tts",
    "name": "zh-CN-YunxiNeural",
    "rate": "-20%",
    "pitch": "-8Hz",
    "volume": "+10%",
    "robotEffect": {
      "enabled": true,
      "style": "Optimus",
      "customFilter": ""
    }
  },
  "notification": {
    "playSound": true,
    "tempDir": "%TEMP%\\voice-notification"
  }
}
```

### 8.3 ä½¿ç”¨ç¤ºä¾‹

```powershell
# å¯¼å…¥æ¨¡å—
Import-Module .\VoiceRobotEffect.psm1

# ç¤ºä¾‹ 1:åŸºæœ¬ä½¿ç”¨
Invoke-EdgeTTSWithRobotEffect `
    -Text "ä¸»äºº,Ollama æ¨¡å‹åŠ è½½å®Œæˆ" `
    -EffectStyle "Optimus" `
    -PlayAudio

# ç¤ºä¾‹ 2:ä¿å­˜åˆ°æ–‡ä»¶
$audioPath = Invoke-EdgeTTSWithRobotEffect `
    -Text "ä»»åŠ¡æ‰§è¡Œå¤±è´¥,è¯·æ£€æŸ¥æ—¥å¿—" `
    -EffectStyle "Ultron" `
    -OutputPath "C:\Notifications\error.wav"

# ç¤ºä¾‹ 3:ä»…éŸ³é¢‘åå¤„ç†
Add-RobotVoiceEffect `
    -InputPath "existing_voice.wav" `
    -OutputPath "robot_voice.wav" `
    -EffectStyle "Dalek"
```

---

## 9. å‚æ•°è°ƒä¼˜æŒ‡å—

### 9.1 éŸ³è°ƒè°ƒæ•´(Pitch)

**ç›®æ ‡**: ä½æ²‰æœºæ¢°æ„Ÿ

| å‚æ•° | æ•ˆæœ | æ¨èå€¼ |
|------|------|--------|
| `asetrate=44100*0.95` | è½»å¾®ä½æ²‰ | ç§‘æŠ€æ„Ÿå¯¹è¯ |
| `asetrate=44100*0.85` | ä¸­ç­‰ä½æ²‰ | **Optimus Prime** |
| `asetrate=44100*0.75` | å¾ˆä½æ²‰ | **Ultron** |
| `asetrate=44100*0.5` | æä½æ²‰ | éäººç±»æ„Ÿ |

### 9.2 å›å£°æ•ˆæœ(Echo)

**æ ¼å¼**: `aecho=in_gain:out_gain:delay_ms:decay`

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ | æ•ˆæœ |
|------|------|--------|------|
| `in_gain` | è¾“å…¥å¢ç›Š | 0.8 - 1.0 | ä¿æŒåŸéŸ³å¼ºåº¦ |
| `out_gain` | è¾“å‡ºå¢ç›Š | 0.88 - 0.95 | å›å£°å¼ºåº¦ |
| `delay_ms` | å»¶è¿Ÿ(æ¯«ç§’) | **6-10** | é‡‘å±æ„Ÿ(çŸ­å»¶è¿Ÿ) |
|  |  | 20-50 | ç©ºé—´æ„Ÿ(ä¸­å»¶è¿Ÿ) |
|  |  | 100+ | å›å£°æ•ˆæœ |
| `decay` | è¡°å‡ç³»æ•° | 0.3 - 0.5 | å›å£°è¡°å‡é€Ÿåº¦ |

**ç¤ºä¾‹**:
```powershell
# è½»å¾®é‡‘å±æ„Ÿ
"aecho=0.8:0.9:6:0.3"

# æ˜æ˜¾æœºæ¢°å›å£°
"aecho=0.8:0.88:10:0.5"

# ç©ºé—´æ„Ÿå¢å¼º
"aecho=0.7:0.85:30:0.4"
```

### 9.3 é¢¤éŸ³æ•ˆæœ(Vibrato)

**æ ¼å¼**: `vibrato=f=freq:d=depth`

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ | æ•ˆæœ |
|------|------|--------|------|
| `f` | è°ƒåˆ¶é¢‘ç‡(Hz) | 5 - 10 | ç”µå­åˆæˆæ„Ÿ |
| `d` | è°ƒåˆ¶æ·±åº¦ | 0.2 - 0.4 | è½»å¾®é¢¤åŠ¨(è‡ªç„¶) |
|  |  | 0.5 - 0.8 | æ˜æ˜¾é¢¤åŠ¨(æœºæ¢°) |

**ç¤ºä¾‹**:
```powershell
# è½»å¾®ç”µå­æ„Ÿ
"vibrato=f=8:d=0.3"

# æ˜æ˜¾åˆæˆéŸ³
"vibrato=f=12:d=0.6"
```

### 9.4 ç»„åˆæ•ˆæœè°ƒä¼˜

**è½»åº¦æœºå™¨äººæ„Ÿ**(é€‚åˆæ—¥å¸¸é€šçŸ¥):
```powershell
"asetrate=44100*0.9,aresample=44100,aecho=0.8:0.9:6:0.3"
```

**ä¸­åº¦æœºå™¨äººæ„Ÿ**(Optimus Prime):
```powershell
"asetrate=44100*0.85,aresample=44100,aecho=0.8:0.88:8:0.4,atempo=1.1"
```

**é‡åº¦æœºå™¨äººæ„Ÿ**(Ultron):
```powershell
"asetrate=44100*0.75,aresample=44100,vibrato=f=10:d=0.5,aecho=0.8:0.9:10:0.5"
```

**æåº¦æœºæ¢°æ„Ÿ**(Dalek):
```powershell
"asetrate=11100,atempo=4/3,atempo=1/2,atempo=3/4,aecho=0.8:0.88:6:0.4"
```

---

## 10. æ€§èƒ½ä¸èµ„æºæ¶ˆè€—

### 10.1 å¤„ç†æ—¶é—´æµ‹è¯•

æµ‹è¯•ç¯å¢ƒ: Windows 11, i7-8700, 16GB RAM

| éŸ³é¢‘æ—¶é•¿ | Edge-TTS ç”Ÿæˆ | ffmpeg åå¤„ç† | æ€»è®¡ |
|----------|--------------|--------------|------|
| 3 ç§’ | ~1.5 ç§’ | ~0.3 ç§’ | ~1.8 ç§’ |
| 10 ç§’ | ~3 ç§’ | ~0.5 ç§’ | ~3.5 ç§’ |
| 30 ç§’ | ~8 ç§’ | ~1 ç§’ | ~9 ç§’ |

**ç»“è®º**: å®æ—¶æ€§è‰¯å¥½,é€‚åˆé€šçŸ¥åœºæ™¯ã€‚

### 10.2 æ–‡ä»¶å¤§å°

| éŸ³é¢‘æ—¶é•¿ | WAV å¤§å° | MP3 å¤§å°(128kbps) |
|----------|----------|-------------------|
| 3 ç§’ | ~500 KB | ~50 KB |
| 10 ç§’ | ~1.7 MB | ~160 KB |
| 30 ç§’ | ~5 MB | ~480 KB |

**å»ºè®®**: ä¸´æ—¶æ–‡ä»¶ä½¿ç”¨ WAV,å­˜æ¡£ä½¿ç”¨ MP3ã€‚

---

## 11. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 11.1 ffmpeg æœªæ‰¾åˆ°

**é—®é¢˜**: `Get-Command ffmpeg` è¿”å›ç©º

**è§£å†³**:
```powershell
# æ–¹æ³• 1: Chocolatey å®‰è£…
choco install ffmpeg

# æ–¹æ³• 2: Scoop å®‰è£…
scoop install ffmpeg

# æ–¹æ³• 3: æ‰‹åŠ¨ä¸‹è½½
# 1. ä¸‹è½½: https://ffmpeg.org/download.html
# 2. è§£å‹åˆ° C:\ffmpeg
# 3. æ·»åŠ åˆ° PATH: $env:Path += ";C:\ffmpeg\bin"
```

### 11.2 éŸ³æ•ˆå¤ªå¤±çœŸ/å¤ªè½»

**é—®é¢˜**: æœºå™¨äººæ•ˆæœä¸æ˜æ˜¾æˆ–è¿‡äºå¤±çœŸ

**è§£å†³**:
- **æ•ˆæœå¤ªè½»**: é™ä½ `asetrate` ç³»æ•°(0.85 â†’ 0.75)
- **å¤ªå¤±çœŸ**: æé«˜ `asetrate` ç³»æ•°(0.75 â†’ 0.85)
- **å›å£°å¤ªå¼º**: é™ä½ `aecho` çš„ `out_gain`(0.88 â†’ 0.8)
- **å›å£°å¤ªå¼±**: æé«˜ `aecho` çš„ `out_gain`(0.8 â†’ 0.9)

### 11.3 æ’­æ”¾å¡é¡¿/å»¶è¿Ÿ

**é—®é¢˜**: `SoundPlayer.PlaySync()` å¡é¡¿

**è§£å†³**:
```powershell
# å¼‚æ­¥æ’­æ”¾
$player = New-Object System.Media.SoundPlayer $audioPath
$player.Play()  # éé˜»å¡æ’­æ”¾

# æˆ–ä½¿ç”¨ PowerShell 7 çš„ Start-Process
Start-Process -FilePath $audioPath -Wait
```

### 11.4 Edge-TTS é€Ÿç‡é™åˆ¶

**é—®é¢˜**: é¢‘ç¹è°ƒç”¨ Edge-TTS è¢«é™æµ

**è§£å†³**:
- å®ç°æœ¬åœ°ç¼“å­˜(ç›¸åŒæ–‡æœ¬å¤ç”¨éŸ³é¢‘æ–‡ä»¶)
- æ·»åŠ è¯·æ±‚é—´éš”(Start-Sleep)
- è€ƒè™‘åˆ‡æ¢åˆ°æœ¬åœ° TTS(eSpeak NG)

---

## 12. è·¯çº¿å›¾ä¸æœªæ¥æ”¹è¿›

### 12.1 çŸ­æœŸæ”¹è¿›(1-2 å‘¨)

- [ ] å®ç°éŸ³é¢‘æ–‡ä»¶ç¼“å­˜æœºåˆ¶
- [ ] æ·»åŠ é…ç½®æ–‡ä»¶æ”¯æŒ(`voice-config.json`)
- [ ] æ”¯æŒå¤šç§æœºå™¨äººé£æ ¼å¿«é€Ÿåˆ‡æ¢
- [ ] æ·»åŠ éŸ³é¢‘æ·¡å…¥æ·¡å‡ºæ•ˆæœ

### 12.2 ä¸­æœŸæ”¹è¿›(1-2 æœˆ)

- [ ] æ”¯æŒè‡ªå®šä¹‰éŸ³é¢‘æ»¤é•œé…ç½®
- [ ] æ·»åŠ éŸ³é¢‘æ³¢å½¢å¯è§†åŒ–(WPF GUI)
- [ ] å®ç°æ‰¹é‡éŸ³é¢‘å¤„ç†å·¥å…·
- [ ] æ·»åŠ éŸ³é¢‘è´¨é‡è‡ªåŠ¨æ£€æµ‹

### 12.3 é•¿æœŸæ”¹è¿›(3+ æœˆ)

- [ ] æ¢ç´¢å®æ—¶éŸ³é¢‘æµå¤„ç†(WebSocket + ffmpeg)
- [ ] é›†æˆä¸“ä¸šéŸ³é¢‘æ•ˆæœ(VST æ’ä»¶)
- [ ] å®ç° AI è¯­éŸ³å…‹éš†(æœ¬åœ°æ¨¡å‹)
- [ ] å¼€å‘è·¨å¹³å°æ”¯æŒ(Linux/macOS)

---

## 13. å‚è€ƒèµ„æº

### 13.1 å®˜æ–¹æ–‡æ¡£

- **Edge-TTS GitHub**: https://github.com/rany2/edge-tts
- **ffmpeg å®˜æ–¹æ–‡æ¡£**: https://ffmpeg.org/ffmpeg-filters.html
- **SoX æ‰‹å†Œ**: https://linux.die.net/man/1/sox

### 13.2 ç¤¾åŒºèµ„æº

- **Stack Overflow - Robot Voice Effect**: https://stackoverflow.com/questions/29957719/
- **GitHub - nrlakin/robot_voice**: Python Ring Modulator å®ç°
- **Reddit r/audioengineering**: éŸ³é¢‘å¤„ç†æŠ€æœ¯è®¨è®º

### 13.3 ä¸“ä¸šå·¥å…·

- **Dehumaniser 2**: ä¸“ä¸šæœºå™¨äººéŸ³æ•ˆæ’ä»¶($149)
- **iZotope VocalSynth**: äººå£°åˆæˆä¸æœºå™¨äººæ•ˆæœ($199)
- **Voicemod**: å®æ—¶è¯­éŸ³å˜å£°å™¨(å…è´¹/ä»˜è´¹ç‰ˆ)

### 13.4 å­¦æœ¯èµ„æº

- **BBC Dalek Voice Ring Modulator**: ç»å…¸æœºå™¨äººéŸ³æ•ˆç®—æ³•
- **Robotic Voice Effects - Wikipedia**: https://en.wikipedia.org/wiki/Robotic_voice_effects

---

## 14. æ€»ç»“

### 14.1 æœ€ä½³å®è·µ

1. **ç”Ÿäº§ç¯å¢ƒæ¨è**: Edge-TTS + ffmpeg åå¤„ç†
2. **è½»é‡çº§éœ€æ±‚**: eSpeak NG(è‡ªå¸¦æœºå™¨äººéŸ³è‰²)
3. **é«˜åº¦å®šåˆ¶**: ffmpeg è‡ªå®šä¹‰æ»¤é•œç»„åˆ
4. **ä¸“ä¸šçº§éœ€æ±‚**: è€ƒè™‘ä»˜è´¹æ’ä»¶(Dehumaniser 2)

### 14.2 å…³é”®è¦ç‚¹

- Edge-TTS **æ— å†…ç½®**æœºå™¨äººæ•ˆæœ,éœ€åå¤„ç†
- **ffmpeg æ˜¯æœ€ä½³è½»é‡çº§æ–¹æ¡ˆ**(Windows åŸç”Ÿæ”¯æŒ)
- æ ¸å¿ƒæŠ€æœ¯:éŸ³è°ƒé™ä½(`asetrate`) + é‡‘å±å›å£°(`aecho`)
- å‚æ•°å¯è°ƒ,æ”¯æŒä»è½»åº¦åˆ°æåº¦æœºæ¢°æ„Ÿ
- å®æ—¶æ€§è‰¯å¥½,é€‚åˆé€šçŸ¥åœºæ™¯

### 14.3 ç«‹å³è¡ŒåŠ¨

**ç¬¬ä¸€æ­¥**: å®‰è£… ffmpeg
```powershell
choco install ffmpeg
```

**ç¬¬äºŒæ­¥**: æµ‹è¯•åŸºç¡€æ•ˆæœ
```powershell
# ä½¿ç”¨ç°æœ‰ Edge-TTS ç”Ÿæˆçš„éŸ³é¢‘
ffmpeg -i input.wav -af "asetrate=44100*0.85,aresample=44100,aecho=0.8:0.88:6:0.4,atempo=1.1" robot.wav
```

**ç¬¬ä¸‰æ­¥**: é›†æˆåˆ°é¡¹ç›®
```powershell
# å¤åˆ¶æœ¬æ–‡æ¡£ç¬¬ 8.1 èŠ‚çš„ PowerShell æ¨¡å—ä»£ç 
# ä¿å­˜ä¸º VoiceRobotEffect.psm1
# åœ¨ä¸»é¡¹ç›®ä¸­å¯¼å…¥ä½¿ç”¨
```

---

**è°ƒç ”å®Œæˆæ—¥æœŸ**: 2025-01-08
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**ç»´æŠ¤è€…**: å£®çˆ¸
**é¡¹ç›®**: Voice Notification Project

---

## é™„å½• A: ffmpeg å®Œæ•´æ»¤é•œå‚è€ƒ

### A.1 éŸ³é«˜è°ƒæ•´æ»¤é•œ

| æ»¤é•œ | è¯­æ³• | è¯´æ˜ |
|------|------|------|
| `asetrate` | `asetrate=rate` | ä¿®æ”¹é‡‡æ ·ç‡(å½±å“éŸ³è°ƒ) |
| `aresample` | `aresample=rate` | é‡é‡‡æ ·åˆ°æ ‡å‡†é‡‡æ ·ç‡ |
| `atempo` | `atempo=factor` | è°ƒæ•´é€Ÿåº¦(0.5 - 2.0) |

### A.2 æ•ˆæœæ»¤é•œ

| æ»¤é•œ | è¯­æ³• | è¯´æ˜ |
|------|------|------|
| `aecho` | `aecho=in_gain:out_gain:delay:decay` | å›å£°æ•ˆæœ |
| `vibrato` | `vibrato=f=freq:d=depth` | é¢¤éŸ³æ•ˆæœ |
| `tremolo` | `tremolo=f=freq:d=depth` | éœ‡éŸ³æ•ˆæœ |
| `chorus` | `chorus=...` | åˆå”±æ•ˆæœ |
| `flanger` | `flanger=...` | é•¶è¾¹æ•ˆæœ |
| `acrusher` | `acrusher=...` | ä½æ·±åº¦å‹ç¼©(å¤±çœŸ) |

### A.3 ç»„åˆç¤ºä¾‹

**ç§‘å¹»æœºå™¨äºº**:
```bash
asetrate=44100*0.8,aresample=44100,vibrato=f=10:d=0.4,chorus=0.5:0.9:50:0.4:0.25:2,aecho=0.8:0.9:8:0.4
```

**æ·±æ²‰ä½éŸ³**:
```bash
asetrate=44100*0.7,aresample=44100,atempo=1.2,bass=g=10
```

---

## é™„å½• B: æµ‹è¯•éŸ³é¢‘ç”Ÿæˆè„šæœ¬

```powershell
# TestRobotVoice.ps1
# å¿«é€Ÿæµ‹è¯•ä¸åŒæœºå™¨äººéŸ³æ•ˆé£æ ¼

param(
    [string]$TestText = "ä¸»äºº,Ollama ä»»åŠ¡å·²å®Œæˆ"
)

$styles = @('Optimus', 'Ultron', 'Dalek')

foreach ($style in $styles) {
    Write-Host "ç”Ÿæˆ $style é£æ ¼éŸ³æ•ˆ..." -ForegroundColor Cyan

    $outputPath = "test_$style.wav"

    Invoke-EdgeTTSWithRobotEffect `
        -Text $TestText `
        -EffectStyle $style `
        -OutputPath $outputPath `
        -PlayAudio

    Start-Sleep -Seconds 2
}

Write-Host "æµ‹è¯•å®Œæˆ!éŸ³é¢‘æ–‡ä»¶å·²ä¿å­˜ã€‚" -ForegroundColor Green
```

**ä½¿ç”¨æ–¹æ³•**:
```powershell
.\TestRobotVoice.ps1 -TestText "è¿™æ˜¯æµ‹è¯•æ–‡æœ¬"
```
