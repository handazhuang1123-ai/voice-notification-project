# PowerShell è¯­éŸ³é€šçŸ¥ç³»ç»Ÿè‡ªæˆ‘è¿›åŒ–æŠ€æœ¯æ–¹æ¡ˆè°ƒç ”æŠ¥å‘Š

**è°ƒç ”æ—¥æœŸ**: 2025-01-13
**é¡¹ç›®**: Voice Notification Project
**ç›®æ ‡**: è®¾è®¡10å¹´æ—¶é—´ç»´åº¦çš„æœ¬åœ°åŒ–ã€è½»é‡çº§è‡ªæˆ‘è¿›åŒ–æ–¹æ¡ˆ

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šé’ˆå¯¹ PowerShell + Ollama + Windows TTS è¯­éŸ³é€šçŸ¥ç³»ç»Ÿï¼Œè°ƒç ”äº†5ç§æœ¬åœ°åŒ–è‡ªæˆ‘è¿›åŒ–æ–¹æ¡ˆã€‚æ ¸å¿ƒç›®æ ‡æ˜¯é€šè¿‡æ—¥å¿—æ•°æ®å®ç°**æ¸è¿›å¼å­¦ä¹ **,åœ¨10å¹´æ—¶é—´ç»´åº¦å†…ä»æœºæ¢°æ€»ç»“é€æ­¥æ¼”å˜ä¸ºä¸ªæ€§åŒ–ä¼™ä¼´ã€‚

**æ¨èæ–¹æ¡ˆæ’åº**:
1. **æ–¹æ¡ˆ1ï¼ˆé¦–é€‰ï¼‰**: SQLite + sqlite-vec è½»é‡çº§ RAG - æœ€é€‚åˆ PowerShell ç¯å¢ƒ
2. **æ–¹æ¡ˆ2**: Mem0 + Ollama è®°å¿†å±‚ - åŠŸèƒ½æœ€å®Œå–„ä½†éœ€ Python
3. **æ–¹æ¡ˆ3**: çº¯ JSON + æ»‘åŠ¨çª—å£ - é›¶ä¾èµ–ä½†èƒ½åŠ›å—é™
4. **æ–¹æ¡ˆ4**: LanceDB åµŒå…¥å¼å‘é‡åº“ - æ€§èƒ½ä¼˜ç§€ä½† PowerShell é›†æˆå›°éš¾
5. **æ–¹æ¡ˆ5**: ChromaDB æœ¬åœ° RAG - è½»é‡ä½†ç”Ÿæ€ä¸å¦‚ Mem0

---

## ğŸ¯ éœ€æ±‚åˆ†æ

### æ ¸å¿ƒéœ€æ±‚
- **æœ¬åœ°åŒ–**: ä¸ä¾èµ–äº‘æœåŠ¡ï¼Œæ‰€æœ‰æ•°æ®å’Œè®¡ç®—æœ¬åœ°å®Œæˆ
- **è½»é‡çº§**: é€‚åˆ PowerShell ç¯å¢ƒï¼Œèµ„æºå ç”¨ä½ï¼ˆ< 500MB å†…å­˜ï¼‰
- **æ¸è¿›å¼**: é€šè¿‡å†å²æ—¥å¿—ç¼“æ…¢å­¦ä¹ ï¼Œè€Œéå¿«é€Ÿè§æ•ˆ
- **é•¿æœŸä¸»ä¹‰**: 10å¹´æ—¶é—´ç»´åº¦çš„å¤åˆ©æ•ˆåº”è®¾è®¡
- **é€æ˜æ€§**: ç”¨æˆ·å¯æŸ¥çœ‹å’Œå¹²é¢„å­¦ä¹ è¿‡ç¨‹

### æŠ€æœ¯çº¦æŸ
- **è¿è¡Œç¯å¢ƒ**: Windows PowerShell 7.x
- **AI åç«¯**: Ollamaï¼ˆæœ¬åœ°å¤§æ¨¡å‹ï¼‰
- **å­˜å‚¨**: æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ˆå·²æœ‰ç»Ÿä¸€æ—¥å¿— `logs/voice-unified.log`ï¼‰
- **é›†æˆ**: éœ€ä¸ç°æœ‰æ¨¡å—åŒ–æ¶æ„å…¼å®¹

### å·²æœ‰åŸºç¡€
- âœ… **ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ** - `voice-unified.log` è®°å½•æ‰€æœ‰äº¤äº’
- âœ… **æ¨¡å—åŒ–æ¶æ„** - Loggerã€ErrorMonitorã€Invoke-PlayAudio
- âœ… **æƒ…æ„Ÿæ£€æµ‹** - å·²å®ç°åŸºç¡€æƒ…æ„Ÿé£æ ¼ï¼ˆ`celebrate`, `calm`, `error` ç­‰ï¼‰
- âœ… **Ollama é›†æˆ** - å¯è°ƒç”¨æœ¬åœ°æ¨¡å‹ç”Ÿæˆæ€»ç»“

---

## ğŸ“Š äº”å¤§æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | å®ç°éš¾åº¦ | èµ„æºå ç”¨ | å­¦ä¹ èƒ½åŠ› | PS é›†æˆ | æ¨èåº¦ |
|------|---------|---------|---------|---------|--------|
| **æ–¹æ¡ˆ1: SQLite-vec RAG** | â­â­ | æä½ (50MB) | â­â­â­â­ | â­â­â­â­â­ | **â­â­â­â­â­** |
| **æ–¹æ¡ˆ2: Mem0 è®°å¿†å±‚** | â­â­â­ | ä¸­ç­‰ (200MB) | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| **æ–¹æ¡ˆ3: çº¯ JSON + æ»‘åŠ¨çª—å£** | â­ | æä½ (10MB) | â­â­ | â­â­â­â­â­ | â­â­â­ |
| **æ–¹æ¡ˆ4: LanceDB** | â­â­â­â­ | ä½ (100MB) | â­â­â­â­ | â­â­ | â­â­â­ |
| **æ–¹æ¡ˆ5: ChromaDB** | â­â­â­ | ä½ (150MB) | â­â­â­ | â­â­â­ | â­â­â­ |

---

## ğŸ”¬ æ–¹æ¡ˆè¯¦ç»†åˆ†æ

---

## â­ æ–¹æ¡ˆ1: SQLite + sqlite-vec è½»é‡çº§ RAGï¼ˆé¦–é€‰ï¼‰

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        PowerShell ä¸»è„šæœ¬                          â”‚
â”‚   (voice-notification.ps1)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
       â–¼       â–¼       â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Logger â”‚ â”‚Ollamaâ”‚ â”‚ SQLite   â”‚
  â”‚ æ¨¡å—   â”‚ â”‚åµŒå…¥  â”‚ â”‚+ vecæ‰©å±• â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
               â”‚           â”‚
               â–¼           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  memory.db              â”‚
        â”‚  â”œâ”€ interactions è¡¨     â”‚
        â”‚  â”‚  â””â”€ user_msg, reply â”‚
        â”‚  â”œâ”€ embeddings è¡¨       â”‚
        â”‚  â”‚  â””â”€ vec(768)å‘é‡    â”‚
        â”‚  â””â”€ preferences è¡¨      â”‚
        â”‚     â””â”€ åå¥½ç»Ÿè®¡         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. SQLite æ•°æ®åº“è®¾è®¡
```sql
-- äº¤äº’å†å²è¡¨
CREATE TABLE interactions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    user_message TEXT NOT NULL,
    claude_reply TEXT,
    ai_summary TEXT,
    emotion_style TEXT,
    success BOOLEAN DEFAULT 1
);

-- å‘é‡åµŒå…¥è¡¨ï¼ˆä½¿ç”¨ sqlite-vecï¼‰
CREATE VIRTUAL TABLE embeddings USING vec0(
    interaction_id INTEGER PRIMARY KEY,
    embedding FLOAT[768]  -- nomic-embed-text ç»´åº¦
);

-- ç”¨æˆ·åå¥½è¡¨
CREATE TABLE preferences (
    key TEXT PRIMARY KEY,
    value TEXT,
    frequency INTEGER DEFAULT 1,
    last_updated DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- æƒ…æ„Ÿåå¥½ç»Ÿè®¡
CREATE TABLE emotion_stats (
    emotion_style TEXT PRIMARY KEY,
    count INTEGER DEFAULT 0,
    avg_success_rate FLOAT DEFAULT 1.0,
    last_used DATETIME
);
```

#### 2. PowerShell é›†æˆæ¨¡å—ï¼ˆæ–°å»º `modules\MemoryStore.psm1`ï¼‰
```powershell
function Initialize-MemoryStore {
    <#
    .SYNOPSIS
        Initialize SQLite memory database with sqlite-vec extension
        åˆå§‹åŒ–å¸¦ sqlite-vec æ‰©å±•çš„ SQLite è®°å¿†æ•°æ®åº“
    #>
    param(
        [string]$DbPath = "$PSScriptRoot\..\data\memory.db"
    )

    # æ£€æŸ¥æ˜¯å¦å·²å®‰è£… sqlite-vecï¼ˆéœ€é¢„ç¼–è¯‘ DLLï¼‰
    $SqliteVecPath = "$PSScriptRoot\..\lib\sqlite-vec.dll"
    if (-not (Test-Path $SqliteVecPath)) {
        Write-Warning "sqlite-vec extension not found. Vector search disabled."
    }

    # åˆ›å»ºæ•°æ®åº“è¿æ¥ï¼ˆä½¿ç”¨ System.Data.SQLiteï¼‰
    Add-Type -Path "$PSScriptRoot\..\lib\System.Data.SQLite.dll"
    $conn = New-Object System.Data.SQLite.SQLiteConnection
    $conn.ConnectionString = "Data Source=$DbPath;Version=3;"
    $conn.Open()

    # åŠ è½½ sqlite-vec æ‰©å±•
    if (Test-Path $SqliteVecPath) {
        $conn.LoadExtension($SqliteVecPath)
    }

    # åˆ›å»ºè¡¨ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
    $schema = @"
CREATE TABLE IF NOT EXISTS interactions (...);
CREATE VIRTUAL TABLE IF NOT EXISTS embeddings USING vec0(...);
CREATE TABLE IF NOT EXISTS preferences (...);
CREATE TABLE IF NOT EXISTS emotion_stats (...);
"@

    $cmd = $conn.CreateCommand()
    $cmd.CommandText = $schema
    $cmd.ExecuteNonQuery()

    return $conn
}

function Save-Interaction {
    <#
    .SYNOPSIS
        Save interaction with embedding vector
        ä¿å­˜äº¤äº’è®°å½•åŠå…¶å‘é‡åµŒå…¥
    #>
    param(
        [Parameter(Mandatory)]
        [System.Data.SQLite.SQLiteConnection]$Connection,
        [string]$UserMessage,
        [string]$ClaudeReply,
        [string]$AiSummary,
        [string]$EmotionStyle
    )

    # 1. æ’å…¥äº¤äº’è®°å½•
    $insertSql = @"
INSERT INTO interactions (user_message, claude_reply, ai_summary, emotion_style)
VALUES (@user, @reply, @summary, @emotion);
SELECT last_insert_rowid();
"@

    $cmd = $Connection.CreateCommand()
    $cmd.CommandText = $insertSql
    $cmd.Parameters.AddWithValue("@user", $UserMessage)
    $cmd.Parameters.AddWithValue("@reply", $ClaudeReply)
    $cmd.Parameters.AddWithValue("@summary", $AiSummary)
    $cmd.Parameters.AddWithValue("@emotion", $EmotionStyle)

    $interactionId = [int]$cmd.ExecuteScalar()

    # 2. ç”Ÿæˆå‘é‡åµŒå…¥ï¼ˆè°ƒç”¨ Ollamaï¼‰
    $embedding = Get-OllamaEmbedding -Text "$UserMessage`n$ClaudeReply"

    # 3. å­˜å‚¨å‘é‡
    if ($embedding) {
        $vectorBytes = [System.BitConverter]::GetBytes($embedding)
        $insertVecSql = "INSERT INTO embeddings (interaction_id, embedding) VALUES (@id, @vec)"
        $vecCmd = $Connection.CreateCommand()
        $vecCmd.CommandText = $insertVecSql
        $vecCmd.Parameters.AddWithValue("@id", $interactionId)
        $vecCmd.Parameters.AddWithValue("@vec", $vectorBytes)
        $vecCmd.ExecuteNonQuery()
    }

    return $interactionId
}

function Get-OllamaEmbedding {
    <#
    .SYNOPSIS
        Generate embedding vector using Ollama nomic-embed-text
        ä½¿ç”¨ Ollama nomic-embed-text ç”ŸæˆåµŒå…¥å‘é‡
    #>
    param(
        [Parameter(Mandatory)]
        [string]$Text
    )

    $body = @{
        model = "nomic-embed-text"
        prompt = $Text
    } | ConvertTo-Json

    try {
        $response = Invoke-RestMethod -Uri "http://localhost:11434/api/embeddings" `
            -Method Post -Body $body -ContentType "application/json" -TimeoutSec 5
        return $response.embedding
    }
    catch {
        Write-Warning "Embedding generation failed: $_"
        return $null
    }
}

function Find-SimilarInteractions {
    <#
    .SYNOPSIS
        Find similar past interactions using vector similarity
        ä½¿ç”¨å‘é‡ç›¸ä¼¼åº¦æŸ¥æ‰¾ç›¸ä¼¼çš„å†å²äº¤äº’
    #>
    param(
        [Parameter(Mandatory)]
        [System.Data.SQLite.SQLiteConnection]$Connection,
        [Parameter(Mandatory)]
        [string]$QueryText,
        [int]$TopK = 3
    )

    # 1. ç”ŸæˆæŸ¥è¯¢å‘é‡
    $queryEmbedding = Get-OllamaEmbedding -Text $QueryText
    if (-not $queryEmbedding) { return @() }

    # 2. å‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼ˆä½™å¼¦ç›¸ä¼¼åº¦ï¼‰
    $searchSql = @"
SELECT
    i.id, i.user_message, i.ai_summary, i.emotion_style,
    vec_distance_cosine(e.embedding, @query) as similarity
FROM interactions i
JOIN embeddings e ON i.id = e.interaction_id
ORDER BY similarity
LIMIT @topk;
"@

    $cmd = $Connection.CreateCommand()
    $cmd.CommandText = $searchSql
    $cmd.Parameters.AddWithValue("@query", [System.BitConverter]::GetBytes($queryEmbedding))
    $cmd.Parameters.AddWithValue("@topk", $TopK)

    $reader = $cmd.ExecuteReader()
    $results = @()
    while ($reader.Read()) {
        $results += @{
            Id = $reader["id"]
            UserMessage = $reader["user_message"]
            AiSummary = $reader["ai_summary"]
            EmotionStyle = $reader["emotion_style"]
            Similarity = $reader["similarity"]
        }
    }
    $reader.Close()

    return $results
}

function Get-AdaptivePrompt {
    <#
    .SYNOPSIS
        Generate adaptive prompt using historical context
        ä½¿ç”¨å†å²ä¸Šä¸‹æ–‡ç”Ÿæˆè‡ªé€‚åº”æç¤ºè¯
    #>
    param(
        [Parameter(Mandatory)]
        [System.Data.SQLite.SQLiteConnection]$Connection,
        [Parameter(Mandatory)]
        [string]$CurrentUserMessage
    )

    # 1. æŸ¥æ‰¾ç›¸ä¼¼å†å²äº¤äº’
    $similar = Find-SimilarInteractions -Connection $Connection -QueryText $CurrentUserMessage -TopK 3

    # 2. è·å–æƒ…æ„Ÿåå¥½ç»Ÿè®¡
    $emotionSql = "SELECT emotion_style, count FROM emotion_stats ORDER BY count DESC LIMIT 1"
    $cmd = $Connection.CreateCommand()
    $cmd.CommandText = $emotionSql
    $reader = $cmd.ExecuteReader()
    $preferredEmotion = if ($reader.Read()) { $reader["emotion_style"] } else { "calm" }
    $reader.Close()

    # 3. æ„å»ºå¢å¼ºæç¤ºè¯
    $contextExamples = $similar | ForEach-Object {
        "- ç”¨æˆ·æ›¾é—®: $($_.UserMessage)`n  ä½ å›å¤: $($_.AiSummary)"
    }

    $enhancedPrompt = @"
ä½ æ˜¯ç”¨æˆ·çš„ä¸ªæ€§åŒ–AIåŠ©æ‰‹ã€‚æ ¹æ®ä»¥ä¸‹å†å²äº’åŠ¨é£æ ¼ç”Ÿæˆæ€»ç»“:

ã€å†å²ç›¸ä¼¼åœºæ™¯ã€‘
$($contextExamples -join "`n")

ã€ç”¨æˆ·åå¥½ã€‘
- æœ€å¸¸ä½¿ç”¨çš„æƒ…æ„Ÿé£æ ¼: $preferredEmotion

ã€å½“å‰æ¶ˆæ¯ã€‘
$CurrentUserMessage

è¯·ç”Ÿæˆä¸€ä¸ª60å­—ä»¥å†…çš„è¯­éŸ³æ’­æŠ¥æ€»ç»“ï¼Œä¿æŒä¸ªæ€§åŒ–é£æ ¼ã€‚
"@

    return $enhancedPrompt
}
```

#### 3. é›†æˆåˆ°ä¸»è„šæœ¬
```powershell
# åœ¨ voice-notification.ps1 ä¸­æ·»åŠ 

# å¯¼å…¥è®°å¿†æ¨¡å—
Import-Module (Join-Path $PSScriptRoot '..\modules\MemoryStore.psm1') -Force

# åˆå§‹åŒ–è®°å¿†å­˜å‚¨
$memoryConn = Initialize-MemoryStore

# ç”Ÿæˆè‡ªé€‚åº”æç¤ºè¯
$adaptivePrompt = Get-AdaptivePrompt -Connection $memoryConn -CurrentUserMessage $UserMessage

# è°ƒç”¨ Ollama ç”Ÿæˆæ€»ç»“ï¼ˆä½¿ç”¨å¢å¼ºæç¤ºè¯ï¼‰
$AiSummary = Invoke-OllamaGenerate -Prompt $adaptivePrompt

# ä¿å­˜äº¤äº’è®°å½•å’Œå‘é‡
Save-Interaction -Connection $memoryConn `
    -UserMessage $UserMessage `
    -ClaudeReply $ClaudeReply `
    -AiSummary $AiSummary `
    -EmotionStyle $DetectedEmotion

# å…³é—­è¿æ¥
$memoryConn.Close()
```

### å®ç°æ­¥éª¤

#### é˜¶æ®µ1: åŸºç¡€è®¾æ–½ï¼ˆç¬¬1-2å‘¨ï¼‰
1. **å®‰è£…ä¾èµ–**
   ```powershell
   # å®‰è£… System.Data.SQLite
   Install-Package System.Data.SQLite.Core -ProviderName NuGet

   # ä¸‹è½½ sqlite-vec ç¼–è¯‘ç‰ˆ
   # https://github.com/asg017/sqlite-vec/releases
   # æ”¾ç½®åˆ° lib/sqlite-vec.dll

   # æ‹‰å– Ollama embedding æ¨¡å‹
   ollama pull nomic-embed-text
   ```

2. **åˆ›å»ºæ•°æ®åº“æ¶æ„**
   ```powershell
   # è¿è¡Œåˆå§‹åŒ–è„šæœ¬
   .\scripts\Initialize-MemoryDatabase.ps1
   ```

#### é˜¶æ®µ2: åŸºç¡€è®°å¿†ï¼ˆç¬¬3-4å‘¨ï¼‰
1. å®ç° `Save-Interaction` - ä¿å­˜æ¯æ¬¡äº¤äº’
2. å®ç° `Get-OllamaEmbedding` - ç”Ÿæˆå‘é‡åµŒå…¥
3. é›†æˆåˆ°ä¸»è„šæœ¬çš„æ—¥å¿—æµç¨‹

#### é˜¶æ®µ3: æ£€ç´¢å¢å¼ºï¼ˆç¬¬5-6å‘¨ï¼‰
1. å®ç° `Find-SimilarInteractions` - å‘é‡ç›¸ä¼¼åº¦æœç´¢
2. å®ç° `Get-AdaptivePrompt` - ç”Ÿæˆä¸Šä¸‹æ–‡å¢å¼ºæç¤ºè¯
3. æµ‹è¯• RAG æ•ˆæœï¼ˆå¯¹æ¯”æœ‰æ— å†å²ä¸Šä¸‹æ–‡çš„æ€»ç»“è´¨é‡ï¼‰

#### é˜¶æ®µ4: åå¥½å­¦ä¹ ï¼ˆç¬¬7-8å‘¨ï¼‰
1. å®ç°æƒ…æ„Ÿåå¥½ç»Ÿè®¡ï¼ˆ`emotion_stats` è¡¨ï¼‰
2. å®ç°ç”¨æˆ·ä¹ æƒ¯æ£€æµ‹ï¼ˆæ—¶é—´åå¥½ã€è¯æ±‡åå¥½ï¼‰
3. åŠ¨æ€è°ƒæ•´æç¤ºè¯æƒé‡

#### é˜¶æ®µ5: é•¿æœŸä¼˜åŒ–ï¼ˆç¬¬9-12å‘¨ï¼‰
1. å®ç°é—å¿˜æ›²çº¿ï¼ˆé™ä½æ—§è®°å¿†æƒé‡ï¼‰
2. å®ç°è¯­ä¹‰å»é‡ï¼ˆé¿å…é‡å¤å­˜å‚¨ç›¸ä¼¼äº¤äº’ï¼‰
3. æ€§èƒ½ä¼˜åŒ–ï¼ˆç´¢å¼•ã€æŸ¥è¯¢ç¼“å­˜ï¼‰

### ä¼˜åŠ¿
âœ… **å®Œå…¨æœ¬åœ°åŒ–** - æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ° SQLite
âœ… **è½»é‡çº§** - sqlite-vec æ— é¢å¤–è¿›ç¨‹,åªæ˜¯ DLL æ‰©å±•
âœ… **PowerShell åŸç”Ÿ** - ä½¿ç”¨ `System.Data.SQLite.dll` æ— éœ€ Python
âœ… **æ¸è¿›å¼** - å‘é‡æœç´¢è´¨é‡éšæ•°æ®ç§¯ç´¯è‡ªç„¶æå‡
âœ… **å¯è§£é‡Š** - å¯ç›´æ¥ SQL æŸ¥è¯¢,ç†è§£å­¦ä¹ å†…å®¹
âœ… **ä½ç»´æŠ¤** - å•æ–‡ä»¶æ•°æ®åº“,å¤‡ä»½æ¢å¤ç®€å•

### åŠ£åŠ¿
âš ï¸ **éœ€è¦ DLL ä¾èµ–** - sqlite-vec æ‰©å±•éœ€é¢„ç¼–è¯‘ DLL
âš ï¸ **å‘é‡æœç´¢æ€§èƒ½** - å¤§è§„æ¨¡æ•°æ®ï¼ˆ>10ä¸‡æ¡ï¼‰å¯èƒ½éœ€è¦ä¼˜åŒ–
âš ï¸ **æ‰‹åŠ¨å®ç°é€»è¾‘** - æ²¡æœ‰ç°æˆçš„è®°å¿†ç®¡ç†æ¡†æ¶

### èµ„æºéœ€æ±‚
- **ç£ç›˜**: 1GBï¼ˆæ•°æ®åº“ + ç´¢å¼•ï¼‰/ 10å¹´
- **å†…å­˜**: 50MBï¼ˆSQLite è¿›ç¨‹å†…å­˜ï¼‰
- **CPU**: å‘é‡æœç´¢çº¦ 50msï¼ˆåƒçº§åˆ«æ•°æ®ï¼‰

### 10å¹´æ¼”è¿›è·¯å¾„
```
Year 1-2: ç´¯ç§¯åŸºç¡€æ•°æ®ï¼ˆ1000+ äº¤äº’ï¼‰
â”œâ”€ åŸºæœ¬å‘é‡æ£€ç´¢ç”Ÿæ•ˆ
â”œâ”€ ç®€å•åå¥½ç»Ÿè®¡ï¼ˆæœ€å¸¸ç”¨æƒ…æ„Ÿï¼‰
â””â”€ æç¤ºè¯å¼€å§‹åŒ…å«å†å²æ¡ˆä¾‹

Year 3-5: è´¨é‡æå‡ï¼ˆ5000+ äº¤äº’ï¼‰
â”œâ”€ ä¸Šä¸‹æ–‡ç›¸å…³æ€§æ˜¾è‘—æé«˜
â”œâ”€ ä¸ªæ€§åŒ–è¯æ±‡å¼€å§‹å‡ºç°
â””â”€ æƒ…æ„Ÿæ£€æµ‹å‡†ç¡®ç‡æå‡

Year 6-8: ä¸ªæ€§åŒ–æˆå‹ï¼ˆ10000+ äº¤äº’ï¼‰
â”œâ”€ å½¢æˆç¨³å®šçš„ä¸ªäººé£æ ¼
â”œâ”€ èƒ½é¢„æµ‹ç”¨æˆ·åå¥½åœºæ™¯
â””â”€ ä¸»åŠ¨è°ƒæ•´æ’­æŠ¥ç­–ç•¥

Year 9-10: ä¼™ä¼´çº§äº¤äº’ï¼ˆ15000+ äº¤äº’ï¼‰
â”œâ”€ è‡ªç„¶ç†è§£éšå«éœ€æ±‚
â”œâ”€ é•¿æœŸè®°å¿†å…³è”èƒ½åŠ›
â””â”€ çœŸæ­£çš„ä¸ªæ€§åŒ–åŠ©æ‰‹
```

---

## æ–¹æ¡ˆ2: Mem0 + Ollama è®°å¿†å±‚

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     PowerShell ä¸»è„šæœ¬                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ JSON-RPC/REST
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Python æ¡¥æ¥  â”‚ â† mem0-bridge.py
      â”‚  (Mem0 API) â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Mem0 AI â”‚  â”‚ Ollama   â”‚
â”‚  è®°å¿†å±‚  â”‚  â”‚ åµŒå…¥æ¨¡å‹ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChromaDB æœ¬åœ°åº“ â”‚
â”‚ (å‘é‡å­˜å‚¨)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. Python æ¡¥æ¥æœåŠ¡ï¼ˆ`scripts\mem0-bridge.py`ï¼‰
```python
#!/usr/bin/env python3
"""
Mem0 Bridge Service for PowerShell
æä¾› REST API ä¾› PowerShell è°ƒç”¨ Mem0 è®°å¿†å±‚
"""

from mem0 import Memory
from flask import Flask, request, jsonify
import os

app = Flask(__name__)

# åˆå§‹åŒ– Mem0ï¼ˆä½¿ç”¨ Ollama æœ¬åœ°åµŒå…¥ï¼‰
config = {
    "llm": {
        "provider": "ollama",
        "config": {
            "model": "qwen2.5:1.5b",
            "ollama_base_url": "http://localhost:11434"
        }
    },
    "embedder": {
        "provider": "ollama",
        "config": {
            "model": "nomic-embed-text",
            "ollama_base_url": "http://localhost:11434"
        }
    },
    "vector_store": {
        "provider": "chroma",
        "config": {
            "collection_name": "voice_notifications",
            "path": "./data/chromadb"  # æœ¬åœ°å­˜å‚¨
        }
    }
}

memory = Memory.from_config(config)

@app.route('/add', methods=['POST'])
def add_memory():
    """æ·»åŠ è®°å¿†"""
    data = request.json
    user_id = data.get('user_id', 'default_user')
    messages = data.get('messages', [])

    result = memory.add(messages, user_id=user_id)
    return jsonify({"success": True, "result": result})

@app.route('/search', methods=['POST'])
def search_memory():
    """æœç´¢ç›¸å…³è®°å¿†"""
    data = request.json
    query = data.get('query', '')
    user_id = data.get('user_id', 'default_user')
    limit = data.get('limit', 3)

    results = memory.search(query, user_id=user_id, limit=limit)
    return jsonify({"memories": results})

@app.route('/get_all', methods=['GET'])
def get_all_memories():
    """è·å–æ‰€æœ‰è®°å¿†"""
    user_id = request.args.get('user_id', 'default_user')
    memories = memory.get_all(user_id=user_id)
    return jsonify({"memories": memories})

@app.route('/update', methods=['POST'])
def update_memory():
    """æ›´æ–°è®°å¿†"""
    data = request.json
    memory_id = data.get('memory_id')
    text = data.get('text')

    result = memory.update(memory_id, text)
    return jsonify({"success": True, "result": result})

if __name__ == '__main__':
    print("Mem0 Bridge Service started on http://localhost:5000")
    app.run(host='127.0.0.1', port=5000, debug=False)
```

#### 2. PowerShell å®¢æˆ·ç«¯æ¨¡å—ï¼ˆ`modules\Mem0Client.psm1`ï¼‰
```powershell
function Start-Mem0Bridge {
    <#
    .SYNOPSIS
        Start Mem0 bridge service in background
        åœ¨åå°å¯åŠ¨ Mem0 æ¡¥æ¥æœåŠ¡
    #>
    param(
        [string]$ScriptPath = "$PSScriptRoot\..\scripts\mem0-bridge.py",
        [int]$Port = 5000
    )

    # æ£€æŸ¥æœåŠ¡æ˜¯å¦å·²è¿è¡Œ
    try {
        $response = Invoke-RestMethod -Uri "http://localhost:$Port/get_all" -Method Get -TimeoutSec 1
        Write-Verbose "Mem0 bridge already running"
        return $true
    }
    catch {
        # å¯åŠ¨æœåŠ¡
        Write-Verbose "Starting Mem0 bridge service..."
        Start-Process python -ArgumentList $ScriptPath -WindowStyle Hidden
        Start-Sleep -Seconds 3
        return $true
    }
}

function Add-Mem0Memory {
    <#
    .SYNOPSIS
        Add interaction to Mem0 memory
        æ·»åŠ äº¤äº’åˆ° Mem0 è®°å¿†
    #>
    param(
        [Parameter(Mandatory)]
        [string]$UserMessage,
        [Parameter(Mandatory)]
        [string]$AssistantReply,
        [string]$UserId = "default_user"
    )

    $body = @{
        user_id = $UserId
        messages = @(
            @{ role = "user"; content = $UserMessage }
            @{ role = "assistant"; content = $AssistantReply }
        )
    } | ConvertTo-Json -Depth 10

    try {
        $response = Invoke-RestMethod -Uri "http://localhost:5000/add" `
            -Method Post -Body $body -ContentType "application/json" -TimeoutSec 5
        return $response.success
    }
    catch {
        Write-Warning "Failed to add memory: $_"
        return $false
    }
}

function Search-Mem0Memory {
    <#
    .SYNOPSIS
        Search relevant memories for context
        æœç´¢ç›¸å…³è®°å¿†ä½œä¸ºä¸Šä¸‹æ–‡
    #>
    param(
        [Parameter(Mandatory)]
        [string]$Query,
        [int]$Limit = 3,
        [string]$UserId = "default_user"
    )

    $body = @{
        query = $Query
        user_id = $UserId
        limit = $Limit
    } | ConvertTo-Json

    try {
        $response = Invoke-RestMethod -Uri "http://localhost:5000/search" `
            -Method Post -Body $body -ContentType "application/json" -TimeoutSec 5
        return $response.memories
    }
    catch {
        Write-Warning "Failed to search memory: $_"
        return @()
    }
}

function Get-Mem0EnhancedPrompt {
    <#
    .SYNOPSIS
        Generate context-enhanced prompt using Mem0
        ä½¿ç”¨ Mem0 ç”Ÿæˆä¸Šä¸‹æ–‡å¢å¼ºæç¤ºè¯
    #>
    param(
        [Parameter(Mandatory)]
        [string]$CurrentMessage
    )

    # æœç´¢ç›¸å…³è®°å¿†
    $memories = Search-Mem0Memory -Query $CurrentMessage -Limit 3

    if ($memories.Count -eq 0) {
        return $CurrentMessage
    }

    # æ„å»ºå¢å¼ºæç¤ºè¯
    $context = $memories | ForEach-Object {
        "- è®°å¿†: $($_.memory)"
    }

    $enhancedPrompt = @"
æ ¹æ®ä»¥ä¸‹ç›¸å…³è®°å¿†ç”Ÿæˆæ€»ç»“:

ã€ç›¸å…³å†å²ã€‘
$($context -join "`n")

ã€å½“å‰æ¶ˆæ¯ã€‘
$CurrentMessage

è¯·ç”Ÿæˆä¸ªæ€§åŒ–çš„60å­—è¯­éŸ³æ’­æŠ¥æ€»ç»“ã€‚
"@

    return $enhancedPrompt
}

Export-ModuleMember -Function @(
    'Start-Mem0Bridge',
    'Add-Mem0Memory',
    'Search-Mem0Memory',
    'Get-Mem0EnhancedPrompt'
)
```

#### 3. é›†æˆåˆ°ä¸»è„šæœ¬
```powershell
# åœ¨ voice-notification.ps1 ä¸­æ·»åŠ 

Import-Module (Join-Path $PSScriptRoot '..\modules\Mem0Client.psm1') -Force

# ç¡®ä¿ Mem0 æœåŠ¡è¿è¡Œ
Start-Mem0Bridge

# è·å–å¢å¼ºæç¤ºè¯
$enhancedPrompt = Get-Mem0EnhancedPrompt -CurrentMessage $UserMessage

# ç”Ÿæˆæ€»ç»“
$AiSummary = Invoke-OllamaGenerate -Prompt $enhancedPrompt

# ä¿å­˜åˆ° Mem0
Add-Mem0Memory -UserMessage $UserMessage -AssistantReply $AiSummary
```

### å®ç°æ­¥éª¤

#### é˜¶æ®µ1: ç¯å¢ƒæ­å»ºï¼ˆç¬¬1å‘¨ï¼‰
```powershell
# å®‰è£… Mem0
pip install mem0ai

# å®‰è£… Flask
pip install flask

# æ‹‰å– Ollama æ¨¡å‹
ollama pull nomic-embed-text
ollama pull qwen2.5:1.5b
```

#### é˜¶æ®µ2: æ¡¥æ¥æœåŠ¡ï¼ˆç¬¬2-3å‘¨ï¼‰
1. å®ç° `mem0-bridge.py` REST API
2. å®ç° `Mem0Client.psm1` PowerShell å®¢æˆ·ç«¯
3. æµ‹è¯•é€šä¿¡å’Œæ•°æ®æŒä¹…åŒ–

#### é˜¶æ®µ3: è®°å¿†å¢å¼ºï¼ˆç¬¬4-6å‘¨ï¼‰
1. é›†æˆ `Search-Mem0Memory` åˆ°æç¤ºè¯ç”Ÿæˆ
2. å®ç°è‡ªåŠ¨è®°å¿†ä¿å­˜
3. æµ‹è¯•ä¸Šä¸‹æ–‡ç›¸å…³æ€§æå‡

#### é˜¶æ®µ4: é«˜çº§ç‰¹æ€§ï¼ˆç¬¬7-10å‘¨ï¼‰
1. åˆ©ç”¨ Mem0 çš„å¤šçº§è®°å¿†ï¼ˆUser/Session/Agentï¼‰
2. å®ç°åå¥½å˜åŒ–æ£€æµ‹ï¼ˆPAMU æœºåˆ¶ï¼‰
3. ä¼˜åŒ–è®°å¿†æ£€ç´¢ç­–ç•¥

### ä¼˜åŠ¿
âœ… **åŠŸèƒ½æœ€å®Œå–„** - Mem0 æä¾›å¼€ç®±å³ç”¨çš„è®°å¿†ç®¡ç†
âœ… **å¤šçº§è®°å¿†** - User/Session/Agent ä¸‰å±‚æ¶æ„
âœ… **è‡ªåŠ¨å»é‡** - è¯­ä¹‰å»é‡å’Œè®°å¿†åˆå¹¶
âœ… **é—å¿˜æ›²çº¿** - åŸºäºæ—¶é—´çš„è®°å¿†è¡°å‡
âœ… **ä¸»åŠ¨å­¦ä¹ ** - åå¥½å˜åŒ–æ£€æµ‹ï¼ˆPAMUï¼‰

### åŠ£åŠ¿
âš ï¸ **éœ€è¦ Python** - å¢åŠ éƒ¨ç½²å¤æ‚åº¦
âš ï¸ **é¢å¤–è¿›ç¨‹** - Flask æœåŠ¡éœ€å¸¸é©»åå°
âš ï¸ **å­¦ä¹ æˆæœ¬** - Mem0 é…ç½®å’Œè°ƒä¼˜éœ€è¦æ—¶é—´

### èµ„æºéœ€æ±‚
- **ç£ç›˜**: 2GBï¼ˆChromaDB + Mem0 ç´¢å¼•ï¼‰/ 10å¹´
- **å†…å­˜**: 200MBï¼ˆPython + Flask + ChromaDBï¼‰
- **CPU**: è®°å¿†æ£€ç´¢çº¦ 100ms

### 10å¹´æ¼”è¿›è·¯å¾„
```
Year 1-2: Mem0 è‡ªåŠ¨è®°å¿†ç®¡ç†
â”œâ”€ è‡ªåŠ¨è¯­ä¹‰å»é‡
â”œâ”€ ç”¨æˆ·çº§è®°å¿†ç§¯ç´¯
â””â”€ åŸºç¡€ä¸Šä¸‹æ–‡æ£€ç´¢

Year 3-5: åå¥½è‡ªé€‚åº”
â”œâ”€ PAMU æ£€æµ‹åå¥½å˜åŒ–
â”œâ”€ å¤šçº§è®°å¿†ç”Ÿæ•ˆ
â””â”€ ä¸ªæ€§åŒ–æƒé‡è°ƒæ•´

Year 6-10: æ™ºèƒ½ä¼™ä¼´
â”œâ”€ é•¿æœŸè¶‹åŠ¿å»ºæ¨¡
â”œâ”€ ä¸»åŠ¨å»ºè®®ä¼˜åŒ–
â””â”€ æ·±åº¦ä¸ªæ€§åŒ–
```

---

## æ–¹æ¡ˆ3: çº¯ JSON + æ»‘åŠ¨çª—å£ï¼ˆé›¶ä¾èµ–æ–¹æ¡ˆï¼‰

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PowerShell çº¯è„šæœ¬             â”‚
â”‚  (æ— å¤–éƒ¨ä¾èµ–)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JSON æ–‡ä»¶â”‚  â”‚ ç®€å•ç»Ÿè®¡åˆ†æ â”‚
â”‚ å†å²è®°å½• â”‚  â”‚ (é¢‘ç‡/æ¨¡å¼)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. æ•°æ®ç»“æ„ï¼ˆ`data\simple-memory.json`ï¼‰
```json
{
  "interactions": [
    {
      "id": 1,
      "timestamp": "2025-01-13T10:30:00Z",
      "user_message": "åˆ›å»ºç”¨æˆ·æ‰‹å†Œ",
      "ai_summary": "å…ˆç”Ÿ,æ–‡æ¡£å·²åˆ›å»ºå®Œæˆ",
      "emotion": "calm",
      "keywords": ["åˆ›å»º", "æ–‡æ¡£"],
      "success": true
    }
  ],
  "preferences": {
    "emotion_counts": {
      "calm": 45,
      "celebrate": 12,
      "error": 3
    },
    "common_keywords": {
      "åˆ›å»º": 20,
      "ä¿®å¤": 15,
      "ä¼˜åŒ–": 10
    },
    "response_patterns": {
      "æ–‡æ¡£ç±»": "å…ˆç”Ÿ,æ–‡æ¡£å·²{action}å®Œæˆ",
      "ä»£ç ç±»": "{action}æˆåŠŸ,{metric}"
    }
  },
  "window_size": 100,
  "last_cleanup": "2025-01-13T00:00:00Z"
}
```

#### 2. PowerShell è½»é‡çº§è®°å¿†æ¨¡å—ï¼ˆ`modules\SimpleMemory.psm1`ï¼‰
```powershell
function Initialize-SimpleMemory {
    <#
    .SYNOPSIS
        Initialize JSON-based simple memory
        åˆå§‹åŒ–åŸºäº JSON çš„ç®€å•è®°å¿†ç³»ç»Ÿ
    #>
    param(
        [string]$MemoryPath = "$PSScriptRoot\..\data\simple-memory.json",
        [int]$WindowSize = 100
    )

    if (Test-Path $MemoryPath) {
        $memory = Get-Content $MemoryPath -Raw -Encoding UTF8 | ConvertFrom-Json
    }
    else {
        $memory = @{
            interactions = @()
            preferences = @{
                emotion_counts = @{}
                common_keywords = @{}
                response_patterns = @{}
            }
            window_size = $WindowSize
            last_cleanup = (Get-Date).ToString("o")
        }
    }

    return $memory
}

function Add-SimpleMemory {
    <#
    .SYNOPSIS
        Add interaction to simple memory with sliding window
        æ·»åŠ äº¤äº’åˆ°ç®€å•è®°å¿†ï¼ˆæ»‘åŠ¨çª—å£ï¼‰
    #>
    param(
        [Parameter(Mandatory)]
        [PSCustomObject]$Memory,
        [Parameter(Mandatory)]
        [string]$UserMessage,
        [Parameter(Mandatory)]
        [string]$AiSummary,
        [string]$Emotion = "calm"
    )

    # æå–å…³é”®è¯ï¼ˆç®€å•åˆ†è¯ï¼‰
    $keywords = Extract-SimpleKeywords -Text $UserMessage

    # æ·»åŠ æ–°äº¤äº’
    $interaction = @{
        id = $Memory.interactions.Count + 1
        timestamp = (Get-Date).ToString("o")
        user_message = $UserMessage
        ai_summary = $AiSummary
        emotion = $Emotion
        keywords = $keywords
        success = $true
    }

    $Memory.interactions += $interaction

    # æ›´æ–°åå¥½ç»Ÿè®¡
    if ($Memory.preferences.emotion_counts.PSObject.Properties[$Emotion]) {
        $Memory.preferences.emotion_counts.$Emotion++
    }
    else {
        $Memory.preferences.emotion_counts | Add-Member -NotePropertyName $Emotion -NotePropertyValue 1
    }

    foreach ($kw in $keywords) {
        if ($Memory.preferences.common_keywords.PSObject.Properties[$kw]) {
            $Memory.preferences.common_keywords.$kw++
        }
        else {
            $Memory.preferences.common_keywords | Add-Member -NotePropertyName $kw -NotePropertyValue 1
        }
    }

    # æ»‘åŠ¨çª—å£æ¸…ç†ï¼ˆä¿ç•™æœ€è¿‘ N æ¡ï¼‰
    if ($Memory.interactions.Count > $Memory.window_size) {
        $Memory.interactions = $Memory.interactions | Select-Object -Last $Memory.window_size
    }

    return $Memory
}

function Extract-SimpleKeywords {
    <#
    .SYNOPSIS
        Extract simple keywords using regex
        ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–ç®€å•å…³é”®è¯
    #>
    param(
        [Parameter(Mandatory)]
        [string]$Text,
        [int]$MaxKeywords = 5
    )

    # ç®€å•ä¸­æ–‡åˆ†è¯ï¼ˆåŒ¹é…2-4ä¸ªæ±‰å­—çš„è¯ç»„ï¼‰
    $chineseWords = [regex]::Matches($Text, '[\u4e00-\u9fa5]{2,4}') |
        Select-Object -ExpandProperty Value -Unique

    # åŒ¹é…è‹±æ–‡å•è¯
    $englishWords = [regex]::Matches($Text, '\b[a-zA-Z]{3,}\b') |
        Select-Object -ExpandProperty Value -Unique

    # åˆå¹¶å¹¶å»é‡
    $keywords = @($chineseWords) + @($englishWords) |
        Select-Object -First $MaxKeywords

    return $keywords
}

function Find-SimpleContext {
    <#
    .SYNOPSIS
        Find relevant context using keyword matching
        ä½¿ç”¨å…³é”®è¯åŒ¹é…æŸ¥æ‰¾ç›¸å…³ä¸Šä¸‹æ–‡
    #>
    param(
        [Parameter(Mandatory)]
        [PSCustomObject]$Memory,
        [Parameter(Mandatory)]
        [string]$QueryText,
        [int]$TopN = 3
    )

    # æå–æŸ¥è¯¢å…³é”®è¯
    $queryKeywords = Extract-SimpleKeywords -Text $QueryText

    # è®¡ç®—åŒ¹é…åˆ†æ•°ï¼ˆç®€å•å…³é”®è¯é‡å ï¼‰
    $scoredInteractions = $Memory.interactions | ForEach-Object {
        $matchCount = ($_.keywords | Where-Object { $queryKeywords -contains $_ }).Count
        [PSCustomObject]@{
            Interaction = $_
            Score = $matchCount
        }
    } | Where-Object { $_.Score -gt 0 } |
        Sort-Object -Property Score -Descending |
        Select-Object -First $TopN

    return $scoredInteractions.Interaction
}

function Get-SimpleAdaptivePrompt {
    <#
    .SYNOPSIS
        Generate adaptive prompt using simple context
        ä½¿ç”¨ç®€å•ä¸Šä¸‹æ–‡ç”Ÿæˆè‡ªé€‚åº”æç¤ºè¯
    #>
    param(
        [Parameter(Mandatory)]
        [PSCustomObject]$Memory,
        [Parameter(Mandatory)]
        [string]$CurrentMessage
    )

    # æŸ¥æ‰¾ç›¸ä¼¼ä¸Šä¸‹æ–‡
    $context = Find-SimpleContext -Memory $Memory -QueryText $CurrentMessage -TopN 3

    # è·å–æœ€å¸¸ç”¨æƒ…æ„Ÿ
    $preferredEmotion = ($Memory.preferences.emotion_counts.PSObject.Properties |
        Sort-Object -Property Value -Descending |
        Select-Object -First 1).Name

    # æ„å»ºæç¤ºè¯
    if ($context.Count -gt 0) {
        $examples = $context | ForEach-Object {
            "- $($_.user_message) â†’ $($_.ai_summary)"
        }

        $prompt = @"
æ ¹æ®å†å²é£æ ¼ç”Ÿæˆæ€»ç»“:

ã€å†å²æ¡ˆä¾‹ã€‘
$($examples -join "`n")

ã€åå¥½ã€‘æƒ…æ„Ÿ: $preferredEmotion

ã€å½“å‰ã€‘$CurrentMessage

ç”Ÿæˆ60å­—æ’­æŠ¥æ€»ç»“ã€‚
"@
    }
    else {
        $prompt = $CurrentMessage
    }

    return $prompt
}

function Save-SimpleMemory {
    <#
    .SYNOPSIS
        Save memory to JSON file
        ä¿å­˜è®°å¿†åˆ° JSON æ–‡ä»¶
    #>
    param(
        [Parameter(Mandatory)]
        [PSCustomObject]$Memory,
        [string]$Path = "$PSScriptRoot\..\data\simple-memory.json"
    )

    $Memory | ConvertTo-Json -Depth 10 |
        Set-Content -Path $Path -Encoding UTF8
}

Export-ModuleMember -Function @(
    'Initialize-SimpleMemory',
    'Add-SimpleMemory',
    'Find-SimpleContext',
    'Get-SimpleAdaptivePrompt',
    'Save-SimpleMemory'
)
```

#### 3. é›†æˆç¤ºä¾‹
```powershell
# åœ¨ voice-notification.ps1 ä¸­

Import-Module (Join-Path $PSScriptRoot '..\modules\SimpleMemory.psm1') -Force

# åˆå§‹åŒ–è®°å¿†
$memory = Initialize-SimpleMemory

# è·å–è‡ªé€‚åº”æç¤ºè¯
$adaptivePrompt = Get-SimpleAdaptivePrompt -Memory $memory -CurrentMessage $UserMessage

# ç”Ÿæˆæ€»ç»“
$AiSummary = Invoke-OllamaGenerate -Prompt $adaptivePrompt

# ä¿å­˜è®°å¿†
$memory = Add-SimpleMemory -Memory $memory -UserMessage $UserMessage `
    -AiSummary $AiSummary -Emotion $DetectedEmotion

Save-SimpleMemory -Memory $memory
```

### å®ç°æ­¥éª¤

#### é˜¶æ®µ1: æ ¸å¿ƒåŠŸèƒ½ï¼ˆç¬¬1-2å‘¨ï¼‰
1. å®ç° JSON å­˜å‚¨è¯»å†™
2. å®ç°å…³é”®è¯æå–
3. å®ç°æ»‘åŠ¨çª—å£æ¸…ç†

#### é˜¶æ®µ2: ä¸Šä¸‹æ–‡åŒ¹é…ï¼ˆç¬¬3-4å‘¨ï¼‰
1. å®ç°å…³é”®è¯åŒ¹é…ç®—æ³•
2. å®ç°ç®€å•è¯„åˆ†ç³»ç»Ÿ
3. æµ‹è¯•ä¸Šä¸‹æ–‡ç›¸å…³æ€§

#### é˜¶æ®µ3: åå¥½ç»Ÿè®¡ï¼ˆç¬¬5-6å‘¨ï¼‰
1. å®ç°æƒ…æ„Ÿåå¥½ç»Ÿè®¡
2. å®ç°å…³é”®è¯é¢‘ç‡åˆ†æ
3. å®ç°å“åº”æ¨¡å¼è¯†åˆ«

### ä¼˜åŠ¿
âœ… **é›¶ä¾èµ–** - çº¯ PowerShell + JSON,æ— éœ€å¤–éƒ¨å·¥å…·
âœ… **æè½»é‡** - å†…å­˜å ç”¨ < 10MB
âœ… **æ˜“ç»´æŠ¤** - å¯ç›´æ¥ç¼–è¾‘ JSON æ–‡ä»¶
âœ… **é«˜é€æ˜** - æ‰€æœ‰é€»è¾‘æ¸…æ™°å¯è§
âœ… **å¿«é€Ÿéƒ¨ç½²** - æ— éœ€å®‰è£…ä»»ä½•ä¾èµ–

### åŠ£åŠ¿
âš ï¸ **èƒ½åŠ›å—é™** - ä»…åŸºäºå…³é”®è¯åŒ¹é…,æ— è¯­ä¹‰ç†è§£
âš ï¸ **æ‰©å±•æ€§å·®** - å¤§è§„æ¨¡æ•°æ®æ€§èƒ½ä¸‹é™
âš ï¸ **å‡†ç¡®ç‡ä½** - æ— æ³•å¤„ç†å¤æ‚è¯­ä¹‰ç›¸ä¼¼æ€§

### èµ„æºéœ€æ±‚
- **ç£ç›˜**: 50MBï¼ˆJSON æ–‡ä»¶ï¼‰/ 10å¹´
- **å†…å­˜**: 10MBï¼ˆJSON åŠ è½½ï¼‰
- **CPU**: ä¸Šä¸‹æ–‡æŸ¥æ‰¾çº¦ 10ms

### 10å¹´æ¼”è¿›è·¯å¾„
```
Year 1-3: åŸºç¡€æ¨¡å¼è¯†åˆ«
â”œâ”€ å…³é”®è¯ç»Ÿè®¡ç”Ÿæ•ˆ
â”œâ”€ ç®€å•åå¥½è®°å½•
â””â”€ æ¨¡æ¿åŒ–é£æ ¼å½¢æˆ

Year 4-7: æœ‰é™ä¸ªæ€§åŒ–
â”œâ”€ å¸¸ç”¨åœºæ™¯è¯†åˆ«
â”œâ”€ æƒ…æ„Ÿåå¥½ç¨³å®š
â””â”€ å“åº”æ¨¡å¼å›ºåŒ–

Year 8-10: ç“¶é¢ˆæœŸ
â”œâ”€ è¯­ä¹‰ç†è§£ä¸è¶³
â”œâ”€ å¤æ‚åœºæ™¯å›°éš¾
â””â”€ å»ºè®®å‡çº§æ–¹æ¡ˆ1æˆ–2
```

---

## æ–¹æ¡ˆ4: LanceDB åµŒå…¥å¼å‘é‡åº“

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PowerShell + Python    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LanceDB â”‚  â”‚ Ollama   â”‚
â”‚ (Rust)  â”‚  â”‚ åµŒå…¥æ¨¡å‹ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç‰¹ç‚¹

#### Python æ¥å£ï¼ˆéœ€æ¡¥æ¥ï¼‰
```python
import lancedb
import ollama

# åˆå§‹åŒ– LanceDB
db = lancedb.connect("./data/lancedb")

# åˆ›å»ºè¡¨
table = db.create_table(
    "interactions",
    data=[
        {
            "id": 1,
            "user_message": "åˆ›å»ºç”¨æˆ·æ‰‹å†Œ",
            "ai_summary": "æ–‡æ¡£å·²åˆ›å»ºå®Œæˆ",
            "vector": ollama.embeddings(model="nomic-embed-text",
                                       prompt="åˆ›å»ºç”¨æˆ·æ‰‹å†Œ")["embedding"]
        }
    ]
)

# å‘é‡æœç´¢
results = table.search("å¦‚ä½•ç”Ÿæˆæ–‡æ¡£").limit(3).to_list()
```

### ä¼˜åŠ¿
âœ… **é«˜æ€§èƒ½** - Rust å†…æ ¸,é€Ÿåº¦å¿«
âœ… **å¤šæ¨¡æ€** - æ”¯æŒæ–‡æœ¬+å›¾åƒæ£€ç´¢
âœ… **ä½å»¶è¿Ÿ** - 40-60ms æŸ¥è¯¢æ—¶é—´
âœ… **åµŒå…¥å¼** - æ— éœ€ç‹¬ç«‹æœåŠ¡

### åŠ£åŠ¿
âš ï¸ **PowerShell é›†æˆå›°éš¾** - éœ€ Python æ¡¥æ¥
âš ï¸ **æ–‡æ¡£è¾ƒå°‘** - ç¤¾åŒºèµ„æºæœ‰é™
âš ï¸ **å­¦ä¹ æˆæœ¬é«˜** - API è®¾è®¡è¾ƒåº•å±‚

### èµ„æºéœ€æ±‚
- **ç£ç›˜**: 1.5GB / 10å¹´
- **å†…å­˜**: 100MB
- **CPU**: 40-60ms/æŸ¥è¯¢

---

## æ–¹æ¡ˆ5: ChromaDB æœ¬åœ° RAG

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PowerShell + Python    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ChromaDB â”‚  â”‚ Ollama   â”‚
â”‚ (æœ¬åœ°)  â”‚  â”‚ åµŒå…¥æ¨¡å‹ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç‰¹ç‚¹

#### Python å®¢æˆ·ç«¯
```python
import chromadb
import ollama

# åˆå§‹åŒ– ChromaDBï¼ˆæŒä¹…åŒ–ï¼‰
client = chromadb.PersistentClient(path="./data/chromadb")

# åˆ›å»ºé›†åˆ
collection = client.get_or_create_collection(
    name="voice_notifications",
    metadata={"hnsw:space": "cosine"}
)

# æ·»åŠ æ–‡æ¡£
collection.add(
    documents=["åˆ›å»ºç”¨æˆ·æ‰‹å†Œ"],
    metadatas=[{"type": "user_message", "emotion": "calm"}],
    ids=["interaction_1"],
    embeddings=[ollama.embeddings(model="nomic-embed-text",
                                  prompt="åˆ›å»ºç”¨æˆ·æ‰‹å†Œ")["embedding"]]
)

# æŸ¥è¯¢
results = collection.query(
    query_texts=["å¦‚ä½•ç”Ÿæˆæ–‡æ¡£"],
    n_results=3
)
```

### ä¼˜åŠ¿
âœ… **ç®€å•æ˜“ç”¨** - API è®¾è®¡å‹å¥½
âœ… **è½»é‡çº§** - é€‚åˆå°è§„æ¨¡åº”ç”¨
âœ… **æ–‡æ¡£å®Œå–„** - ç¤¾åŒºæ´»è·ƒ

### åŠ£åŠ¿
âš ï¸ **éœ€ Python** - PowerShell é›†æˆå¤æ‚
âš ï¸ **æ€§èƒ½ä¸€èˆ¬** - ä¸å¦‚ LanceDB å’Œ Qdrant
âš ï¸ **åŠŸèƒ½å—é™** - é«˜çº§è¿‡æ»¤èƒ½åŠ›å¼±

### èµ„æºéœ€æ±‚
- **ç£ç›˜**: 1GB / 10å¹´
- **å†…å­˜**: 150MB
- **CPU**: 50-80ms/æŸ¥è¯¢

---

## ğŸ¯ æ€»ä½“æ¨è

### çŸ­æœŸï¼ˆå‰6ä¸ªæœˆï¼‰: æ–¹æ¡ˆ3ï¼ˆçº¯ JSONï¼‰
**ç†ç”±**:
- é›¶ä¾èµ–,ç«‹å³å¯ç”¨
- å¿«é€ŸéªŒè¯è‡ªæˆ‘è¿›åŒ–æ¦‚å¿µ
- ç´¯ç§¯åˆå§‹æ•°æ®ï¼ˆ500-1000æ¡ï¼‰

**å®æ–½å»ºè®®**:
```powershell
# ç«‹å³å®æ–½
1. å®ç° SimpleMemory.psm1
2. é›†æˆåˆ°ç°æœ‰ä¸»è„šæœ¬
3. è§‚å¯Ÿåå¥½ç»Ÿè®¡æ•ˆæœ
```

### ä¸­æœŸï¼ˆ6ä¸ªæœˆåï¼‰: å‡çº§åˆ°æ–¹æ¡ˆ1ï¼ˆSQLite-vec RAGï¼‰
**ç†ç”±**:
- æ•°æ®ç§¯ç´¯åˆ°ä¸€å®šè§„æ¨¡
- éœ€è¦è¯­ä¹‰ç†è§£èƒ½åŠ›
- ä¿æŒ PowerShell åŸç”Ÿ

**è¿ç§»è·¯å¾„**:
```powershell
# JSON â†’ SQLite æ•°æ®è¿ç§»è„šæœ¬
function Migrate-JsonToSqlite {
    $json = Get-Content simple-memory.json | ConvertFrom-Json
    $conn = Initialize-MemoryStore

    foreach ($interaction in $json.interactions) {
        Save-Interaction -Connection $conn `
            -UserMessage $interaction.user_message `
            -AiSummary $interaction.ai_summary `
            -EmotionStyle $interaction.emotion
    }
}
```

### é•¿æœŸï¼ˆ2å¹´åï¼‰: è€ƒè™‘æ–¹æ¡ˆ2ï¼ˆMem0ï¼‰è¿›ä¸€æ­¥å¢å¼º
**ç†ç”±**:
- æ•°æ®è§„æ¨¡è¾¾åˆ° 5000+ æ¡
- éœ€è¦é«˜çº§ç‰¹æ€§ï¼ˆPAMUã€å¤šçº§è®°å¿†ï¼‰
- ç”¨æˆ·å·²ä¹ æƒ¯ç³»ç»Ÿè¿è¡Œ

**è¯„ä¼°æ ‡å‡†**:
- æ˜¯å¦éœ€è¦è‡ªåŠ¨åå¥½å˜åŒ–æ£€æµ‹?
- æ˜¯å¦éœ€è¦æ›´å¤æ‚çš„è®°å¿†ç®¡ç†?
- æ˜¯å¦æ„¿æ„æ¥å— Python ä¾èµ–?

---

## ğŸ“ å®æ–½è·¯çº¿å›¾ï¼ˆåˆ†é˜¶æ®µï¼‰

### ç¬¬1é˜¶æ®µ: MVPï¼ˆ1-2ä¸ªæœˆï¼‰- æ–¹æ¡ˆ3
```
Week 1-2: SimpleMemory.psm1 å¼€å‘
â”œâ”€ JSON å­˜å‚¨è¯»å†™
â”œâ”€ å…³é”®è¯æå–
â””â”€ æ»‘åŠ¨çª—å£

Week 3-4: é›†æˆæµ‹è¯•
â”œâ”€ ä¸»è„šæœ¬é›†æˆ
â”œâ”€ åå¥½ç»Ÿè®¡éªŒè¯
â””â”€ æ—¥å¿—åˆ†æ

ç›®æ ‡: å®ç°åŸºç¡€è®°å¿†åŠŸèƒ½
```

### ç¬¬2é˜¶æ®µ: è¯­ä¹‰å‡çº§ï¼ˆ3-6ä¸ªæœˆï¼‰- æ–¹æ¡ˆ1
```
Month 3: ç¯å¢ƒå‡†å¤‡
â”œâ”€ SQLite + sqlite-vec å®‰è£…
â”œâ”€ MemoryStore.psm1 æ¡†æ¶
â””â”€ æ•°æ®åº“æ¶æ„è®¾è®¡

Month 4: å‘é‡åµŒå…¥
â”œâ”€ Ollama embedding é›†æˆ
â”œâ”€ å‘é‡å­˜å‚¨å®ç°
â””â”€ åŸºç¡€æ£€ç´¢æµ‹è¯•

Month 5: RAG å¢å¼º
â”œâ”€ ç›¸ä¼¼åº¦æœç´¢
â”œâ”€ ä¸Šä¸‹æ–‡æç¤ºè¯ç”Ÿæˆ
â””â”€ æ•ˆæœå¯¹æ¯”æµ‹è¯•

Month 6: ä¼˜åŒ–è¿­ä»£
â”œâ”€ é—å¿˜æ›²çº¿å®ç°
â”œâ”€ è¯­ä¹‰å»é‡
â””â”€ æ€§èƒ½è°ƒä¼˜

ç›®æ ‡: å®ç°è¯­ä¹‰çº§è®°å¿†æ£€ç´¢
```

### ç¬¬3é˜¶æ®µ: é•¿æœŸä¼˜åŒ–ï¼ˆ6ä¸ªæœˆåï¼‰
```
Year 1: æ•°æ®ç§¯ç´¯ä¸è°ƒä¼˜
â”œâ”€ ç´¯ç§¯ 2000+ äº¤äº’æ•°æ®
â”œâ”€ ç›‘æ§æ£€ç´¢è´¨é‡
â””â”€ è°ƒæ•´æƒé‡å‚æ•°

Year 2-3: åå¥½è‡ªé€‚åº”
â”œâ”€ å®ç°æƒ…æ„Ÿåå¥½å­¦ä¹ 
â”œâ”€ è¯æ±‡é£æ ¼è¯†åˆ«
â””â”€ å“åº”ç­–ç•¥ä¼˜åŒ–

Year 4-10: æŒç»­è¿›åŒ–
â”œâ”€ é•¿æœŸè¶‹åŠ¿åˆ†æ
â”œâ”€ ä¸»åŠ¨å»ºè®®ç³»ç»Ÿ
â””â”€ çœŸæ­£ä¸ªæ€§åŒ–ä¼™ä¼´

ç›®æ ‡: 10å¹´å¤åˆ©å¼è¿›åŒ–
```

---

## ğŸ§ª æ•ˆæœè¯„ä¼°æŒ‡æ ‡

### çŸ­æœŸæŒ‡æ ‡ï¼ˆ3ä¸ªæœˆå†…ï¼‰
1. **è®°å¿†å¬å›ç‡** - èƒ½æ‰¾åˆ°ç›¸å…³å†å²äº¤äº’çš„æ¯”ä¾‹ (ç›®æ ‡ >50%)
2. **å“åº”ä¸€è‡´æ€§** - ç›¸ä¼¼åœºæ™¯æ’­æŠ¥é£æ ¼çš„ä¸€è‡´æ€§ (ç›®æ ‡ >70%)
3. **ç³»ç»Ÿæ€§èƒ½** - å“åº”æ—¶é—´å¢åŠ  < 500ms

### ä¸­æœŸæŒ‡æ ‡ï¼ˆ6-12ä¸ªæœˆï¼‰
1. **è¯­ä¹‰ç›¸å…³æ€§** - å‘é‡æœç´¢å‡†ç¡®ç‡ (ç›®æ ‡ >80%)
2. **ä¸ªæ€§åŒ–ç¨‹åº¦** - ä½¿ç”¨ç”¨æˆ·åå¥½è¯æ±‡çš„é¢‘ç‡ (ç›®æ ‡ >60%)
3. **æƒ…æ„ŸåŒ¹é…** - è‡ªåŠ¨é€‰æ‹©çš„æƒ…æ„Ÿé£æ ¼ä¸å®é™…åŒ¹é…åº¦ (ç›®æ ‡ >75%)

### é•¿æœŸæŒ‡æ ‡ï¼ˆ2-10å¹´ï¼‰
1. **ç”¨æˆ·æ»¡æ„åº¦** - ä¸»è§‚è¯„ä»·ä¸ªæ€§åŒ–ç¨‹åº¦
2. **è‡ªç„¶åº¦æå‡** - æ’­æŠ¥æ–‡æœ¬çš„è‡ªç„¶åº¦è¯„åˆ†
3. **é¢„æµ‹å‡†ç¡®æ€§** - èƒ½é¢„æµ‹ç”¨æˆ·åå¥½åœºæ™¯çš„å‡†ç¡®ç‡

---

## ğŸ’¡ å…³é”®è®¾è®¡åŸåˆ™

### 1. æ¸è¿›å¼æ¼”è¿›
- ä¸è¿½æ±‚å¿«é€Ÿè§æ•ˆ,è®¾è®¡ä¸º10å¹´æ—¶é—´ç»´åº¦
- æ¯ä¸ªç‰ˆæœ¬ä¿æŒå‘åå…¼å®¹
- æ•°æ®è¿ç§»è„šæœ¬å®Œå–„

### 2. ç”¨æˆ·å¯æ§
- æä¾›è®°å¿†æŸ¥çœ‹ç•Œé¢ï¼ˆæœªæ¥ Web UIï¼‰
- å…è®¸æ‰‹åŠ¨åˆ é™¤/ç¼–è¾‘è®°å¿†
- é€æ˜çš„å­¦ä¹ è¿‡ç¨‹æ—¥å¿—

### 3. éšç§ä¼˜å…ˆ
- æ‰€æœ‰æ•°æ®æœ¬åœ°å­˜å‚¨
- ä¸ä¸Šä¼ ä»»ä½•ä¿¡æ¯åˆ°äº‘ç«¯
- æ”¯æŒæ•°æ®å¯¼å‡ºå’Œå¤‡ä»½

### 4. æ€§èƒ½ä¼˜åŒ–
- å¼‚æ­¥åŠ è½½è®°å¿†æ¨¡å—
- ç¼“å­˜å¸¸ç”¨æ£€ç´¢ç»“æœ
- å®šæœŸæ•°æ®åº“ç»´æŠ¤è„šæœ¬

---

## ğŸ“š å‚è€ƒèµ„æº

### æ–¹æ¡ˆ1 å‚è€ƒ
- [sqlite-vec GitHub](https://github.com/asg017/sqlite-vec)
- [SQLite for Embeddings](https://medium.com/@tfmv/sqlite-for-embeddings-3fe30ee5efbf)
- [System.Data.SQLite](https://system.data.sqlite.org/)

### æ–¹æ¡ˆ2 å‚è€ƒ
- [Mem0 å®˜æ–¹æ–‡æ¡£](https://docs.mem0.ai/)
- [Mem0 GitHub](https://github.com/mem0ai/mem0)
- [PAMU è®ºæ–‡](https://arxiv.org/abs/2510.09720)

### æ–¹æ¡ˆ3 å‚è€ƒ
- PowerShell JSON æ“ä½œ: `ConvertTo-Json` / `ConvertFrom-Json`
- æ­£åˆ™è¡¨è¾¾å¼ä¸­æ–‡åˆ†è¯: `[\u4e00-\u9fa5]{2,4}`

### å‘é‡åµŒå…¥
- [Ollama Embedding API](https://ollama.com/blog/embedding-models)
- [nomic-embed-text æ¨¡å‹](https://ollama.com/library/nomic-embed-text)

### ç†è®ºåŸºç¡€
- [é—å¿˜æ›²çº¿ç†è®º](https://supermemo.guru/wiki/Forgetting_curve)
- [é•¿æœŸè®°å¿†ç³»ç»Ÿ](https://arxiv.org/html/2410.15665v1)
- [åå¥½å­¦ä¹  PAMU](https://arxiv.org/abs/2510.09720)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆæ–¹æ¡ˆ3 - ç«‹å³å¯ç”¨ï¼‰

### 1. åˆ›å»ºè®°å¿†æ¨¡å—
```powershell
# å¤åˆ¶ SimpleMemory.psm1 åˆ° modules ç›®å½•
# ï¼ˆä»£ç è§ä¸Šæ–‡æ–¹æ¡ˆ3ï¼‰
```

### 2. åˆå§‹åŒ–æ•°æ®
```powershell
# åˆ›å»º data ç›®å½•
New-Item -ItemType Directory -Path ".\data" -Force

# åˆ›å»ºç©ºç™½è®°å¿†æ–‡ä»¶
@{
    interactions = @()
    preferences = @{
        emotion_counts = @{}
        common_keywords = @{}
    }
    window_size = 100
    last_cleanup = (Get-Date).ToString("o")
} | ConvertTo-Json -Depth 10 | Set-Content ".\data\simple-memory.json" -Encoding UTF8
```

### 3. é›†æˆåˆ°ä¸»è„šæœ¬
```powershell
# åœ¨ voice-notification.ps1 å¼€å¤´æ·»åŠ 
Import-Module (Join-Path $PSScriptRoot '..\modules\SimpleMemory.psm1') -Force

# åœ¨ç”Ÿæˆæ€»ç»“å‰
$memory = Initialize-SimpleMemory
$adaptivePrompt = Get-SimpleAdaptivePrompt -Memory $memory -CurrentMessage $UserMessage

# åœ¨ä¿å­˜æ—¥å¿—å
$memory = Add-SimpleMemory -Memory $memory `
    -UserMessage $UserMessage `
    -AiSummary $AiSummary `
    -Emotion $DetectedEmotion
Save-SimpleMemory -Memory $memory
```

### 4. æµ‹è¯•æ•ˆæœ
```powershell
# è¿è¡Œå‡ æ¬¡ç›¸ä¼¼ä»»åŠ¡,è§‚å¯Ÿæ—¥å¿—
# æŸ¥çœ‹ simple-memory.json ä¸­çš„åå¥½ç»Ÿè®¡
Get-Content .\data\simple-memory.json | ConvertFrom-Json |
    Select-Object -ExpandProperty preferences
```

---

## ğŸ“ æ€»ç»“å»ºè®®

å£®çˆ¸,é’ˆå¯¹æ‚¨çš„è¯­éŸ³é€šçŸ¥ç³»ç»Ÿ,æˆ‘çš„**æœ€ç»ˆæ¨èè·¯å¾„**æ˜¯:

### ğŸ¥‡ ç«‹å³å®æ–½ï¼ˆæœ¬å‘¨ï¼‰: æ–¹æ¡ˆ3ï¼ˆçº¯ JSONï¼‰
- **ç†ç”±**: é›¶ä¾èµ–,å¿«é€ŸéªŒè¯æ¦‚å¿µ
- **ç›®æ ‡**: ç´¯ç§¯ 100+ æ¡åˆå§‹æ•°æ®
- **æ—¶é—´**: 1-2å‘¨å®ŒæˆåŸºç¡€ç‰ˆæœ¬

### ğŸ¥ˆ 6ä¸ªæœˆåå‡çº§: æ–¹æ¡ˆ1ï¼ˆSQLite-vec RAGï¼‰
- **ç†ç”±**: æ•°æ®ç§¯ç´¯å……è¶³,éœ€è¦è¯­ä¹‰ç†è§£
- **ç›®æ ‡**: å®ç°çœŸæ­£çš„è¯­ä¹‰çº§è®°å¿†æ£€ç´¢
- **æ—¶é—´**: 2-3ä¸ªæœˆå®Œæˆè¿ç§»

### ğŸ¥‰ é•¿æœŸè€ƒè™‘ï¼ˆ2å¹´+ï¼‰: æ–¹æ¡ˆ2ï¼ˆMem0ï¼‰
- **ç†ç”±**: éœ€è¦é«˜çº§ç‰¹æ€§ï¼ˆPAMUã€å¤šçº§è®°å¿†ï¼‰
- **ç›®æ ‡**: æœ€å¤§åŒ–ä¸ªæ€§åŒ–èƒ½åŠ›
- **å‰æ**: æ•°æ®è§„æ¨¡ > 5000æ¡,æ„¿æ„æ¥å— Python ä¾èµ–

è¿™ä¸ªè·¯å¾„**ç¬¦åˆæ‚¨çš„é•¿æœŸä¸»ä¹‰ç†å¿µ**:
- âœ… ä»ç®€å•å¼€å§‹,é€æ­¥æ¼”è¿›
- âœ… æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®ä»·å€¼
- âœ… ä¿æŒæœ¬åœ°åŒ–ã€è½»é‡çº§åŸåˆ™
- âœ… 10å¹´æ—¶é—´ç»´åº¦çš„å¤åˆ©è®¾è®¡

éœ€è¦æˆ‘æä¾›ä»»ä½•å…·ä½“å®ç°ä»£ç æˆ–è¿›ä¸€æ­¥çš„æŠ€æœ¯ç»†èŠ‚å—?
