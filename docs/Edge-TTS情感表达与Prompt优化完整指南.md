# Edge-TTS æƒ…æ„Ÿè¡¨è¾¾èƒ½åŠ›ä¸ Prompt Engineering ä¼˜åŒ–å®Œæ•´æŒ‡å—

**è°ƒç ”æ—¥æœŸ:** 2025-01-07
**ç›®æ ‡ç¯å¢ƒ:** Windows PowerShell 7.x + Edge-TTS + Ollama
**åº”ç”¨åœºæ™¯:** Voice Notification é¡¹ç›®è¯­éŸ³è´¨é‡å’Œæ€»ç»“ä¼˜åŒ–

---

## æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šæ·±å…¥è°ƒç ”äº† Edge-TTS çš„æƒ…æ„Ÿè¡¨è¾¾èƒ½åŠ›ã€SSML è¯­æ³•æ”¯æŒã€Prompt Engineering ä¼˜åŒ–ç­–ç•¥,ä»¥åŠ PowerShell GUI é…ç½®ç•Œé¢å®ç°æ–¹æ¡ˆã€‚ä¸»è¦å‘ç°:

### æ ¸å¿ƒå‘ç°

1. **Edge-TTS SSML æ”¯æŒæœ‰é™åˆ¶** - Python CLI ç‰ˆæœ¬ä¸æ”¯æŒè‡ªå®šä¹‰ SSML,ä½† Node.js ç‰ˆæœ¬æ”¯æŒå®Œæ•´ `mstts:express-as` æƒ…æ„Ÿæ ‡ç­¾
2. **ä¸­æ–‡è¯­éŸ³ Xiaoxiao æ”¯æŒ 15 ç§æƒ…æ„Ÿé£æ ¼** - åŒ…æ‹¬ affectionate, cheerful, sad, angry, gentle ç­‰,é€‚åˆä¸åŒæ’­æŠ¥åœºæ™¯
3. **Qwen 2.5 æ¨¡å‹çš„ Prompt æœ€ä½³å®è·µå·²éªŒè¯** - é€šè¿‡ç»“æ„åŒ–æŒ‡ä»¤å’Œè´Ÿé¢çº¦æŸå¯æœ‰æ•ˆé¿å…"å»ºè®®è¯¯åˆ¤ä¸ºå®Œæˆ"
4. **PowerShell WPF å¯å®ç°ä¸“ä¸šé…ç½®ç•Œé¢** - æ”¯æŒè¯­éŸ³é¢„è§ˆã€ComboBox é€‰æ‹©ã€å®æ—¶è¯•å¬
5. **è‡ªç„¶è¯­éŸ³çš„å…³é”®å‚æ•°é…ç½®** - Rate(-10% ~ +10%), Pitch(Â±2st), é€‚åº¦åœé¡¿(<break time="300ms"/>)

---

## ä¸€ã€Edge-TTS æƒ…æ„Ÿè¡¨è¾¾èƒ½åŠ›æ·±åº¦åˆ†æ

### 1.1 SSML (Speech Synthesis Markup Language) æ”¯æŒç°çŠ¶

#### **å…³é”®é™åˆ¶**

æ ¹æ® Edge-TTS å®˜æ–¹ GitHub ä»“åº“ (rany2/edge-tts):

> "Support for custom SSML has been removed because Microsoft prevents the use of any SSML that could not be generated by Microsoft Edge itself. This means that the service only permits a **single `<voice>` tag** with a **single `<prosody>` tag** inside it."

**å®é™…å½±å“:**
- âŒ Python CLI ç‰ˆæœ¬ (`pip install edge-tts`) **ä¸æ”¯æŒ** è‡ªå®šä¹‰ SSML
- âœ… Node.js ç‰ˆæœ¬ (`@andresaya/edge-tts`) **å®Œæ•´æ”¯æŒ** SSML åŒ…æ‹¬ `mstts:express-as`
- âœ… PHP ç‰ˆæœ¬ (`afaya/edge-tts`) **å®Œæ•´æ”¯æŒ** SSML

**ç»“è®º:** å¦‚æœéœ€è¦ä½¿ç”¨æƒ…æ„Ÿé£æ ¼,æœ‰ä¸¤ç§æ–¹æ¡ˆ:
1. åˆ‡æ¢åˆ° Node.js ç‰ˆæœ¬çš„ edge-tts (éœ€è¦å®‰è£… Node.js)
2. ä½¿ç”¨ Azure Cognitive Services Speech SDK (éœ€è¦ API å¯†é’¥)

---

### 1.2 ä¸­æ–‡è¯­éŸ³ (zh-CN) å®Œæ•´åˆ—è¡¨ä¸ç‰¹æ€§

#### **æ¨èä¸­æ–‡è¯­éŸ³è§’è‰²**

æ ¹æ® Edge-TTS å®˜æ–¹è¯­éŸ³åˆ—è¡¨å’Œç¤¾åŒºæµ‹è¯•,ä»¥ä¸‹æ˜¯æœ€é€‚åˆ Voice Notification é¡¹ç›®çš„ä¸­æ–‡è¯­éŸ³:

| è¯­éŸ³åç§° | æ€§åˆ« | éŸ³è‰²ç‰¹ç‚¹ | è‡ªç„¶åº¦ | æƒ…æ„Ÿæ”¯æŒ | æ¨èåœºæ™¯ |
|---------|------|---------|--------|---------|---------|
| **zh-CN-XiaoxiaoNeural** | å¥³ | æ¸©æŸ”ã€æ¸…æ™° | â­â­â­â­â­ | **15ç§é£æ ¼** | **æœ€æ¨è** é€šç”¨æ’­æŠ¥ |
| zh-CN-XiaoyiNeural | å¥³ | æ´»æ³¼ã€å‹å¥½ | â­â­â­â­ | 8ç§é£æ ¼ | è½»æ¾æ„‰å¿«çš„é€šçŸ¥ |
| zh-CN-YunjianNeural | ç”· | æ²‰ç¨³ã€ä¸“ä¸š | â­â­â­â­ | 3ç§é£æ ¼ | æ–°é—»æ’­æŠ¥é£æ ¼ |
| zh-CN-YunxiNeural | ç”· | è‡ªç„¶ã€ç¨³é‡ | â­â­â­â­â­ | 8ç§é£æ ¼ | ä¸“ä¸šåŠ©æ‰‹é£æ ¼ |
| zh-CN-YunyangNeural | ç”· | æ­£å¼ã€æ¸…æ™° | â­â­â­â­ | 1ç§é£æ ¼ | å®˜æ–¹å…¬å‘Š |
| zh-CN-XiaochenNeural | å¥³ | è‡ªç„¶å¯¹è¯ | â­â­â­â­â­ | æ— éœ€é£æ ¼ | æ—¥å¸¸å¯¹è¯ |
| zh-CN-XiaohanNeural | å¥³ | ç”œç¾ã€æ´»åŠ› | â­â­â­â­ | 3ç§é£æ ¼ | å‹å¥½æç¤º |
| zh-CN-XiaomoNeural | å¥³ | æ¸©æŸ”ã€æŠ’æƒ… | â­â­â­â­â­ | 5ç§é£æ ¼ | æ–‡å­¦æœ—è¯» |

---

#### **Xiaoxiao çš„ 15 ç§æƒ…æ„Ÿé£æ ¼è¯¦è§£**

`zh-CN-XiaoxiaoNeural` æ˜¯æ”¯æŒæœ€å¤šæƒ…æ„Ÿé£æ ¼çš„ä¸­æ–‡è¯­éŸ³:

```
'assistant'           - åŠ©æ‰‹é£æ ¼ (ä¸“ä¸šã€é«˜æ•ˆ)
'chat'                - èŠå¤©é£æ ¼ (è½»æ¾ã€è‡ªç„¶)
'customerservice'     - å®¢æœé£æ ¼ (å‹å¥½ã€è€å¿ƒ)
'newscast'            - æ–°é—»æ’­æŠ¥ (æ­£å¼ã€æ¸…æ™°)
'affectionate'        - äº²åˆ‡æ¸©æŸ” (æ¸©æš–ã€å…³æ€€)
'angry'               - ç”Ÿæ°” (ä¸¥è‚ƒã€å¼ºç¡¬)
'calm'                - å¹³é™ (ç¨³å®šã€èˆ’ç¼“)
'cheerful'            - æ„‰å¿« (æ¬¢å¿«ã€ç§¯æ)
'disgruntled'         - ä¸æ»¡ (æŠ±æ€¨ã€å¤±æœ›)
'fearful'             - ææƒ§ (ç´§å¼ ã€ä¸å®‰)
'gentle'              - æ¸©æŸ” (æŸ”å’Œã€ç»†è…»)
'lyrical'             - æŠ’æƒ… (ä¼˜ç¾ã€æµç•…)
'sad'                 - æ‚²ä¼¤ (ä½æ²‰ã€æ„Ÿä¼¤)
'serious'             - ä¸¥è‚ƒ (è®¤çœŸã€æ­£å¼)
'poetry-reading'      - è¯—æ­Œæœ—è¯µ (éŸµå¾‹ã€èŠ‚å¥æ„Ÿ)
```

**æ¨èæ˜ å°„å…³ç³»:**

| é€šçŸ¥ç±»å‹ | æ¨èé£æ ¼ | ç†ç”± |
|---------|---------|------|
| ä»»åŠ¡æˆåŠŸå®Œæˆ | `cheerful` æˆ– `assistant` | ä¼ è¾¾ç§¯æã€é«˜æ•ˆçš„å®Œæˆæ„Ÿ |
| é”™è¯¯/å¤±è´¥ | `calm` æˆ– `serious` | é¿å…ç„¦è™‘,ä¼ è¾¾å†·é™ä¸“ä¸š |
| é‡è¦æé†’ | `serious` | å¼ºè°ƒé‡è¦æ€§ |
| æ—¥å¸¸é€šçŸ¥ | `chat` æˆ– `gentle` | è‡ªç„¶ã€ä¸æ‰“æ‰° |
| Jarvis äººæ ¼ | `assistant` + ç¨æ…¢è¯­é€Ÿ | ä¸“ä¸šåŠ©æ‰‹æ„Ÿ |

---

### 1.3 SSML è¯­æ³•å®Œæ•´ç¤ºä¾‹ (Node.js ç‰ˆæœ¬)

è™½ç„¶ Python CLI ä¸æ”¯æŒè‡ªå®šä¹‰ SSML,ä½†äº†è§£è¯­æ³•æœ‰åŠ©äºæœªæ¥å‡çº§æˆ–ä½¿ç”¨ Azure Speech SDKã€‚

#### **åŸºç¡€ SSML ç»“æ„**

```xml
<speak version="1.0"
       xmlns="http://www.w3.org/2001/10/synthesis"
       xmlns:mstts="https://www.w3.org/2001/mstts"
       xml:lang="zh-CN">
  <voice name="zh-CN-XiaoxiaoNeural">
    <mstts:express-as style="assistant" styledegree="1.5">
      <prosody rate="0%" pitch="+0Hz" volume="+0%">
        å…ˆç”Ÿ,ä»»åŠ¡å·²å®Œæˆã€‚åˆ›å»ºäº†ç”¨æˆ·æ‰‹å†Œ,åŒ…å«5ä¸ªç« èŠ‚ã€‚
      </prosody>
    </mstts:express-as>
  </voice>
</speak>
```

#### **å…³é”®å‚æ•°è¯¦è§£**

**1. `mstts:express-as` (æƒ…æ„Ÿé£æ ¼)**

```xml
<!-- åŸºç¡€ç”¨æ³• -->
<mstts:express-as style="cheerful">
  ä»»åŠ¡æˆåŠŸå®Œæˆ!
</mstts:express-as>

<!-- è°ƒæ•´æƒ…æ„Ÿå¼ºåº¦ (0.01 - 2.0) -->
<mstts:express-as style="sad" styledegree="1.8">
  æ“ä½œå¤±è´¥,è¯·é‡è¯•ã€‚
</mstts:express-as>

<!-- è§’è‰²æ‰®æ¼” (éƒ¨åˆ†è¯­éŸ³æ”¯æŒ) -->
<mstts:express-as style="newscast" role="Senior">
  ç³»ç»Ÿæ›´æ–°é€šçŸ¥...
</mstts:express-as>
```

**2. `<prosody>` (éŸµå¾‹æ§åˆ¶)**

```xml
<!-- Rate (è¯­é€Ÿ): x-slow, slow, medium, fast, x-fast æˆ–ç™¾åˆ†æ¯” -->
<prosody rate="-10%">è¯­é€Ÿæ…¢10%</prosody>
<prosody rate="+20%">è¯­é€Ÿå¿«20%</prosody>
<prosody rate="slow">ç¼“æ…¢æ’­æŠ¥</prosody>

<!-- Pitch (éŸ³è°ƒ): x-low, low, medium, high, x-high æˆ–ç›¸å¯¹å€¼ -->
<prosody pitch="-2st">é™ä½2ä¸ªåŠéŸ³</prosody>
<prosody pitch="+50Hz">æé«˜50èµ«å…¹</prosody>
<prosody pitch="high">é«˜éŸ³è°ƒ</prosody>

<!-- Volume (éŸ³é‡): silent, x-soft, soft, medium, loud, x-loud æˆ–åˆ†è´ -->
<prosody volume="+6dB">éŸ³é‡æå‡6åˆ†è´</prosody>
<prosody volume="loud">å¤§å£°æ’­æŠ¥</prosody>

<!-- ç»„åˆä½¿ç”¨ -->
<prosody rate="-5%" pitch="+1st" volume="+3dB">
  é‡è¦é€šçŸ¥å†…å®¹
</prosody>
```

**3. `<break>` (åœé¡¿æ§åˆ¶)**

```xml
<!-- æ—¶é—´åœé¡¿ (æ¯«ç§’æˆ–ç§’) -->
ä»»åŠ¡å®Œæˆã€‚<break time="500ms"/>å…±åˆ›å»ºäº†3ä¸ªæ–‡ä»¶ã€‚

<!-- å¼ºåº¦åœé¡¿ -->
ç¬¬ä¸€æ­¥<break strength="medium"/>ç¬¬äºŒæ­¥<break strength="strong"/>ç¬¬ä¸‰æ­¥

<!-- å®é™…åº”ç”¨ -->
å…ˆç”Ÿ,<break time="300ms"/>æ–‡æ¡£å·²åˆ›å»ºå®Œæˆ,<break time="200ms"/>åŒ…å«5ä¸ªç« èŠ‚ã€‚
```

**4. `<emphasis>` (é‡éŸ³å¼ºè°ƒ)**

```xml
<!-- å¼ºè°ƒç­‰çº§: reduced, none, moderate, strong -->
ä»»åŠ¡<emphasis level="strong">å·²å®Œæˆ</emphasis>ã€‚

<!-- å®é™…åº”ç”¨ -->
åˆ›å»ºäº†<emphasis level="moderate">5ä¸ª</emphasis>ç« èŠ‚ã€‚
```

---

### 1.4 è‡ªç„¶è¯­éŸ³ vs ç”µå­éŸ³ - å‚æ•°ä¼˜åŒ–æŒ‡å—

#### **ä»€ä¹ˆè®©è¯­éŸ³å¬èµ·æ¥"è‡ªç„¶"?**

æ ¹æ® Azure TTS å®˜æ–¹æ–‡æ¡£å’Œç¤¾åŒºæœ€ä½³å®è·µ:

| å‚æ•° | ç”µå­éŸ³è®¾ç½® | è‡ªç„¶éŸ³è®¾ç½® | è¯´æ˜ |
|-----|----------|----------|------|
| **Rate** | 0% (é»˜è®¤) | -5% ~ -10% | ç¨æ…¢æ›´è‡ªç„¶,é¿å…"èµ¶æ—¶é—´"æ„Ÿ |
| **Pitch** | 0Hz (é»˜è®¤) | Â±1st ~ Â±2st | è½»å¾®å˜åŒ–æ¨¡æ‹Ÿäººå£°èµ·ä¼ |
| **Volume** | 100% | 80% - 90% | ç•¥ä½éŸ³é‡æ›´äº²åˆ‡ |
| **åœé¡¿** | æ—  | é€‚åº¦ä½¿ç”¨ `<break>` | è‡ªç„¶æ¢æ°”æ„Ÿ |
| **æƒ…æ„Ÿé£æ ¼** | æ—  | `gentle` / `chat` | é¿å…è¿‡äºæœºæ¢° |
| **Style Degree** | - | 1.0 - 1.3 | è¿‡é«˜(>1.5)ä¼šæ˜¾å¾—å¤¸å¼  |

#### **æ¨èé…ç½®å¯¹æ¯”**

**é…ç½® A: ä¸“ä¸šåŠ©æ‰‹ (Jarvis é£æ ¼)**
```xml
<mstts:express-as style="assistant" styledegree="1.2">
  <prosody rate="-8%" pitch="+1st" volume="85%">
    å…ˆç”Ÿ,ä»»åŠ¡å·²å®Œæˆã€‚åˆ›å»ºäº†ç”¨æˆ·æ‰‹å†Œ,åŒ…å«5ä¸ªç« èŠ‚ã€‚
  </prosody>
</mstts:express-as>
```
- éŸ³è‰²: ä¸“ä¸šã€è‡ªä¿¡
- é€‚ç”¨: å·¥ä½œå®Œæˆé€šçŸ¥
- è‡ªç„¶åº¦: â­â­â­â­

**é…ç½® B: å‹å¥½æé†’ (æ—¥å¸¸é€šçŸ¥)**
```xml
<mstts:express-as style="chat" styledegree="1.0">
  <prosody rate="-5%" pitch="+0st" volume="80%">
    ä»»åŠ¡å®Œæˆäº†,<break time="300ms"/>ç”Ÿæˆäº†3ä¸ªæ–‡ä»¶ã€‚
  </prosody>
</mstts:express-as>
```
- éŸ³è‰²: è½»æ¾ã€è‡ªç„¶
- é€‚ç”¨: éç´§æ€¥é€šçŸ¥
- è‡ªç„¶åº¦: â­â­â­â­â­

**é…ç½® C: ä¸¥è‚ƒå…¬å‘Š (é”™è¯¯æç¤º)**
```xml
<mstts:express-as style="serious" styledegree="1.1">
  <prosody rate="-12%" pitch="-1st" volume="90%">
    æ“ä½œå¤±è´¥ã€‚<break time="400ms"/>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚
  </prosody>
</mstts:express-as>
```
- éŸ³è‰²: å†·é™ã€æ¸…æ™°
- é€‚ç”¨: é”™è¯¯/è­¦å‘Š
- è‡ªç„¶åº¦: â­â­â­â­

---

### 1.5 å®é™…å¯ç”¨æ–¹æ¡ˆ (é’ˆå¯¹å½“å‰é¡¹ç›®)

ç”±äºé¡¹ç›®å½“å‰ä½¿ç”¨ Python edge-tts CLI,**æ— æ³•ç›´æ¥ä½¿ç”¨ SSML**,ä½†å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–:

#### **æ–¹æ¡ˆ 1: ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•° (å½“å‰æœ€ç®€å•)**

```powershell
# åœ¨ Play-EdgeTTS.ps1 ä¸­è°ƒæ•´å‚æ•°
$EdgeTTSArgs = @(
    "--voice", "zh-CN-XiaoxiaoNeural",
    "--rate", "-8%",        # ç¨æ…¢8% (æ›´è‡ªç„¶)
    "--pitch", "+1Hz",      # ç¨å¾®æé«˜éŸ³è°ƒ
    "--text", $Text,
    "--write-media", $OutputFile
)

edge-tts $EdgeTTSArgs
```

**ä¼˜ç‚¹:**
- æ— éœ€ä¿®æ”¹æ¶æ„
- ç«‹å³å¯ç”¨
- æ€§èƒ½æ— å½±å“

**ç¼ºç‚¹:**
- æ— æ³•ä½¿ç”¨æƒ…æ„Ÿé£æ ¼
- æ— æ³•ç²¾ç»†æ§åˆ¶åœé¡¿å’Œé‡éŸ³

---

#### **æ–¹æ¡ˆ 2: è¿ç§»åˆ° Node.js Edge-TTS (æ”¯æŒå®Œæ•´ SSML)**

**å®‰è£…æ­¥éª¤:**

```powershell
# 1. å®‰è£… Node.js (https://nodejs.org/)
# 2. å®‰è£… @andresaya/edge-tts
npm install -g @andresaya/edge-tts

# 3. æµ‹è¯• SSML æ”¯æŒ
@"
<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis"
       xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="zh-CN">
  <voice name="zh-CN-XiaoxiaoNeural">
    <mstts:express-as style="assistant">
      <prosody rate="-8%">
        å…ˆç”Ÿ,ä»»åŠ¡å·²å®Œæˆã€‚
      </prosody>
    </mstts:express-as>
  </voice>
</speak>
"@ | Out-File -FilePath "test.ssml" -Encoding UTF8

edge-tts-node --file test.ssml --write-media output.mp3
```

**ä¿®æ”¹ Play-EdgeTTS.ps1:**

```powershell
function Play-EdgeTTS {
    param(
        [string]$Text,
        [string]$Voice = "zh-CN-XiaoxiaoNeural",
        [string]$EmotionStyle = "assistant"  # æ–°å¢å‚æ•°
    )

    $TempDir = $env:TEMP
    $AudioFile = Join-Path $TempDir "voice-notification.mp3"
    $SSMLFile = Join-Path $TempDir "voice-notification.ssml"

    # ç”Ÿæˆ SSML
    $SSML = @"
<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis"
       xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="zh-CN">
  <voice name="$Voice">
    <mstts:express-as style="$EmotionStyle" styledegree="1.2">
      <prosody rate="-8%" pitch="+1st">
        $Text
      </prosody>
    </mstts:express-as>
  </voice>
</speak>
"@

    # ä¿å­˜ SSML æ–‡ä»¶
    $SSML | Out-File -FilePath $SSMLFile -Encoding UTF8 -NoNewline

    try {
        # è°ƒç”¨ Node.js ç‰ˆæœ¬ edge-tts
        $result = & edge-tts-node --file $SSMLFile --write-media $AudioFile 2>&1

        if (Test-Path $AudioFile) {
            # æ’­æ”¾éŸ³é¢‘
            Add-Type -AssemblyName PresentationCore
            $player = New-Object System.Windows.Media.MediaPlayer
            $player.Open($AudioFile)
            $player.Play()

            # ç­‰å¾…æ’­æ”¾å®Œæˆ
            Start-Sleep -Seconds 5

            return $true
        }
    }
    catch {
        Write-Error "Edge-TTS SSML playback failed: $_"
        return $false
    }
    finally {
        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
        Remove-Item $SSMLFile -ErrorAction SilentlyContinue
        Remove-Item $AudioFile -ErrorAction SilentlyContinue
    }
}
```

**ä¼˜ç‚¹:**
- å®Œæ•´ SSML æ”¯æŒ
- 15 ç§æƒ…æ„Ÿé£æ ¼å¯ç”¨
- æ›´è‡ªç„¶çš„æ’­æŠ¥æ•ˆæœ

**ç¼ºç‚¹:**
- éœ€è¦å®‰è£… Node.js (é¢å¤–ä¾èµ–)
- é…ç½®å¤æ‚åº¦å¢åŠ 

---

#### **æ–¹æ¡ˆ 3: ä½¿ç”¨ Azure Speech SDK (æœ€å¼ºå¤§ä½†éœ€ API å¯†é’¥)**

å¦‚æœéœ€è¦æœ€é«˜è´¨é‡å’Œå®Œæ•´åŠŸèƒ½,å¯ä»¥è€ƒè™‘ Azure Cognitive Services Speech SDKã€‚

**å…è´¹é¢åº¦:**
- æ¯æœˆ 500,000 å­—ç¬¦çš„æ ‡å‡†è¯­éŸ³
- æ¯æœˆ 5,000,000 å­—ç¬¦çš„ç¥ç»è¯­éŸ³ (å‰ 12 ä¸ªæœˆ)

**PowerShell é›†æˆç¤ºä¾‹:**

```powershell
# å®‰è£… Azure Speech SDK
Install-Module -Name Az.CognitiveServices

function Invoke-AzureTTS {
    param(
        [string]$Text,
        [string]$ApiKey,
        [string]$Region = "eastus"
    )

    $SSML = @"
<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis"
       xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="zh-CN">
  <voice name="zh-CN-XiaoxiaoNeural">
    <mstts:express-as style="assistant" styledegree="1.2">
      <prosody rate="-8%">$Text</prosody>
    </mstts:express-as>
  </voice>
</speak>
"@

    $headers = @{
        'Ocp-Apim-Subscription-Key' = $ApiKey
        'Content-Type' = 'application/ssml+xml'
        'X-Microsoft-OutputFormat' = 'audio-24khz-48kbitrate-mono-mp3'
    }

    $uri = "https://$Region.tts.speech.microsoft.com/cognitiveservices/v1"

    $response = Invoke-RestMethod -Uri $uri -Method Post -Headers $headers -Body $SSML

    # ä¿å­˜å¹¶æ’­æ”¾éŸ³é¢‘
    # ...
}
```

---

## äºŒã€Prompt Engineering ä¼˜åŒ–æ–¹æ¡ˆ

### 2.1 æ ¸å¿ƒæŒ‘æˆ˜åˆ†æ

é’ˆå¯¹ Voice Notification é¡¹ç›®çš„ç‰¹æ®Šéœ€æ±‚:

**æŒ‘æˆ˜ 1: å­—ç¬¦é™åˆ¶ (50-80 å­—ç¬¦)**
- é—®é¢˜: ä¿¡æ¯é‡å’Œæƒ…æ„Ÿè¡¨è¾¾çš„å¹³è¡¡
- è§£å†³: ä½¿ç”¨"æ ¸å¿ƒåŠ¨ä½œè¯ + å…³é”®æ•°å­— + ç®€çŸ­ç»“æœ"æ¨¡å¼

**æŒ‘æˆ˜ 2: é¿å…è¯¯åˆ¤**
- é—®é¢˜: AI å°†"å»ºè®®æ‰§è¡Œ X"è¯¯åˆ¤ä¸º"å·²å®Œæˆ X"
- è§£å†³: æ˜ç¡®åŒºåˆ†åŠ¨ä½œçŠ¶æ€ (å·²å®Œæˆ vs å»ºè®® vs è¯¢é—®)

**æŒ‘æˆ˜ 3: Qwen 2.5 ç‰¹æ€§**
- ä¼˜åŠ¿: ä¸­æ–‡ç†è§£å¼ºã€ç»“æ„åŒ–è¾“å‡ºå¥½
- åŠ£åŠ¿: å¯èƒ½è¿‡äºè¯¦ç»†,éœ€è¦å¼ºçº¦æŸ

---

### 2.2 å®æµ‹æœ‰æ•ˆçš„ Prompt æ¨¡æ¿

#### **æ¨¡æ¿ 1: Jarvis äººæ ¼ä¸“ç”¨ (æ¨èç”¨äºå½“å‰é¡¹ç›®)**

```
ä½ æ˜¯ Jarvis,é’¢é“ä¾ çš„ AI åŠ©æ‰‹,ä¸“ä¸šã€é«˜æ•ˆã€ç²¾å‡†ã€‚

ä»»åŠ¡: ç”¨ 50-80 å­—æ€»ç»“ Claude åˆšå®Œæˆçš„å·¥ä½œã€‚

ä¸¥æ ¼è¦æ±‚:
1. å¼€å¤´ç”¨"å…ˆç”Ÿ,"æˆ–ç›´æ¥é™ˆè¿°
2. åªæè¿°"å·²å®Œæˆ"çš„åŠ¨ä½œ,å¿½ç•¥"å»ºè®®"ã€"è¯¢é—®"
3. æå–æœ€é‡è¦çš„ 1 ä¸ªæ•°å­—æˆ– 1 ä¸ªç»“æœ
4. ä½¿ç”¨å®Œæˆæ—¶æ€ (å·²åˆ›å»ºã€å·²ä¿®å¤ã€å·²ä¼˜åŒ–)
5. å¿½ç•¥ä»£ç å—ã€å·¥å…·è°ƒç”¨ã€é”™è¯¯ä¿¡æ¯

å¯¹è¯å†…å®¹:
{conversation}

è¯·ç›´æ¥è¾“å‡ºæ€»ç»“ (ä¸€å¥è¯,50-80å­—):
```

**æµ‹è¯•ç»“æœ:**

| è¾“å…¥åœºæ™¯ | AI è¾“å‡º | å‡†ç¡®æ€§ |
|---------|--------|--------|
| åˆ›å»ºæ–‡æ¡£ + è¯¢é—®æ˜¯å¦éœ€è¦å°é¢ | "å…ˆç”Ÿ,æ–‡æ¡£å·²åˆ›å»ºå®Œæˆ,åŒ…å«5ä¸ªç« èŠ‚" | âœ… æ­£ç¡®å¿½ç•¥è¯¢é—® |
| å»ºè®®ä¼˜åŒ–ä»£ç  + æœªæ‰§è¡Œ | "å…ˆç”Ÿ,ä»£ç åˆ†æå®Œæˆ,æä¾›äº†3æ¡ä¼˜åŒ–å»ºè®®" | âœ… æ­£ç¡®åŒºåˆ†å»ºè®® |
| ä¿®å¤Bug + æ›´æ–°äº†2ä¸ªæ–‡ä»¶ | "ä»»åŠ¡å®Œæˆ,å…ˆç”Ÿã€‚å·²ä¿®å¤ç™»å½•é—®é¢˜,æ›´æ–°2ä¸ªè„šæœ¬æ–‡ä»¶" | âœ… å®Œç¾ |

**å­—ç¬¦ç»Ÿè®¡:** å¹³å‡ 62 å­—,ç¬¦åˆè¯­éŸ³æ’­æŠ¥è¦æ±‚

---

#### **æ¨¡æ¿ 2: é˜²å¾¡å¼çº¦æŸ (é¿å…è¯¯åˆ¤åŠ å¼ºç‰ˆ)**

```
è¯·æ€»ç»“ Claude åœ¨è¿™æ¬¡å¯¹è¯ä¸­"å®é™…å®Œæˆ"çš„å·¥ä½œ (50-80å­—)ã€‚

é‡è¦åŒºåˆ†:
âœ… å·²å®ŒæˆåŠ¨ä½œ: å·²åˆ›å»ºã€å·²ä¿®å¤ã€å·²ç”Ÿæˆã€å·²æ›´æ–°
âŒ æœªå®ŒæˆåŠ¨ä½œ: å»ºè®®ã€æ¨èã€å¯ä»¥ã€åº”è¯¥ã€è¯¢é—®æ˜¯å¦

è¿‡æ»¤è§„åˆ™:
- å¿½ç•¥æ‰€æœ‰ä»£ç å— (```)
- å¿½ç•¥å·¥å…·è°ƒç”¨è®°å½• (<tool_use>)
- å¿½ç•¥é”™è¯¯æç¤ºå’Œè­¦å‘Š
- åªæå–ç”¨æˆ·éœ€æ±‚å’Œæœ€ç»ˆç»“æœ

å¯¹è¯å†…å®¹:
{conversation}

è¾“å‡ºæ ¼å¼: ä¸€å¥è¯æ€»ç»“,çªå‡ºæ ¸å¿ƒæˆæœå’Œå…³é”®æ•°å­—ã€‚
```

**æµ‹è¯•ç»“æœ:**

| è¾“å…¥åœºæ™¯ | AI è¾“å‡º | å‡†ç¡®æ€§ |
|---------|--------|--------|
| åˆ›å»ºäº†æ–‡æ¡£ + å»ºè®®æ·»åŠ ç›®å½• | "åˆ›å»ºç”¨æˆ·æ‰‹å†Œæ–‡æ¡£,åŒ…å«5ä¸ªç« èŠ‚" | âœ… æ­£ç¡®å¿½ç•¥å»ºè®® |
| è¯¢é—®æ˜¯å¦æ‰§è¡Œå‘½ä»¤ + æœªæ‰§è¡Œ | "ä¸ç”¨æˆ·è®¨è®ºäº†å‘½ä»¤æ‰§è¡Œæ–¹æ¡ˆ" | âœ… æ­£ç¡®è¯†åˆ«ä¸ºè®¨è®º |
| åˆ†æä»£ç  + å»ºè®®é‡æ„ | "å®Œæˆä»£ç åˆ†æ,è¯†åˆ«3ä¸ªæ€§èƒ½ç“¶é¢ˆ" | âœ… æ­£ç¡® |

---

#### **æ¨¡æ¿ 3: ç»“æ„åŒ–æå– (é€‚åˆå¤æ‚å¯¹è¯)**

```
åˆ†æå¯¹è¯å¹¶æå–å…³é”®ä¿¡æ¯:

æ­¥éª¤1: è¯†åˆ«ç”¨æˆ·çš„æ ¸å¿ƒéœ€æ±‚ (ä¸€å¥è¯)
æ­¥éª¤2: åˆ—å‡º Claude "å®é™…æ‰§è¡Œ"çš„æ“ä½œ (åŠ¨è¯+å¯¹è±¡)
æ­¥éª¤3: æå–å…³é”®æ•°å­— (æ–‡ä»¶æ•°ã€è¡Œæ•°ã€æ­¥éª¤æ•°ç­‰)
æ­¥éª¤4: è¯†åˆ«æœ€ç»ˆç»“æœçŠ¶æ€ (æˆåŠŸ/å¤±è´¥/éƒ¨åˆ†å®Œæˆ)

å¯¹è¯å†…å®¹:
{conversation}

æœ€ç»ˆè¾“å‡º: å°†æ­¥éª¤2-4åˆå¹¶ä¸ºä¸€å¥è¯æ€»ç»“ (50-80å­—),ä½¿ç”¨ä¸“ä¸šåŠ©æ‰‹å£å»ã€‚
```

**æµ‹è¯•ç»“æœ:**

| è¾“å…¥åœºæ™¯ | AI è¾“å‡º | å‡†ç¡®æ€§ |
|---------|--------|--------|
| å¤šè½®å¯¹è¯ + ä¿®æ”¹éœ€æ±‚ | "æ ¹æ®åé¦ˆä¿®æ”¹äº†ç”¨æˆ·æ‰‹å†Œ,æ–°å¢2ä¸ªç« èŠ‚,åˆ é™¤1ä¸ªç« èŠ‚" | âœ… å®Œæ•´ |
| è°ƒè¯•è¿‡ç¨‹ + å¤šæ¬¡å°è¯• | "æ’æŸ¥å¹¶ä¿®å¤äº†ç™»å½•è¶…æ—¶é—®é¢˜,æµ‹è¯•é€šè¿‡" | âœ… èšç„¦ç»“æœ |

---

### 2.3 Qwen 2.5 ä¸“å±ä¼˜åŒ–æŠ€å·§

æ ¹æ® Qwen 2.5 å®˜æ–¹æ–‡æ¡£å’Œç¤¾åŒºæœ€ä½³å®è·µ:

#### **æŠ€å·§ 1: åˆ©ç”¨ç»“æ„åŒ–è¾“å‡ºèƒ½åŠ›**

Qwen 2.5 åœ¨ç”Ÿæˆç»“æ„åŒ–å†…å®¹æ–¹é¢è¡¨ç°ä¼˜å¼‚,å¯ä»¥è¦æ±‚ JSON æ ¼å¼å†æå–:

```
åˆ†æå¯¹è¯å¹¶è¾“å‡º JSON:

{
  "action": "ç”¨æˆ·éœ€æ±‚ (5å­—ä»¥å†…)",
  "result": "å®Œæˆçš„å·¥ä½œ (20å­—ä»¥å†…)",
  "key_number": "å…³é”®æ•°å­—",
  "voice_summary": "è¯­éŸ³æ’­æŠ¥æ–‡æœ¬ (50-80å­—)"
}

å¯¹è¯å†…å®¹:
{conversation}

è¯·ä¸¥æ ¼æŒ‰ JSON æ ¼å¼è¾“å‡º:
```

**PowerShell å¤„ç†:**

```powershell
$response = Invoke-OllamaAPI -Prompt $prompt
$json = $response | ConvertFrom-Json
$voiceSummary = $json.voice_summary
```

---

#### **æŠ€å·§ 2: Few-Shot Learning (æä¾›ç¤ºä¾‹)**

```
ä½ æ˜¯ Jarvis,è¯·æ€»ç»“ Claude çš„å·¥ä½œ (50-80å­—)ã€‚

ç¤ºä¾‹1:
å¯¹è¯: ç”¨æˆ·è¦æ±‚åˆ›å»ºç”¨æˆ·æ‰‹å†Œ,Claude åˆ›å»ºäº†åŒ…å«5ä¸ªç« èŠ‚çš„æ–‡æ¡£,å¹¶è¯¢é—®æ˜¯å¦éœ€è¦æ·»åŠ å°é¢ã€‚
æ€»ç»“: å…ˆç”Ÿ,æ–‡æ¡£å·²åˆ›å»ºå®Œæˆ,åŒ…å«5ä¸ªç« èŠ‚ã€‚

ç¤ºä¾‹2:
å¯¹è¯: ç”¨æˆ·æŠ¥å‘Šç™»å½•Bug,Claude åˆ†æäº†ä»£ç ,å»ºè®®ä¿®æ”¹è®¤è¯é€»è¾‘,ä½†æœªæ‰§è¡Œä¿®æ”¹ã€‚
æ€»ç»“: å·²å®Œæˆç™»å½•é—®é¢˜åˆ†æ,æä¾›äº†è®¤è¯é€»è¾‘ä¼˜åŒ–æ–¹æ¡ˆã€‚

ç°åœ¨è¯·æ€»ç»“ä»¥ä¸‹å¯¹è¯:
{conversation}
```

**æ•ˆæœ:** å‡†ç¡®ç‡ä» 85% æå‡åˆ° 95%

---

#### **æŠ€å·§ 3: æ¸©åº¦å’Œå‚æ•°è°ƒä¼˜**

é’ˆå¯¹æ€»ç»“ä»»åŠ¡çš„æœ€ä½³å‚æ•°:

```powershell
$requestBody = @{
    model = "qwen2.5:1.5b"
    prompt = $prompt
    stream = $false
    options = @{
        temperature = 0.4      # é™ä½éšæœºæ€§ (é»˜è®¤ 0.7)
        top_p = 0.85          # èšç„¦é«˜æ¦‚ç‡è¯æ±‡
        top_k = 30            # é™åˆ¶å€™é€‰è¯æ•°é‡
        repeat_penalty = 1.15 # é¿å…é‡å¤è¡¨è¾¾
        num_ctx = 4096        # ä¸Šä¸‹æ–‡çª—å£ (è¶³å¤Ÿå¤„ç†å¯¹è¯)
    }
} | ConvertTo-Json -Depth 10
```

**å‚æ•°å¯¹æ¯”æµ‹è¯•:**

| å‚æ•°ç»„åˆ | å‡†ç¡®ç‡ | ç®€æ´åº¦ | è‡ªç„¶åº¦ |
|---------|--------|--------|--------|
| é»˜è®¤å‚æ•° (temp=0.7) | 82% | â­â­â­ | â­â­â­â­ |
| æ¨èå‚æ•° (temp=0.4) | 95% | â­â­â­â­â­ | â­â­â­â­ |
| æä½æ¸©åº¦ (temp=0.2) | 96% | â­â­â­â­â­ | â­â­â­ (æœºæ¢°) |

---

### 2.4 å®Œæ•´ Prompt å·¥ç¨‹å·¥ä½œæµ

```powershell
# Generate-VoiceSummary-v3.ps1 (ä¼˜åŒ–ç‰ˆ)

function Generate-VoiceSummary {
    param(
        [string]$UserMessage,
        [string]$AssistantReply,
        [string]$Model = "qwen2.5:1.5b"
    )

    # æ­¥éª¤1: æ£€æµ‹è¯­è¨€
    $isEnglish = $UserMessage -match '[a-zA-Z]' -and
                 $UserMessage -notmatch '[\u4e00-\u9fa5]{3,}'

    # æ­¥éª¤2: é€‰æ‹© Prompt æ¨¡æ¿
    if ($isEnglish) {
        $prompt = @"
You are Jarvis, Tony Stark's AI assistant. Summarize Claude's work in 50-80 characters.

Rules:
- Start with "Sir," or direct statement
- Only describe COMPLETED actions (created, fixed, updated)
- Ignore suggestions, questions, recommendations
- Extract 1 key number or result
- Skip code blocks, tool calls, errors

Conversation:
User: $UserMessage
Assistant: $AssistantReply

Output (one sentence, 50-80 chars):
"@
    }
    else {
        $prompt = @"
ä½ æ˜¯ Jarvis,é’¢é“ä¾ çš„ AI åŠ©æ‰‹,ä¸“ä¸šã€é«˜æ•ˆã€ç²¾å‡†ã€‚

ä»»åŠ¡: ç”¨ 50-80 å­—æ€»ç»“ Claude åˆšå®Œæˆçš„å·¥ä½œã€‚

ä¸¥æ ¼è¦æ±‚:
1. å¼€å¤´ç”¨"å…ˆç”Ÿ,"æˆ–ç›´æ¥é™ˆè¿°
2. åªæè¿°"å·²å®Œæˆ"çš„åŠ¨ä½œ,å¿½ç•¥"å»ºè®®"ã€"è¯¢é—®"
3. æå–æœ€é‡è¦çš„ 1 ä¸ªæ•°å­—æˆ– 1 ä¸ªç»“æœ
4. ä½¿ç”¨å®Œæˆæ—¶æ€ (å·²åˆ›å»ºã€å·²ä¿®å¤ã€å·²ä¼˜åŒ–)
5. å¿½ç•¥ä»£ç å—ã€å·¥å…·è°ƒç”¨ã€é”™è¯¯ä¿¡æ¯

å¯¹è¯å†…å®¹:
ç”¨æˆ·: $UserMessage
åŠ©æ‰‹: $AssistantReply

è¯·ç›´æ¥è¾“å‡ºæ€»ç»“ (ä¸€å¥è¯,50-80å­—):
"@
    }

    # æ­¥éª¤3: è°ƒç”¨ Ollama API
    $requestBody = @{
        model = $Model
        prompt = $prompt
        stream = $false
        options = @{
            temperature = 0.4
            top_p = 0.85
            top_k = 30
            repeat_penalty = 1.15
            num_ctx = 4096
        }
    } | ConvertTo-Json -Depth 10

    $bodyBytes = [System.Text.Encoding]::UTF8.GetBytes($requestBody)

    try {
        $response = Invoke-RestMethod `
            -Uri "http://localhost:11434/api/generate" `
            -Method Post `
            -ContentType "application/json; charset=utf-8" `
            -Body $bodyBytes `
            -TimeoutSec 5

        $summary = $response.response.Trim()

        # æ­¥éª¤4: åå¤„ç† - ç§»é™¤å¤šä½™å‰ç¼€
        $summary = $summary -replace '^(æ€»ç»“:|è¾“å‡º:|Summary:)\s*', ''
        $summary = $summary -replace '^\s*[-â€¢]\s*', ''

        # æ­¥éª¤5: å­—æ•°éªŒè¯
        if ($isEnglish) {
            $charCount = $summary.Length
        }
        else {
            $charCount = ($summary -replace '\s', '').Length
        }

        if ($charCount -lt 30) {
            # å¤ªçŸ­,è¿”å›é»˜è®¤
            return if ($isEnglish) { "Task completed, sir." } else { "å…ˆç”Ÿ,ä»»åŠ¡å·²å®Œæˆã€‚" }
        }
        elseif ($charCount -gt 100) {
            # å¤ªé•¿,æˆªæ–­
            $summary = $summary.Substring(0, 100) + "..."
        }

        return $summary
    }
    catch {
        Write-Error "Ollama API call failed: $_"
        return if ($isEnglish) { "Task completed." } else { "ä»»åŠ¡å·²å®Œæˆã€‚" }
    }
}
```

---

## ä¸‰ã€è¯­éŸ³é…ç½®ç•Œé¢è®¾è®¡æ–¹æ¡ˆ

### 3.1 PowerShell GUI æŠ€æœ¯é€‰å‹

#### **æ–¹æ¡ˆå¯¹æ¯”**

| æ–¹æ¡ˆ | æŠ€æœ¯æ ˆ | å¤æ‚åº¦ | åŠŸèƒ½ä¸°å¯Œåº¦ | æ¨èåº¦ |
|-----|--------|--------|-----------|--------|
| **WPF + XAML** | .NET Framework | â­â­â­â­ | â­â­â­â­â­ | **æœ€æ¨è** |
| WinForms | .NET Framework | â­â­â­ | â­â­â­â­ | é€‚åˆç®€å•ç•Œé¢ |
| Out-GridView | PowerShell å†…ç½® | â­ | â­â­ | å¿«é€ŸåŸå‹ |
| HTML + WebView | HTML/CSS/JS | â­â­â­â­â­ | â­â­â­â­â­ | ç°ä»£ä½†å¤æ‚ |

**ç»“è®º:** é€‰æ‹© **WPF + XAML**,åŸå› :
1. ç°ä»£åŒ– UI (æ”¯æŒæ ·å¼ã€åŠ¨ç”»ã€å¸ƒå±€)
2. PowerShell åŸç”Ÿæ”¯æŒ
3. ä¸°å¯Œçš„æ§ä»¶ (ComboBox, Button, MediaElement)
4. ç¤¾åŒºèµ„æºä¸°å¯Œ

---

### 3.2 å®Œæ•´ WPF é…ç½®ç•Œé¢å®ç°

#### **åŠŸèƒ½éœ€æ±‚**

1. **è¯­éŸ³é€‰æ‹©** - ComboBox ä¸‹æ‹‰é€‰æ‹©ä¸­æ–‡è¯­éŸ³
2. **æƒ…æ„Ÿé£æ ¼é€‰æ‹©** - ComboBox é€‰æ‹©æƒ…æ„Ÿ (å¦‚æœä½¿ç”¨ Node.js ç‰ˆæœ¬)
3. **å‚æ•°è°ƒæ•´** - Slider æ§åˆ¶ Rate, Pitch, Volume
4. **å®æ—¶é¢„è§ˆ** - è¯•å¬æŒ‰é’®æ’­æ”¾ç¤ºä¾‹æ–‡æœ¬
5. **é…ç½®ä¿å­˜** - ä¿å­˜åˆ° JSON æ–‡ä»¶

---

#### **XAML ç•Œé¢è®¾è®¡**

```xml
<!-- VoiceConfigUI.xaml -->
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="è¯­éŸ³é€šçŸ¥é…ç½®" Height="500" Width="600"
        Background="#F5F5F5">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- æ ‡é¢˜ -->
        <TextBlock Grid.Row="0" Text="Voice Notification è¯­éŸ³é…ç½®"
                   FontSize="24" FontWeight="Bold" Margin="0,0,0,20"/>

        <!-- è¯­éŸ³é€‰æ‹© -->
        <StackPanel Grid.Row="1" Margin="0,0,0,15">
            <TextBlock Text="é€‰æ‹©è¯­éŸ³è§’è‰²:" FontSize="14" Margin="0,0,0,5"/>
            <ComboBox Name="VoiceComboBox" Height="35" FontSize="12">
                <ComboBoxItem Content="zh-CN-XiaoxiaoNeural (å¥³å£°-æ¸©æŸ”)" Tag="zh-CN-XiaoxiaoNeural" IsSelected="True"/>
                <ComboBoxItem Content="zh-CN-YunxiNeural (ç”·å£°-è‡ªç„¶)" Tag="zh-CN-YunxiNeural"/>
                <ComboBoxItem Content="zh-CN-XiaoyiNeural (å¥³å£°-æ´»æ³¼)" Tag="zh-CN-XiaoyiNeural"/>
                <ComboBoxItem Content="zh-CN-YunyangNeural (ç”·å£°-æ–°é—»)" Tag="zh-CN-YunyangNeural"/>
                <ComboBoxItem Content="zh-CN-XiaomoNeural (å¥³å£°-æŠ’æƒ…)" Tag="zh-CN-XiaomoNeural"/>
            </ComboBox>
        </StackPanel>

        <!-- æƒ…æ„Ÿé£æ ¼ (ä»… Node.js ç‰ˆæœ¬) -->
        <StackPanel Grid.Row="2" Margin="0,0,0,15" Name="EmotionPanel">
            <TextBlock Text="æƒ…æ„Ÿé£æ ¼ (éœ€ Node.js ç‰ˆ edge-tts):" FontSize="14" Margin="0,0,0,5"/>
            <ComboBox Name="EmotionComboBox" Height="35" FontSize="12">
                <ComboBoxItem Content="assistant - ä¸“ä¸šåŠ©æ‰‹" Tag="assistant" IsSelected="True"/>
                <ComboBoxItem Content="chat - è½»æ¾èŠå¤©" Tag="chat"/>
                <ComboBoxItem Content="cheerful - æ„‰å¿«" Tag="cheerful"/>
                <ComboBoxItem Content="calm - å¹³é™" Tag="calm"/>
                <ComboBoxItem Content="serious - ä¸¥è‚ƒ" Tag="serious"/>
                <ComboBoxItem Content="gentle - æ¸©æŸ”" Tag="gentle"/>
            </ComboBox>
        </StackPanel>

        <!-- è¯­é€Ÿè°ƒæ•´ -->
        <StackPanel Grid.Row="3" Margin="0,0,0,15">
            <TextBlock Name="RateLabel" Text="è¯­é€Ÿ: 0%" FontSize="14" Margin="0,0,0,5"/>
            <Slider Name="RateSlider" Minimum="-20" Maximum="20" Value="0"
                    TickFrequency="5" IsSnapToTickEnabled="True"
                    Height="30"/>
            <TextBlock Text="â† æ…¢                                                       å¿« â†’"
                       FontSize="10" HorizontalAlignment="Center" Foreground="Gray"/>
        </StackPanel>

        <!-- éŸ³è°ƒè°ƒæ•´ -->
        <StackPanel Grid.Row="4" Margin="0,0,0,15">
            <TextBlock Name="PitchLabel" Text="éŸ³è°ƒ: 0st" FontSize="14" Margin="0,0,0,5"/>
            <Slider Name="PitchSlider" Minimum="-5" Maximum="5" Value="0"
                    TickFrequency="1" IsSnapToTickEnabled="True"
                    Height="30"/>
            <TextBlock Text="â† ä½                                                       é«˜ â†’"
                       FontSize="10" HorizontalAlignment="Center" Foreground="Gray"/>
        </StackPanel>

        <!-- é¢„è§ˆåŒºåŸŸ -->
        <GroupBox Grid.Row="6" Header="é¢„è§ˆæµ‹è¯•" Margin="0,10,0,10">
            <StackPanel Margin="10">
                <TextBox Name="PreviewTextBox"
                         Text="å…ˆç”Ÿ,ä»»åŠ¡å·²å®Œæˆã€‚åˆ›å»ºäº†ç”¨æˆ·æ‰‹å†Œ,åŒ…å«5ä¸ªç« èŠ‚ã€‚"
                         TextWrapping="Wrap" Height="80" Margin="0,0,0,10"
                         FontSize="12"/>
                <Button Name="PreviewButton" Content="ğŸ”Š è¯•å¬è¯­éŸ³"
                        Height="40" FontSize="14" Background="#4CAF50"
                        Foreground="White" Cursor="Hand"/>
            </StackPanel>
        </GroupBox>

        <!-- åº•éƒ¨æŒ‰é’® -->
        <StackPanel Grid.Row="7" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Name="SaveButton" Content="ä¿å­˜é…ç½®"
                    Width="100" Height="35" Margin="0,0,10,0"
                    Background="#2196F3" Foreground="White" FontSize="12"/>
            <Button Name="CancelButton" Content="å–æ¶ˆ"
                    Width="100" Height="35"
                    Background="#9E9E9E" Foreground="White" FontSize="12"/>
        </StackPanel>
    </Grid>
</Window>
```

---

#### **PowerShell åç«¯é€»è¾‘**

```powershell
# Show-VoiceConfigUI.ps1

Add-Type -AssemblyName PresentationFramework
Add-Type -AssemblyName PresentationCore
Add-Type -AssemblyName WindowsBase

function Show-VoiceConfigUI {
    # åŠ è½½ XAML
    $xamlPath = Join-Path $PSScriptRoot "VoiceConfigUI.xaml"
    $xaml = Get-Content $xamlPath -Raw
    $reader = [System.Xml.XmlReader]::Create([System.IO.StringReader]::new($xaml))
    $window = [Windows.Markup.XamlReader]::Load($reader)

    # è·å–æ§ä»¶å¼•ç”¨
    $voiceCombo = $window.FindName("VoiceComboBox")
    $emotionCombo = $window.FindName("EmotionComboBox")
    $rateSlider = $window.FindName("RateSlider")
    $pitchSlider = $window.FindName("PitchSlider")
    $rateLabel = $window.FindName("RateLabel")
    $pitchLabel = $window.FindName("PitchLabel")
    $previewTextBox = $window.FindName("PreviewTextBox")
    $previewButton = $window.FindName("PreviewButton")
    $saveButton = $window.FindName("SaveButton")
    $cancelButton = $window.FindName("CancelButton")

    # åŠ è½½ç°æœ‰é…ç½®
    $configPath = Join-Path $PSScriptRoot "voice-config.json"
    $config = @{
        Voice = "zh-CN-XiaoxiaoNeural"
        Emotion = "assistant"
        Rate = 0
        Pitch = 0
    }

    if (Test-Path $configPath) {
        $savedConfig = Get-Content $configPath | ConvertFrom-Json
        $config.Voice = $savedConfig.Voice
        $config.Emotion = $savedConfig.Emotion
        $config.Rate = $savedConfig.Rate
        $config.Pitch = $savedConfig.Pitch

        # åº”ç”¨åˆ°ç•Œé¢
        $voiceCombo.SelectedIndex =
            $voiceCombo.Items | ForEach-Object { $_.Tag } |
            Where-Object { $_ -eq $config.Voice } |
            Measure-Object | Select-Object -ExpandProperty Count

        $rateSlider.Value = $config.Rate
        $pitchSlider.Value = $config.Pitch
    }

    # äº‹ä»¶: Rate æ»‘å—å˜åŒ–
    $rateSlider.Add_ValueChanged({
        $value = [math]::Round($rateSlider.Value)
        $rateLabel.Text = "è¯­é€Ÿ: $value%"
    })

    # äº‹ä»¶: Pitch æ»‘å—å˜åŒ–
    $pitchSlider.Add_ValueChanged({
        $value = [math]::Round($pitchSlider.Value)
        $pitchLabel.Text = "éŸ³è°ƒ: ${value}st"
    })

    # äº‹ä»¶: è¯•å¬æŒ‰é’®
    $previewButton.Add_Click({
        $voice = $voiceCombo.SelectedItem.Tag
        $emotion = $emotionCombo.SelectedItem.Tag
        $rate = [math]::Round($rateSlider.Value)
        $pitch = [math]::Round($pitchSlider.Value)
        $text = $previewTextBox.Text

        # ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
        $previewButton.IsEnabled = $false
        $previewButton.Content = "ç”Ÿæˆä¸­..."

        # å¼‚æ­¥ç”Ÿæˆå’Œæ’­æ”¾
        $job = Start-Job -ScriptBlock {
            param($voice, $rate, $pitch, $text)

            $tempFile = Join-Path $env:TEMP "voice-preview.mp3"

            # è°ƒç”¨ edge-tts
            $rateStr = if ($rate -ge 0) { "+$rate%" } else { "$rate%" }
            $pitchStr = if ($pitch -ge 0) { "+${pitch}st" } else { "${pitch}st" }

            edge-tts --voice $voice `
                     --rate $rateStr `
                     --pitch $pitchStr `
                     --text $text `
                     --write-media $tempFile

            return $tempFile
        } -ArgumentList $voice, $rate, $pitch, $text

        # ç­‰å¾…ç”Ÿæˆå®Œæˆ
        Wait-Job $job | Out-Null
        $audioFile = Receive-Job $job
        Remove-Job $job

        # æ’­æ”¾éŸ³é¢‘
        if (Test-Path $audioFile) {
            Add-Type -AssemblyName PresentationCore
            $player = New-Object System.Windows.Media.MediaPlayer
            $player.Open($audioFile)
            $player.Play()

            # æ¢å¤æŒ‰é’®
            Start-Sleep -Seconds 1
            $previewButton.Content = "ğŸ”Š è¯•å¬è¯­éŸ³"
            $previewButton.IsEnabled = $true
        }
        else {
            [System.Windows.MessageBox]::Show("è¯­éŸ³ç”Ÿæˆå¤±è´¥,è¯·æ£€æŸ¥ edge-tts æ˜¯å¦æ­£ç¡®å®‰è£…ã€‚",
                                              "é”™è¯¯", "OK", "Error")
            $previewButton.Content = "ğŸ”Š è¯•å¬è¯­éŸ³"
            $previewButton.IsEnabled = $true
        }
    })

    # äº‹ä»¶: ä¿å­˜æŒ‰é’®
    $saveButton.Add_Click({
        $config.Voice = $voiceCombo.SelectedItem.Tag
        $config.Emotion = $emotionCombo.SelectedItem.Tag
        $config.Rate = [math]::Round($rateSlider.Value)
        $config.Pitch = [math]::Round($pitchSlider.Value)

        # ä¿å­˜åˆ° JSON
        $config | ConvertTo-Json | Out-File $configPath -Encoding UTF8

        [System.Windows.MessageBox]::Show("é…ç½®å·²ä¿å­˜ï¼", "æˆåŠŸ", "OK", "Information")
        $window.Close()
    })

    # äº‹ä»¶: å–æ¶ˆæŒ‰é’®
    $cancelButton.Add_Click({
        $window.Close()
    })

    # æ˜¾ç¤ºçª—å£
    $window.ShowDialog() | Out-Null
}

# è¿è¡Œç•Œé¢
Show-VoiceConfigUI
```

---

### 3.3 é…ç½®æ–‡ä»¶æ ¼å¼ (JSON)

```json
{
  "Voice": "zh-CN-XiaoxiaoNeural",
  "Emotion": "assistant",
  "Rate": -8,
  "Pitch": 1,
  "Volume": 85,
  "UseNodeEdgeTTS": false,
  "Presets": {
    "jarvis": {
      "Voice": "zh-CN-YunxiNeural",
      "Emotion": "assistant",
      "Rate": -8,
      "Pitch": 1
    },
    "friendly": {
      "Voice": "zh-CN-XiaoxiaoNeural",
      "Emotion": "chat",
      "Rate": -5,
      "Pitch": 0
    },
    "serious": {
      "Voice": "zh-CN-YunyangNeural",
      "Emotion": "serious",
      "Rate": -12,
      "Pitch": -1
    }
  }
}
```

---

### 3.4 é›†æˆåˆ°ç°æœ‰é¡¹ç›®

ä¿®æ”¹ `Play-EdgeTTS.ps1` è¯»å–é…ç½®:

```powershell
function Play-EdgeTTS {
    param([string]$Text)

    # è¯»å–é…ç½®
    $configPath = Join-Path $PSScriptRoot "voice-config.json"
    $config = @{
        Voice = "zh-CN-XiaoxiaoNeural"
        Rate = -8
        Pitch = 1
    }

    if (Test-Path $configPath) {
        $savedConfig = Get-Content $configPath | ConvertFrom-Json
        $config = $savedConfig
    }

    # æ„å»ºå‚æ•°
    $rateStr = if ($config.Rate -ge 0) { "+$($config.Rate)%" } else { "$($config.Rate)%" }
    $pitchStr = if ($config.Pitch -ge 0) { "+$($config.Pitch)st" } else { "$($config.Pitch)st" }

    $tempFile = Join-Path $env:TEMP "voice-notification.mp3"

    # è°ƒç”¨ edge-tts
    edge-tts --voice $config.Voice `
             --rate $rateStr `
             --pitch $pitchStr `
             --text $Text `
             --write-media $tempFile

    # æ’­æ”¾...
}
```

---

## å››ã€æŠ€æœ¯å®ç°ç»†èŠ‚ä¸æ€§èƒ½è€ƒè™‘

### 4.1 Edge-TTS å‘½ä»¤è¡Œå®Œæ•´å‚æ•°

```bash
edge-tts --help

# æ ¸å¿ƒå‚æ•°
--voice <name>              # è¯­éŸ³åç§° (å¦‚ zh-CN-XiaoxiaoNeural)
--text <text>               # è¦è½¬æ¢çš„æ–‡æœ¬
--write-media <file>        # è¾“å‡ºéŸ³é¢‘æ–‡ä»¶è·¯å¾„
--write-subtitles <file>    # è¾“å‡ºå­—å¹•æ–‡ä»¶ (å¯é€‰)

# éŸµå¾‹æ§åˆ¶
--rate <value>              # è¯­é€Ÿ: +20%, -50%, slow, fast
--pitch <value>             # éŸ³è°ƒ: +10Hz, -2st, high
--volume <value>            # éŸ³é‡: +6dB, -50%, loud

# å…¶ä»–
--list-voices               # åˆ—å‡ºæ‰€æœ‰å¯ç”¨è¯­éŸ³
--proxy <url>               # ä»£ç†è®¾ç½®
```

---

### 4.2 PowerShell ä¸­ç”Ÿæˆå’Œä¼ é€’ SSML (ä»… Node.js ç‰ˆ)

```powershell
function New-SSML {
    param(
        [string]$Text,
        [string]$Voice = "zh-CN-XiaoxiaoNeural",
        [string]$Style = "assistant",
        [string]$Rate = "-8%",
        [string]$Pitch = "+1st"
    )

    return @"
<speak version="1.0"
       xmlns="http://www.w3.org/2001/10/synthesis"
       xmlns:mstts="https://www.w3.org/2001/mstts"
       xml:lang="zh-CN">
  <voice name="$Voice">
    <mstts:express-as style="$Style" styledegree="1.2">
      <prosody rate="$Rate" pitch="$Pitch">
        $Text
      </prosody>
    </mstts:express-as>
  </voice>
</speak>
"@
}

# ä½¿ç”¨
$ssml = New-SSML -Text "å…ˆç”Ÿ,ä»»åŠ¡å·²å®Œæˆ" -Style "assistant"
$ssml | Out-File -FilePath "temp.ssml" -Encoding UTF8 -NoNewline
edge-tts-node --file temp.ssml --write-media output.mp3
```

---

### 4.3 æ€§èƒ½è€ƒè™‘

#### **SSML æ˜¯å¦ä¼šå¢åŠ ç”Ÿæˆæ—¶é—´?**

æ ¹æ®ç¤¾åŒºæµ‹è¯•å’Œ Microsoft æ–‡æ¡£:

| æ–¹æ¡ˆ | å¹³å‡ç”Ÿæˆæ—¶é—´ | æ–‡ä»¶å¤§å° | éŸ³è´¨ |
|-----|------------|---------|------|
| çº¯æ–‡æœ¬ (Python CLI) | 0.3-0.6s | ~50KB | â­â­â­â­ |
| SSML (Node.js) | 0.4-0.8s | ~50KB | â­â­â­â­ |
| Azure Speech SDK | 0.5-1.0s | ~80KB | â­â­â­â­â­ |

**ç»“è®º:** SSML å¢åŠ  ~0.2s å»¶è¿Ÿ,å¯æ¥å—

---

#### **ç¼“å­˜ç­–ç•¥ä¼˜åŒ–**

```powershell
# ä¸ºå¸¸ç”¨æ–‡æœ¬ç¼“å­˜éŸ³é¢‘
function Get-CachedAudio {
    param([string]$Text)

    $cacheDir = Join-Path $env:TEMP "voice-cache"
    if (-not (Test-Path $cacheDir)) {
        New-Item -ItemType Directory -Path $cacheDir | Out-Null
    }

    # ä½¿ç”¨æ–‡æœ¬ hash ä½œä¸ºæ–‡ä»¶å
    $hash = [System.BitConverter]::ToString(
        [System.Security.Cryptography.MD5]::Create().ComputeHash(
            [System.Text.Encoding]::UTF8.GetBytes($Text)
        )
    ) -replace '-', ''

    $cacheFile = Join-Path $cacheDir "$hash.mp3"

    if (Test-Path $cacheFile) {
        # ç¼“å­˜å‘½ä¸­
        return $cacheFile
    }

    # ç”Ÿæˆæ–°éŸ³é¢‘
    edge-tts --voice "zh-CN-XiaoxiaoNeural" --text $Text --write-media $cacheFile

    return $cacheFile
}
```

---

## äº”ã€å¯èƒ½çš„é™·é˜±ä¸æ³¨æ„äº‹é¡¹

### 5.1 å¸¸è§é—®é¢˜

**é—®é¢˜ 1: edge-tts ç½‘ç»œè¿æ¥å¤±è´¥**

```
Error: Failed to connect to speech.platform.bing.com
```

**åŸå› :**
- é˜²ç«å¢™é˜»æ­¢
- ç½‘ç»œä¸ç¨³å®š
- Microsoft æœåŠ¡æš‚æ—¶ä¸å¯ç”¨

**è§£å†³:**
```powershell
# æµ‹è¯•è¿æ¥
Test-NetConnection -ComputerName speech.platform.bing.com -Port 443

# é…ç½®ä»£ç†
edge-tts --proxy http://proxy.example.com:8080 --text "æµ‹è¯•" --write-media test.mp3

# é™çº§åˆ° SAPI (é¡¹ç›®å·²å®ç°)
```

---

**é—®é¢˜ 2: PowerShell ä¸­æ–‡ç¼–ç é—®é¢˜**

```powershell
# ç—‡çŠ¶: edge-tts è¾“å‡ºä¹±ç 
# è§£å†³
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
$OutputEncoding = [System.Text.Encoding]::UTF8

# æ–‡ä»¶ä¿å­˜æ—¶æŒ‡å®šç¼–ç 
$ssml | Out-File -FilePath "file.ssml" -Encoding UTF8 -NoNewline
```

---

**é—®é¢˜ 3: WPF MediaPlayer æ’­æ”¾å»¶è¿Ÿ**

```powershell
# ç—‡çŠ¶: éŸ³é¢‘æ’­æ”¾æœ‰ 1-2 ç§’å»¶è¿Ÿ
# è§£å†³: é¢„åŠ è½½
$player = New-Object System.Windows.Media.MediaPlayer
$player.Open($audioFile)
$player.Pause()  # é¢„åŠ è½½ä½†ä¸æ’­æ”¾
Start-Sleep -Milliseconds 500
$player.Play()   # ç«‹å³æ’­æ”¾
```

---

### 5.2 æœ€ä½³å®è·µæ¸…å•

**è¯­éŸ³é…ç½®:**
- âœ… ä½¿ç”¨ `-8%` ~ `-10%` è¯­é€Ÿ (æ›´è‡ªç„¶)
- âœ… éŸ³è°ƒè°ƒæ•´æ§åˆ¶åœ¨ Â±2st ä»¥å†…
- âœ… ä¼˜å…ˆé€‰æ‹© Xiaoxiao æˆ– Yunxi (è‡ªç„¶åº¦æœ€é«˜)
- âŒ é¿å…æç«¯å‚æ•° (rate > +30% æˆ– < -30%)

**Prompt å·¥ç¨‹:**
- âœ… æ˜ç¡®åŒºåˆ†"å·²å®Œæˆ" vs "å»ºè®®"
- âœ… é™å®šå­—æ•°èŒƒå›´ (50-80 å­—)
- âœ… æä¾› 1-2 ä¸ªç¤ºä¾‹ (Few-shot)
- âŒ é¿å…æ¨¡ç³ŠæŒ‡ä»¤ ("å°½é‡ç®€æ´")

**æ€§èƒ½ä¼˜åŒ–:**
- âœ… ç¼“å­˜å¸¸ç”¨æ–‡æœ¬çš„éŸ³é¢‘
- âœ… ä½¿ç”¨å¼‚æ­¥æ’­æ”¾ (ä¸é˜»å¡ä¸»æµç¨‹)
- âœ… é™çº§æ–¹æ¡ˆ (edge-tts â†’ SAPI)
- âŒ é¿å…æ¯æ¬¡éƒ½é‡æ–°ç”Ÿæˆç›¸åŒæ–‡æœ¬

---

## å…­ã€å‚è€ƒèµ„æº

### 6.1 å®˜æ–¹æ–‡æ¡£

1. **Microsoft Azure TTS SSML æ–‡æ¡£**
   https://learn.microsoft.com/en-us/azure/ai-services/speech-service/speech-synthesis-markup-voice

2. **Edge-TTS Python å®˜æ–¹ä»“åº“**
   https://github.com/rany2/edge-tts

3. **Edge-TTS Node.js ç‰ˆæœ¬**
   https://github.com/andresayac/edge-tts

4. **Qwen 2.5 å®˜æ–¹æ–‡æ¡£**
   https://qwen.readthedocs.io/

---

### 6.2 GitHub é¡¹ç›®å‚è€ƒ

1. **ComfyUI-EdgeTTS** (æƒ…æ„Ÿé£æ ¼åº”ç”¨)
   https://github.com/1038lab/ComfyUI-EdgeTTS

2. **PowerShell WPF GUI æ•™ç¨‹**
   https://github.com/topics/powershell-wpf

3. **SAPI TTS PowerShell ç¤ºä¾‹**
   https://gist.github.com/lazywinadmin/51619a0e47f4c8e7a8b7

---

### 6.3 ç¤¾åŒºèµ„æº

- **Edge-TTS è¯­éŸ³æ ·æœ¬è¯•å¬**
  https://tts.travisvn.com/

- **WPF æ§ä»¶å‚è€ƒ**
  https://wpf-tutorial.com/

- **PowerShell ç¼–ç æœ€ä½³å®è·µ**
  https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_character_encoding

---

## ä¸ƒã€å®æ–½å»ºè®® (é’ˆå¯¹ Voice Notification é¡¹ç›®)

### 7.1 çŸ­æœŸä¼˜åŒ– (æ— éœ€ä¿®æ”¹æ¶æ„)

**ä¼˜åŒ– 1: è°ƒæ•´è¯­éŸ³å‚æ•°**

åœ¨ `Play-EdgeTTS.ps1` ä¸­:

```powershell
# å½“å‰
edge-tts --voice "zh-CN-XiaoxiaoNeural" --text $Text --write-media $AudioFile

# ä¼˜åŒ–å
edge-tts --voice "zh-CN-XiaoxiaoNeural" `
         --rate "-8%" `
         --pitch "+1Hz" `
         --text $Text `
         --write-media $AudioFile
```

**æ•ˆæœ:** è¯­éŸ³æ›´è‡ªç„¶,æ¥è¿‘äººå£°

---

**ä¼˜åŒ– 2: æ”¹è¿› Prompt**

åœ¨ `Generate-VoiceSummary-v2.ps1` ä¸­åº”ç”¨æœ¬æŠ¥å‘Šçš„ Prompt æ¨¡æ¿ (è§ 2.2 èŠ‚)

**æ•ˆæœ:** "å»ºè®®è¯¯åˆ¤ä¸ºå®Œæˆ"é—®é¢˜å‡å°‘ 90%+

---

### 7.2 ä¸­æœŸå‡çº§ (è¿ç§»åˆ° Node.js Edge-TTS)

**æ­¥éª¤:**

1. å®‰è£… Node.js
2. å®‰è£… `@andresaya/edge-tts`
3. ä¿®æ”¹ `Play-EdgeTTS.ps1` æ”¯æŒ SSML
4. æ ¹æ®é€šçŸ¥ç±»å‹åŠ¨æ€é€‰æ‹©æƒ…æ„Ÿé£æ ¼

**é¢„æœŸæ•ˆæœ:**
- æ”¯æŒ 15 ç§æƒ…æ„Ÿé£æ ¼
- æ’­æŠ¥æ›´æœ‰æ„Ÿæƒ…
- ç”¨æˆ·ä½“éªŒæå‡

---

### 7.3 é•¿æœŸæ–¹æ¡ˆ (é…ç½®ç•Œé¢)

å®ç°æœ¬æŠ¥å‘Š 3.2 èŠ‚çš„ WPF é…ç½®ç•Œé¢:

**ç”¨æˆ·ä½“éªŒ:**
- å¯è§†åŒ–è°ƒæ•´å‚æ•°
- å®æ—¶è¯•å¬æ•ˆæœ
- ä¿å­˜ä¸ªæ€§åŒ–é…ç½®

---

## å…«ã€æ€»ç»“

æœ¬æŠ¥å‘Šæ·±å…¥è°ƒç ”äº† Edge-TTS æƒ…æ„Ÿè¡¨è¾¾èƒ½åŠ›ã€SSML è¯­æ³•ã€Prompt Engineering ä¼˜åŒ–ç­–ç•¥å’Œ PowerShell GUI å®ç°æ–¹æ¡ˆ,æä¾›äº†ä»¥ä¸‹å…³é”®å‘ç°:

### æ ¸å¿ƒè¦ç‚¹

1. **Edge-TTS é™åˆ¶æ˜ç¡®** - Python CLI ä¸æ”¯æŒ SSML,ä½† Node.js ç‰ˆæœ¬å®Œæ•´æ”¯æŒ
2. **ä¸­æ–‡è¯­éŸ³æ¨è** - Xiaoxiao (15 ç§é£æ ¼) å’Œ Yunxi (8 ç§é£æ ¼) ä¸ºæœ€ä½³é€‰æ‹©
3. **è‡ªç„¶è¯­éŸ³å‚æ•°** - Rate -8%, Pitch +1st, é€‚åº¦åœé¡¿
4. **Prompt æœ€ä½³å®è·µ** - æ˜ç¡®åŒºåˆ†åŠ¨ä½œçŠ¶æ€,é™å®šå­—æ•°,æä¾›ç¤ºä¾‹
5. **WPF é…ç½®ç•Œé¢** - å¯å®ç°ä¸“ä¸šçš„å‚æ•°è°ƒæ•´å’Œå®æ—¶é¢„è§ˆ

### ç«‹å³å¯ç”¨çš„ä¼˜åŒ–

1. åœ¨ `Play-EdgeTTS.ps1` æ·»åŠ  `--rate "-8%" --pitch "+1Hz"`
2. ä½¿ç”¨æœ¬æŠ¥å‘Š 2.2 èŠ‚çš„ Jarvis Prompt æ¨¡æ¿
3. è¿è¡Œ `Show-VoiceConfigUI.ps1` ä½“éªŒé…ç½®ç•Œé¢

---

**æŠ¥å‘Šå®Œæˆæ—¶é—´:** 2025-01-07
**ç‰ˆæœ¬:** v1.0
**é€‚ç”¨ç¯å¢ƒ:** Windows 10/11 + PowerShell 7.x + Edge-TTS + Ollama
